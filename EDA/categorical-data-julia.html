<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Using Julia for Introductory Statistics - 5&nbsp; Categorical data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../EDA/makie.html" rel="next">
<link href="../EDA/bivariate-julia.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-KS515LKBGZ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-KS515LKBGZ', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Categorical data</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Using Julia for Introductory Statistics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jverzani/UsingJ" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Julia introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/univariate-julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Univariate data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/tabular-data-julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tabular data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/bivariate-julia.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bivariate data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/categorical-data-julia.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Categorical data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/makie.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The <code>AlgebraOfGraphics</code> package</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Inference/distributions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Probability distributions</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Inference/inference.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Inference</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../LinearModels/linear-regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">The linear regression model</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#univariate-categorical-data" id="toc-univariate-categorical-data" class="nav-link active" data-scroll-target="#univariate-categorical-data"><span class="toc-section-number">5.1</span>  Univariate categorical data</a>
  <ul class="collapse">
  <li><a href="#tabulations" id="toc-tabulations" class="nav-link" data-scroll-target="#tabulations"><span class="toc-section-number">5.1.1</span>  Tabulations</a></li>
  <li><a href="#visualizations" id="toc-visualizations" class="nav-link" data-scroll-target="#visualizations"><span class="toc-section-number">5.1.2</span>  Visualizations</a></li>
  </ul></li>
  <li><a href="#paired-categorical-data" id="toc-paired-categorical-data" class="nav-link" data-scroll-target="#paired-categorical-data"><span class="toc-section-number">5.2</span>  Paired categorical data</a>
  <ul class="collapse">
  <li><a href="#conditional-distributions-of-two-way-tables" id="toc-conditional-distributions-of-two-way-tables" class="nav-link" data-scroll-target="#conditional-distributions-of-two-way-tables"><span class="toc-section-number">5.2.1</span>  Conditional distributions of two-way tables</a></li>
  <li><a href="#marginal-distributions-of-two-way-tables" id="toc-marginal-distributions-of-two-way-tables" class="nav-link" data-scroll-target="#marginal-distributions-of-two-way-tables"><span class="toc-section-number">5.2.2</span>  Marginal distributions of two-way tables</a></li>
  <li><a href="#two-way-tables-from-summarized-data" id="toc-two-way-tables-from-summarized-data" class="nav-link" data-scroll-target="#two-way-tables-from-summarized-data"><span class="toc-section-number">5.2.3</span>  Two-way tables from summarized data</a></li>
  <li><a href="#graphical-summaries-of-two-way-contingency-tables" id="toc-graphical-summaries-of-two-way-contingency-tables" class="nav-link" data-scroll-target="#graphical-summaries-of-two-way-contingency-tables"><span class="toc-section-number">5.2.4</span>  Graphical summaries of two-way contingency tables</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/jverzani/UsingJ/edit/master/EDA/categorical-data-julia.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/jverzani/UsingJ/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="ch-categorical-data" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Categorical data</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In the last chapter, the main variable was numeric either a measurement taken over the levels of a factor or as a pair of numeric variables. In this chapter we consider univariate and bivariate categorical data.</p>
<p>We will use the following, by now standard, packages in this chapter:</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsBase</span>, <span class="bu">StatsPlots</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DataFrames</span>, <span class="bu">Chain</span>, <span class="bu">CategoricalArrays</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">RDatasets</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="univariate-categorical-data" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="univariate-categorical-data"><span class="header-section-number">5.1</span> Univariate categorical data</h2>
<p>We first start with a single categorical variable before turning our attention to the case of one or more such variables.</p>
<section id="tabulations" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="tabulations"><span class="header-section-number">5.1.1</span> Tabulations</h3>
<p>Let’s consider a data set from R’s <code>MASS</code> package on a student survey; in particular the <code>Smoke</code> variable, which is stored as a categorical variable. The <code>levels</code> method reports 4 levels for this variable:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">RDatasets</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>survey <span class="op">=</span> <span class="fu">dataset</span>(<span class="st">"MASS"</span>, <span class="st">"survey"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>smokes <span class="op">=</span> survey.Smoke</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(smokes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>4-element Vector{String}:
 "Heavy"
 "Never"
 "Occas"
 "Regul"</code></pre>
</div>
</div>
<p>How frequent is each? We would need to tabulate to answer that question.</p>
<p>The <code>countmap</code> function from the <code>StatsBase</code> package counts occurrences in each level, returning a dictionary:</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">countmap</span>(smokes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>Dict{Union{Missing, CategoricalValue{String, UInt8}}, Int64} with 5 entries:
  "Occas" =&gt; 19
  "Heavy" =&gt; 11
  missing =&gt; 1
  "Never" =&gt; 189
  "Regul" =&gt; 17</code></pre>
</div>
</div>
<p>There are numerous alternatives.</p>
<p>Using a data frames approach, this tabulation can be done by grouping and applying the <code>nrow</code> function:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">combine</span>(<span class="fu">groupby</span>(survey, <span class="op">:</span>Smoke), nrow)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">

<div><div style="float: left;"><span>5×2 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">Smoke</th><th style="text-align: left;">nrow</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="Union{Missing, CategoricalValue{String, UInt8}}" style="text-align: left;">Cat…?</th><th title="Int64" style="text-align: left;">Int64</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="font-style: italic; text-align: left;">missing</td><td style="text-align: right;">1</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: left;">Heavy</td><td style="text-align: right;">11</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">3</td><td style="text-align: left;">Never</td><td style="text-align: right;">189</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">4</td><td style="text-align: left;">Occas</td><td style="text-align: right;">19</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">5</td><td style="text-align: left;">Regul</td><td style="text-align: right;">17</td></tr></tbody></table></div>
</div>
</div>
<p>Similarly, we can split (with <code>group</code> from <code>SplitApplyCombine</code>) and apply <code>length</code>:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> <span class="bu">SplitApplyCombine</span>: group</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="pp">@chain</span> survey <span class="cf">begin</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    eachrow</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    copy</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group</span>(r <span class="op">-&gt;</span> r.Smoke, _)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(length, _)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>5-element Dictionaries.Dictionary{Any, Int64}
 CategoricalValue{String, UInt8} "Never" │ 189
 CategoricalValue{String, UInt8} "Regul" │ 17
 CategoricalValue{String, UInt8} "Occas" │ 19
 CategoricalValue{String, UInt8} "Heavy" │ 11
                                 missing │ 1</code></pre>
</div>
</div>
<p>The above easily tabulates the same, and would be useful if the data were not in a data frame.</p>
<p>For tabulation, a separate package has benefits. We use the <code>FreqTables</code> package and its <code>freqtables</code> function. This returns a <em>named</em> vector:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">FreqTables</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>tbl <span class="op">=</span> <span class="fu">freqtable</span>(smokes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>5-element Named Vector{Int64}
Dim1    │ 
────────┼────
"Heavy" │  11
"Never" │ 189
"Occas" │  19
"Regul" │  17
missing │   1</code></pre>
</div>
</div>
<p>Named vectors are from the <code>NamedArrays</code> package and offer indexing by name, similar to a data frame.</p>
<p>Any of these approaches show for this data set that even in the <span class="math inline">\(90\)</span>s “Never” is by far the most common response for past smoking habits, and that there is one missing response.</p>
</section>
<section id="visualizations" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="visualizations"><span class="header-section-number">5.1.2</span> Visualizations</h3>
<p>Tabulations can be visualized beyond using a table.</p>
<p>A bar chart represents the above tablulations using bars proportional to the counts. The <code>bar</code> function makes a bar chart for the labels in <code>x</code> and the given data. For this example, we have either have to add “missing” to the levels, or, as is done here, excise it from the data set.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bar</span>(<span class="fu">levels</span>(smokes), tbl[<span class="fl">1</span><span class="op">:</span><span class="kw">end</span><span class="op">-</span><span class="fl">1</span>]; legend<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div id="fig-basic-bar-plot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="categorical-data-julia_files/figure-html/fig-basic-bar-plot-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5.1: Basic barplot.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Another common graphic is to use a dot, not a bar, to represent the value. Still another graphic is the pie chart; common in the business world, but not a favorite within introductory statistics.</p>
</section>
</section>
<section id="paired-categorical-data" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="paired-categorical-data"><span class="header-section-number">5.2</span> Paired categorical data</h2>
<p>In the <code>survey</code> data set we could look at pairs of data where both are categorical and ask questions about the pair. For example, the data contains information on smoking <em>and</em> identified gender (<code>Sex</code>). Is one gender more likely to smoke?</p>
<p>Again, we can use grouping and apply to see the counts:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>tbl <span class="op">=</span> <span class="fu">combine</span>(<span class="fu">groupby</span>(survey, [<span class="op">:</span>Sex, <span class="op">:</span>Smoke]), nrow)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">first</span>(tbl, <span class="fl">3</span>) <span class="co"># 3 of 10 rows displayed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

<div><div style="float: left;"><span>3×3 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">Sex</th><th style="text-align: left;">Smoke</th><th style="text-align: left;">nrow</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="Union{Missing, CategoricalValue{String, UInt8}}" style="text-align: left;">Cat…?</th><th title="Union{Missing, CategoricalValue{String, UInt8}}" style="text-align: left;">Cat…?</th><th title="Int64" style="text-align: left;">Int64</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="font-style: italic; text-align: left;">missing</td><td style="text-align: left;">Never</td><td style="text-align: right;">1</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: left;">Female</td><td style="text-align: left;">Heavy</td><td style="text-align: right;">5</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">3</td><td style="text-align: left;">Female</td><td style="text-align: left;">Never</td><td style="text-align: right;">99</td></tr></tbody></table></div>
</div>
</div>
<p>A <em>contingency table</em> is the more familiar means to view two-way categorical count data. A count of all combinations of the levels of one and the levels of the other is presented in a grid.</p>
<p>With <code>unstack</code> we can do this within <code>DataFrames</code>:</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@chain</span> survey <span class="cf">begin</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>([<span class="op">:</span>Sex, <span class="op">:</span>Smoke])</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    dropmissing</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">groupby</span>([<span class="op">:</span>Sex, <span class="op">:</span>Smoke])</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">combine</span>(nrow <span class="op">=&gt;</span> <span class="op">:</span>value)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unstack</span>(<span class="op">:</span>Smoke, <span class="op">:</span>value)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

<div><div style="float: left;"><span>2×5 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">Sex</th><th style="text-align: left;">Heavy</th><th style="text-align: left;">Never</th><th style="text-align: left;">Occas</th><th style="text-align: left;">Regul</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="CategoricalValue{String, UInt8}" style="text-align: left;">Cat…</th><th title="Union{Missing, Int64}" style="text-align: left;">Int64?</th><th title="Union{Missing, Int64}" style="text-align: left;">Int64?</th><th title="Union{Missing, Int64}" style="text-align: left;">Int64?</th><th title="Union{Missing, Int64}" style="text-align: left;">Int64?</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="text-align: left;">Female</td><td style="text-align: right;">5</td><td style="text-align: right;">99</td><td style="text-align: right;">9</td><td style="text-align: right;">5</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: left;">Male</td><td style="text-align: right;">6</td><td style="text-align: right;">89</td><td style="text-align: right;">10</td><td style="text-align: right;">12</td></tr></tbody></table></div>
</div>
</div>
<p>The above dropped missing values; to keep them in, the <code>allowmissing</code> argument may be specified to <code>unstack</code>:</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@chain</span> survey <span class="cf">begin</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">groupby</span>([<span class="op">:</span>Sex, <span class="op">:</span>Smoke])</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">combine</span>(nrow <span class="op">=&gt;</span> <span class="op">:</span>value)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unstack</span>(<span class="op">:</span>Smoke, <span class="op">:</span>value; allowmissing<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">

<div><div style="float: left;"><span>3×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">Sex</th><th style="text-align: left;">Never</th><th style="text-align: left;">Heavy</th><th style="text-align: left;">Occas</th><th style="text-align: left;">Regul</th><th style="text-align: left;">missing</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="Union{Missing, CategoricalValue{String, UInt8}}" style="text-align: left;">Cat…?</th><th title="Union{Missing, Int64}" style="text-align: left;">Int64?</th><th title="Union{Missing, Int64}" style="text-align: left;">Int64?</th><th title="Union{Missing, Int64}" style="text-align: left;">Int64?</th><th title="Union{Missing, Int64}" style="text-align: left;">Int64?</th><th title="Union{Missing, Int64}" style="text-align: left;">Int64?</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="font-style: italic; text-align: left;">missing</td><td style="text-align: right;">1</td><td style="font-style: italic; text-align: right;">missing</td><td style="font-style: italic; text-align: right;">missing</td><td style="font-style: italic; text-align: right;">missing</td><td style="font-style: italic; text-align: right;">missing</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: left;">Female</td><td style="text-align: right;">99</td><td style="text-align: right;">5</td><td style="text-align: right;">9</td><td style="text-align: right;">5</td><td style="font-style: italic; text-align: right;">missing</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">3</td><td style="text-align: left;">Male</td><td style="text-align: right;">89</td><td style="text-align: right;">6</td><td style="text-align: right;">10</td><td style="text-align: right;">12</td><td style="text-align: right;">1</td></tr></tbody></table></div>
</div>
</div>
<p>The <code>missing</code> values can be replaced with <code>0</code> using the <code>coalesce</code> function which scans through its arguments returning the first that is not equal to <code>missing</code>:</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@chain</span> survey <span class="cf">begin</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">groupby</span>([<span class="op">:</span>Sex, <span class="op">:</span>Smoke])</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">combine</span>(nrow <span class="op">=&gt;</span> <span class="op">:</span>value)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unstack</span>(<span class="op">:</span>Smoke, <span class="op">:</span>value; allowmissing<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transform</span>(<span class="fu">Not</span>(<span class="fl">1</span>) <span class="op">.=&gt;</span> <span class="fu">ByRow</span>(x <span class="op">-&gt;</span> <span class="fu">coalesce</span>(x, <span class="fl">0</span>)); renamecols<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">

<div><div style="float: left;"><span>3×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">Sex</th><th style="text-align: left;">Never</th><th style="text-align: left;">Heavy</th><th style="text-align: left;">Occas</th><th style="text-align: left;">Regul</th><th style="text-align: left;">missing</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="Union{Missing, CategoricalValue{String, UInt8}}" style="text-align: left;">Cat…?</th><th title="Int64" style="text-align: left;">Int64</th><th title="Int64" style="text-align: left;">Int64</th><th title="Int64" style="text-align: left;">Int64</th><th title="Int64" style="text-align: left;">Int64</th><th title="Int64" style="text-align: left;">Int64</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="font-style: italic; text-align: left;">missing</td><td style="text-align: right;">1</td><td style="text-align: right;">0</td><td style="text-align: right;">0</td><td style="text-align: right;">0</td><td style="text-align: right;">0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: left;">Female</td><td style="text-align: right;">99</td><td style="text-align: right;">5</td><td style="text-align: right;">9</td><td style="text-align: right;">5</td><td style="text-align: right;">0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">3</td><td style="text-align: left;">Male</td><td style="text-align: right;">89</td><td style="text-align: right;">6</td><td style="text-align: right;">10</td><td style="text-align: right;">12</td><td style="text-align: right;">1</td></tr></tbody></table></div>
</div>
</div>
<p>More conveniently, the <code>freqtable</code> command will produce contingency tables:</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>tbl <span class="op">=</span> <span class="fu">freqtable</span>(survey, <span class="op">:</span>Sex, <span class="op">:</span>Smoke)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>3×5 Named Matrix{Int64}
Sex ╲ Smoke │ "Heavy"  "Never"  "Occas"  "Regul"  missing
────────────┼────────────────────────────────────────────
"Female"    │       5       99        9        5        0
"Male"      │       6       89       10       12        1
missing     │       0        1        0        0        0</code></pre>
</div>
</div>
<p>The <code>freqtable</code> interface allows the user to pass in two variables of data, or, as above, a tabular data set and two variable names. The <code>freqtable</code> method summarized them with the levels of the first variables naming the rows, and levels of the second naming the columns.</p>
<p>It is essentially this function using <code>DataFrames</code>:</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">xtabs</span>(d, f, g)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@chain</span> d <span class="cf">begin</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">groupby</span>([f, g])</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">combine</span>(nrow <span class="op">=&gt;</span> <span class="op">:</span>value)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">unstack</span>(g, <span class="op">:</span>value; allowmissing<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">transform</span>(<span class="fu">Not</span>(<span class="fl">1</span>) <span class="op">.=&gt;</span> <span class="fu">ByRow</span>(x <span class="fu">-&gt;coalesce</span>(x, <span class="fl">0</span>)); renamecols<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>xtabs (generic function with 1 method)</code></pre>
</div>
</div>
<section id="conditional-distributions-of-two-way-tables" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="conditional-distributions-of-two-way-tables"><span class="header-section-number">5.2.1</span> Conditional distributions of two-way tables</h3>
<p>At first glance, there does not seem to be much difference in the smoking variable between the identified genders. As tables may have many more counts in a given row or column, it can be helpful to take proportions of the rows or columns to compare. The <code>FreqTables</code> package provides the <code>prop</code> function to do so. By default, it takes a proportion of all the data; the keyword <code>margins=1</code> is used to see proportions for each row, <code>margins=2</code> to see proportions for each column. For example, to compare the distribution of <code>Smokes</code> for each level of <code>Sex</code>, we take proportions across each row:</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop</span>(tbl; margins<span class="op">=</span><span class="fl">1</span>)  <span class="co"># check `sum(prop(tbl; margins=1); dims=2)` returns 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>3×5 Named Matrix{Float64}
Sex ╲ Smoke │    "Heavy"     "Never"     "Occas"     "Regul"     missing
────────────┼───────────────────────────────────────────────────────────
"Female"    │  0.0423729    0.838983   0.0762712   0.0423729         0.0
"Male"      │  0.0508475    0.754237   0.0847458    0.101695  0.00847458
missing     │        0.0         1.0         0.0         0.0         0.0</code></pre>
</div>
</div>
<p>There does not seem to be large differences between the rows, perhaps indicating that the gender doesn’t seem to have an effect on the smoking prevalency, though surveyed females were more likely to have never smoked and less likely to to be regular smokers compared to their male counterparts.</p>
<p>What about the exercise variable?</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tbl <span class="op">=</span> <span class="fu">freqtable</span>(survey, <span class="op">:</span>Exer, <span class="op">:</span>Smoke)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop</span>(tbl; margins<span class="op">=</span><span class="fl">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>3×5 Named Matrix{Float64}
Exer ╲ Smoke │   "Heavy"    "Never"    "Occas"    "Regul"    missing
─────────────┼──────────────────────────────────────────────────────
"Freq"       │ 0.0608696   0.756522   0.104348  0.0782609        0.0
"None"       │ 0.0416667       0.75      0.125  0.0416667  0.0416667
"Some"       │ 0.0306122   0.857143  0.0408163  0.0714286        0.0</code></pre>
</div>
</div>
<p>Again, not much difference across the levels of <code>Exer</code>.</p>
<p>Finding the row (or column) proportions as above finds the <em>conditional distribution</em> for a given value. (Answering the question, say, what is the distribution of the second variable <em>given</em> the first variables has a specific level?)</p>
<section id="row-proportions-with-data-frames." class="level4">
<h4 class="anchored" data-anchor-id="row-proportions-with-data-frames.">Row proportions with Data Frames.</h4>
<p>The task of finding row proportions with a data frame can be similarly addressed by applying a transform to each row. The following uses a percentage scale:</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">perc</span>(x, Σ) <span class="op">=</span> <span class="fu">round</span>(<span class="fl">100</span> <span class="op">*</span> x <span class="op">/</span> Σ, digits<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">perc</span>(x<span class="op">::</span><span class="dt">Missing</span>, Σ) <span class="op">=</span> x</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">perc</span>(r) <span class="op">=</span> <span class="fu">map</span>(x <span class="op">-&gt;</span> <span class="fu">perc</span>(x,<span class="fu">sum</span>(<span class="fu">skipmissing</span>(r))), r)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">perc_table</span>(d)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    nms <span class="op">=</span> <span class="fu">names</span>(d, <span class="dt">Union</span>{<span class="dt">AbstractString</span>, CategoricalValue})</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">combine</span>(d, nms, <span class="fu">AsTable</span>(<span class="fu">Not</span>(nms)) <span class="op">=&gt;</span> <span class="fu">ByRow</span>(perc) <span class="op">=&gt;</span> AsTable; renamecols<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(survey, <span class="op">:</span>Exer, <span class="op">:</span>Smoke) <span class="op">|&gt;</span> perc_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">

<div><div style="float: left;"><span>3×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">Exer</th><th style="text-align: left;">Heavy</th><th style="text-align: left;">Never</th><th style="text-align: left;">Occas</th><th style="text-align: left;">Regul</th><th style="text-align: left;">missing</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="CategoricalValue{String, UInt8}" style="text-align: left;">Cat…</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th><th title="Float64" style="text-align: left;">Float64</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="text-align: left;">Freq</td><td style="text-align: right;">6.1</td><td style="text-align: right;">75.7</td><td style="text-align: right;">10.4</td><td style="text-align: right;">7.8</td><td style="text-align: right;">0.0</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: left;">None</td><td style="text-align: right;">4.2</td><td style="text-align: right;">75.0</td><td style="text-align: right;">12.5</td><td style="text-align: right;">4.2</td><td style="text-align: right;">4.2</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">3</td><td style="text-align: left;">Some</td><td style="text-align: right;">3.1</td><td style="text-align: right;">85.7</td><td style="text-align: right;">4.1</td><td style="text-align: right;">7.1</td><td style="text-align: right;">0.0</td></tr></tbody></table></div>
</div>
</div>
</section>
</section>
<section id="marginal-distributions-of-two-way-tables" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="marginal-distributions-of-two-way-tables"><span class="header-section-number">5.2.2</span> Marginal distributions of two-way tables</h3>
<p>A <em>marginal</em> distribution from a two-way table is found by adding all the values in each row, or each column. With two-way tables generated from the full data, there are more direct ways to realize these, but from a two-way table, we just need to apply <code>sum</code> to each row or column. The <code>sum</code> function takes a <code>dims</code> argument to specify the dimension, which, in this case, is <code>2</code> for adding along the columns (the second dimension) and <code>1</code> for adding down the rows (the first dimension):<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(tbl, dims<span class="op">=</span><span class="fl">1</span>) <span class="co"># kinda like `freqtable(survey.Smoke)`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>1×5 Named Matrix{Int64}
Exer ╲ Smoke │ "Heavy"  "Never"  "Occas"  "Regul"  missing
─────────────┼────────────────────────────────────────────
sum(Exer)    │      11      189       19       17        1</code></pre>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(tbl, dims<span class="op">=</span><span class="fl">2</span>) <span class="co"># like `freqtable(survey.Exer)`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>3×1 Named Matrix{Int64}
Exer ╲ Smoke │ sum(Smoke)
─────────────┼───────────
"Freq"       │        115
"None"       │         24
"Some"       │         98</code></pre>
</div>
</div>
</section>
<section id="two-way-tables-from-summarized-data" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="two-way-tables-from-summarized-data"><span class="header-section-number">5.2.3</span> Two-way tables from summarized data</h3>
<p>Suppose a data set was presented in the following two-way table:</p>
<table class="table">
<caption>A two-way contingency table of fabricated data showing counts of student grades and mode of instruction.</caption>
<thead>
<tr class="header">
<th>Grade</th>
<th>In person</th>
<th>Hybrid</th>
<th>Asynchronous Online</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A - C</td>
<td>10</td>
<td>5</td>
<td>5</td>
</tr>
<tr class="even">
<td>D</td>
<td>10</td>
<td>15</td>
<td>10</td>
</tr>
<tr class="odd">
<td>F</td>
<td>5</td>
<td>10</td>
<td>10</td>
</tr>
</tbody>
</table>
<p>This table could be <em>stored</em> as a two-way table in different ways. Here we show how to make this a data frame, then expand it to variables, then summarize.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="fu">DataFrame</span>([</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>(Grade<span class="op">=</span><span class="st">"A-C"</span>, IP<span class="op">=</span><span class="fl">10</span>, Hybrid<span class="op">=</span><span class="fl">5</span>,  Asynchronous<span class="op">=</span><span class="fl">5</span>),</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>(Grade<span class="op">=</span><span class="st">"D"</span>,   IP<span class="op">=</span><span class="fl">10</span>, Hybrid<span class="op">=</span><span class="fl">15</span>, Asynchronous<span class="op">=</span><span class="fl">10</span>),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>(Grade<span class="op">=</span><span class="st">"F"</span>,   IP<span class="op">=</span><span class="fl">5</span>,  Hybrid<span class="op">=</span><span class="fl">10</span>, Asynchronous<span class="op">=</span><span class="fl">10</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">

<div><div style="float: left;"><span>3×4 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">Grade</th><th style="text-align: left;">IP</th><th style="text-align: left;">Hybrid</th><th style="text-align: left;">Asynchronous</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="String" style="text-align: left;">String</th><th title="Int64" style="text-align: left;">Int64</th><th title="Int64" style="text-align: left;">Int64</th><th title="Int64" style="text-align: left;">Int64</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="text-align: left;">A-C</td><td style="text-align: right;">10</td><td style="text-align: right;">5</td><td style="text-align: right;">5</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: left;">D</td><td style="text-align: right;">10</td><td style="text-align: right;">15</td><td style="text-align: right;">10</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">3</td><td style="text-align: left;">F</td><td style="text-align: right;">5</td><td style="text-align: right;">10</td><td style="text-align: right;">10</td></tr></tbody></table></div>
</div>
</div>
<p>There are <code>80</code> students summarized here:</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>([<span class="fu">sum</span>(r[<span class="fl">2</span><span class="op">:</span><span class="kw">end</span>]) for r <span class="kw">in</span>  <span class="fu">eachrow</span>(df)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>80</code></pre>
</div>
</div>
<p>Here we make a data frame with 80 cases:</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ddf <span class="op">=</span> <span class="pp">@chain</span> df <span class="cf">begin</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stack</span>(<span class="fu">Not</span>(<span class="op">:</span>Grade), variable_name<span class="op">=:</span>InstructionType)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transform</span>(<span class="op">:</span>value <span class="op">=&gt;</span> <span class="fu">ByRow</span>(n <span class="op">-&gt;</span> <span class="fl">1</span><span class="op">:</span>n); renamecols<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">flatten</span>(<span class="op">:</span>value)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">Not</span>(<span class="op">:</span>value))</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(ddf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">

<div><div style="float: left;"><span>2×7 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;"><table class="data-frame table table-sm table-striped" style="margin-bottom: 6px;"><thead><tr class="header"><th class="rowNumber" style="font-weight: bold; text-align: right;">Row</th><th style="text-align: left;">variable</th><th style="text-align: left;">mean</th><th style="text-align: left;">min</th><th style="text-align: left;">median</th><th style="text-align: left;">max</th><th style="text-align: left;">nmissing</th><th style="text-align: left;">eltype</th></tr><tr class="subheader headerLastRow"><th class="rowNumber" style="font-weight: bold; text-align: right;"></th><th title="Symbol" style="text-align: left;">Symbol</th><th title="Nothing" style="text-align: left;">Nothing</th><th title="String" style="text-align: left;">String</th><th title="Nothing" style="text-align: left;">Nothing</th><th title="String" style="text-align: left;">String</th><th title="Int64" style="text-align: left;">Int64</th><th title="DataType" style="text-align: left;">DataType</th></tr></thead><tbody><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">1</td><td style="text-align: left;">Grade</td><td style="font-style: italic; text-align: left;"></td><td style="text-align: left;">A-C</td><td style="font-style: italic; text-align: left;"></td><td style="text-align: left;">F</td><td style="text-align: right;">0</td><td style="text-align: left;">String</td></tr><tr><td class="rowNumber" style="font-weight: bold; text-align: right;">2</td><td style="text-align: left;">InstructionType</td><td style="font-style: italic; text-align: left;"></td><td style="text-align: left;">Asynchronous</td><td style="font-style: italic; text-align: left;"></td><td style="text-align: left;">IP</td><td style="text-align: right;">0</td><td style="text-align: left;">String</td></tr></tbody></table></div>
</div>
</div>
<p>(It isn’t the most efficient, but we utilize <code>flatten</code> to repeat the values easily created by the range operator, <code>1:n</code> above. As these values are not of interest, we subsequently drop them.)</p>
<p>To see we could return to the original table, we first give the <code>InstructionType</code> the right ordering of the levels, then create a frequency table:</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ordered_levels <span class="op">=</span> [<span class="st">"IP"</span>, <span class="st">"Hybrid"</span>, <span class="st">"Asynchronous"</span>]</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>ddf.InstructionType <span class="op">=</span> <span class="fu">categorical</span>(ddf.InstructionType;</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                                       ordered<span class="op">=</span><span class="cn">true</span>, levels<span class="op">=</span>ordered_levels)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">freqtable</span>(ddf, <span class="op">:</span>Grade, <span class="op">:</span>InstructionType)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>3×3 Named Matrix{Int64}
Grade ╲ InstructionType │           "IP"        "Hybrid"  "Asynchronous"
────────────────────────┼───────────────────────────────────────────────
A-C                     │             10               5               5
D                       │             10              15              10
F                       │              5              10              10</code></pre>
</div>
</div>
</section>
<section id="graphical-summaries-of-two-way-contingency-tables" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="graphical-summaries-of-two-way-contingency-tables"><span class="header-section-number">5.2.4</span> Graphical summaries of two-way contingency tables</h3>
<p>We review a few visualizations of dependent categorical variables.</p>
<section id="grouped-bar-plots" class="level4">
<h4 class="anchored" data-anchor-id="grouped-bar-plots">Grouped bar plots</h4>
<p>The bar plot for a single categorical variable shows frequency counts for each level. A grouped bar plot shows a distribution of the second variable for the grouping variable.</p>
<p>A useful data structure for this graphic is found using <code>groupby</code> with 2 variables:</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>tbl <span class="op">=</span> <span class="pp">@chain</span> survey <span class="cf">begin</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>([<span class="op">:</span>Sex, <span class="op">:</span>Smoke])</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    dropmissing</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">groupby</span>([<span class="op">:</span>Sex, <span class="op">:</span>Smoke])</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">combine</span>(nrow <span class="op">=&gt;</span> <span class="op">:</span>value)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> <span class="pp">@df</span> tbl <span class="fu">groupedbar</span>(<span class="op">:</span>Sex, <span class="op">:</span>value, group<span class="op">=:</span>Smoke; xlab<span class="op">=</span><span class="st">"Identified gender"</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> <span class="pp">@df</span> tbl <span class="fu">groupedbar</span>(<span class="op">:</span>Sex, <span class="op">:</span>value, group<span class="op">=:</span>Smoke; xlab<span class="op">=</span><span class="st">"Identified gender"</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>                        bar_position <span class="op">=</span> <span class="op">:</span>stack)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(p1, p2, layout <span class="op">=</span> (<span class="pp">@layout</span> [a b]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<div id="fig-grouped-barchart" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="categorical-data-julia_files/figure-html/fig-grouped-barchart-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5.2: Grouped bar chart of smoking distribution for different levels of the <code>:Sex</code> variable. The <code>bar_position</code> argument can be passed a value <code>:stack</code> to use a stacked display.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>As seen in the left graphic of <a href="#fig-grouped-barchart">Figure&nbsp;<span>5.2</span></a>, there are groups of bars for each level of the first variable (<code>:Sex</code>); the groups represent the variable passed to the <code>group</code> keyword argument. The values are looked up in the data frame with the computed column that was named <code>:value</code> through the <code>combine</code> function.</p>
<p>The same graphic on the left – without the labeling – is also made more directly with <code>groupedbar(freqtable(survey, :Sex, :Smoke))</code></p>
</section>
<section id="andrews-plot" class="level4">
<h4 class="anchored" data-anchor-id="andrews-plot">Andrews plot</h4>
<p>An <a href="https://en.wikipedia.org/wiki/Andrews_plot">Andrews plot</a> is implemented in <code>StatsPlots</code> showing differences in a collection of <strong>numeric</strong> variables for a given categorical variable. For each row, a trigonometric polynomial with coefficients given by the numeric values in the given row creates a function which is plotted. If the values across the categorical variable are similar, the graphs will be; if not, then the groupings will show up.</p>
<p>We first show an example with the <code>iris</code> data where the categorical value is <code>:Species</code> and the numeric ones the first 4 values. This will be shown in the left graphic of <a href="#fig-andrews-plots">Figure&nbsp;<span>5.3</span></a>:</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> <span class="fu">dataset</span>(<span class="st">"datasets"</span>, <span class="st">"iris"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>andrews_1 <span class="op">=</span> <span class="pp">@df</span> iris <span class="fu">andrewsplot</span>(<span class="op">:</span>Species, <span class="fu">cols</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">4</span>));</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For the next plot, we use the <code>survey</code> data. There are some efforts needed to wrangle the data: we convert the categorical variables to the numeric levels (<code>levelcode</code>) <em>except</em> for <code>:Sex</code> which we use for the grouping variable. We also drop any <code>missing</code> values:</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">iscategorical</span>(x) <span class="op">=</span> <span class="fu">isa</span>(x, CategoricalArray) <span class="co"># predicate function</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>tbl <span class="op">=</span> <span class="pp">@chain</span> survey <span class="cf">begin</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">combine</span>(_, <span class="op">:</span>Sex, <span class="fu">findall</span>(iscategorical, <span class="fu">eachcol</span>(_))[<span class="fl">2</span><span class="op">:</span><span class="kw">end</span>] <span class="op">.=&gt;</span> <span class="fu">ByRow</span>(levelcode);</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>            renamecols<span class="op">=</span><span class="cn">false</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    dropmissing</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>andrews_2 <span class="op">=</span> <span class="pp">@df</span> tbl <span class="fu">andrewsplot</span>(<span class="op">:</span>Sex, <span class="fu">cols</span>(<span class="fl">2</span><span class="op">:</span><span class="fu">ncol</span>(tbl)));</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="26">
<div class="cell-output cell-output-display" data-execution_count="27">
<div id="fig-andrews-plots" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="categorical-data-julia_files/figure-html/fig-andrews-plots-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5.3: Andrews plots of the <code>iris</code> data (left graphic) and the <code>survey</code> data (right graphic). The <code>iris</code> plot shows clear differences based on the <code>:Species</code> variable; the <code>survey</code> data does not for the <code>:Sex</code> variable.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="mosaic-plots" class="level4">
<h4 class="anchored" data-anchor-id="mosaic-plots">Mosaic plots</h4>
<p>A mosaic plot presents a graphical view of a two-way contingency table. These are somewhat similar to the grouped bar plot with stacking, but the width of the bars depends on the frequency of the given level.</p>
<p>This graphic is <em>not</em> part of <code>StatsPlots</code>. We borrow with modification this implementation from <a href="https://github.com/joshday/OnlineStats.jl/blob/master/src/viz/mosaicplot.jl">OnlineStats</a>:</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">FreqTables</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaic_plot</span>(f, g; kwargs<span class="op">...</span>) <span class="op">=</span> <span class="fu">mosaic_plot!</span>(Plots.<span class="fu">Plot</span>(), f, g; kwargs<span class="op">...</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">mosaic_plot!</span>(p, f, g; xrotation<span class="op">=-</span><span class="fl">45</span>, kwargs<span class="op">...</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    tbl <span class="op">=</span> <span class="fu">freqtable</span>(f, g)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="fu">sum</span>(tbl, dims<span class="op">=</span><span class="fl">2</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> <span class="fu">sum</span>(tbl, dims<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    a′ <span class="op">=</span> [a.array<span class="op">...</span>]</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="fu">vcat</span>(<span class="fl">0</span>, <span class="fu">cumsum</span>(a′)) <span class="op">/</span> <span class="fu">sum</span>(a′)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    tbl′ <span class="op">=</span> <span class="fu">convert</span>(<span class="dt">Matrix</span>{<span class="dt">Float64</span>}, tbl.array)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    tbl′[tbl′ <span class="op">.==</span> <span class="fl">0</span>] <span class="op">.+=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">10</span>  <span class="co"># give some width when missing</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> <span class="fu">prop</span>(tbl′, margins<span class="op">=</span><span class="fl">1</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> <span class="fu">reverse</span>(<span class="fu">cumsum</span>(<span class="fu">prop</span>(tbl′, margins<span class="op">=</span><span class="fl">1</span>), dims<span class="op">=</span><span class="fl">2</span>), dims<span class="op">=</span><span class="fl">2</span>)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bar!</span>(p,</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>         <span class="fu">midpoints</span>(x), y;</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>         legend<span class="op">=</span><span class="cn">false</span>,</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>         bar_width <span class="op">=</span> <span class="fu">diff</span>(x),</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>         xlims<span class="op">=</span>(<span class="fl">0</span>,<span class="fl">1</span>), ylims<span class="op">=</span>(<span class="fl">0</span>,<span class="fl">1</span>), linewidth <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>         xticks <span class="op">=</span>  (<span class="fu">midpoints</span>(x), <span class="fu">string</span>.(<span class="fu">names</span>(a,<span class="fl">1</span>))),</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>         xrotation<span class="op">=</span>xrotation, xmirror<span class="op">=</span><span class="cn">true</span>,</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>         yticks <span class="op">=</span> (<span class="fu">midpoints</span>(<span class="fu">vcat</span>(y[<span class="fl">1</span>,<span class="op">:</span>],<span class="fl">0</span>)), <span class="fu">reverse</span>(<span class="fu">string</span>.(<span class="fu">names</span>(b,<span class="fl">2</span>)))),</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>         kwargs<span class="op">...</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>mosaic_plot! (generic function with 1 method)</code></pre>
</div>
</div>
<p>For the first variable, displayed on the <span class="math inline">\(x\)</span>-axis, the relative width of the bar is proportional to the marginal proportions; for each level on the <span class="math inline">\(x\)</span>-axis, the vertical bars show the relative proportions of the second variable. For example,</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@df</span> survey <span class="fu">mosaic_plot</span>(<span class="op">:</span>Exer, <span class="op">:</span>Smoke, xlab<span class="op">=</span><span class="st">"Exercise"</span>, ylab<span class="op">=</span><span class="st">"Smoke"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div id="fig-mosaicplot-exer-smoke" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="categorical-data-julia_files/figure-html/fig-mosaicplot-exer-smoke-output-1.svg" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5.4: Mosaic plot of the <code>Exercise</code> and <code>Smoke</code> variables in the <code>survey</code> data set.</figcaption><p></p>
</figure>
</div>
</div>
</div>


</section>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>The <code>margins</code> argument and <code>dims</code> argument are a bit confusing, a <code>1</code> for <code>margins</code> means each row is normalized, a <code>1</code> for <code>dims</code> means add down a row. Which is similar, but <code>prop(tbl; margins=1)</code> could be realized through <code>tbl . / sum(tbl, dims=2)</code>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
    var links = window.document.querySelectorAll('a:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../EDA/bivariate-julia.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bivariate data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../EDA/makie.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The <code>AlgebraOfGraphics</code> package</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-right">© Copyright 2023, John Verzani. All rights reserved.</div>
  </div>
</footer>



</body></html>