<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Tabular data – Using Julia for Introductory Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../EDA/bivariate-julia.html" rel="next">
<link href="../EDA/univariate-julia.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-748e8cd4f6c2d4a595e7f8d4ff8ce489.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-KS515LKBGZ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-KS515LKBGZ', { 'anonymize_ip': true});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../EDA/tabular-data-julia.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tabular data</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Using Julia for Introductory Statistics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jverzani/UsingJ" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Julia introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/univariate-julia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Univariate data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/tabular-data-julia.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tabular data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/bivariate-julia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bivariate data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/categorical-data-julia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Categorical data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/makie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The <code>AlgebraOfGraphics</code> package</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Inference/distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Probability distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Inference/inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../LinearModels/linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">The linear regression model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-frames" id="toc-data-frames" class="nav-link active" data-scroll-target="#data-frames"><span class="header-section-number">3.1</span> Data frames</a>
  <ul class="collapse">
  <li><a href="#data-frame-construction" id="toc-data-frame-construction" class="nav-link" data-scroll-target="#data-frame-construction"><span class="header-section-number">3.1.1</span> Data frame construction</a></li>
  <li><a href="#column-names" id="toc-column-names" class="nav-link" data-scroll-target="#column-names"><span class="header-section-number">3.1.2</span> Column names</a></li>
  <li><a href="#indexing-and-assignment" id="toc-indexing-and-assignment" class="nav-link" data-scroll-target="#indexing-and-assignment"><span class="header-section-number">3.1.3</span> Indexing and assignment</a></li>
  <li><a href="#sorting" id="toc-sorting" class="nav-link" data-scroll-target="#sorting"><span class="header-section-number">3.1.4</span> Sorting</a></li>
  <li><a href="#filtering-rows" id="toc-filtering-rows" class="nav-link" data-scroll-target="#filtering-rows"><span class="header-section-number">3.1.5</span> Filtering rows</a></li>
  <li><a href="#selecting-columns-transforming-data" id="toc-selecting-columns-transforming-data" class="nav-link" data-scroll-target="#selecting-columns-transforming-data"><span class="header-section-number">3.1.6</span> Selecting columns; transforming data</a></li>
  <li><a href="#combine" id="toc-combine" class="nav-link" data-scroll-target="#combine"><span class="header-section-number">3.1.7</span> Combine</a></li>
  <li><a href="#flatten" id="toc-flatten" class="nav-link" data-scroll-target="#flatten"><span class="header-section-number">3.1.8</span> Flatten</a></li>
  <li><a href="#splitapplycombine" id="toc-splitapplycombine" class="nav-link" data-scroll-target="#splitapplycombine"><span class="header-section-number">3.1.9</span> SplitApplyCombine</a></li>
  <li><a href="#aggregating-data" id="toc-aggregating-data" class="nav-link" data-scroll-target="#aggregating-data"><span class="header-section-number">3.1.10</span> Aggregating data</a></li>
  <li><a href="#tidy-data-stack-unstack" id="toc-tidy-data-stack-unstack" class="nav-link" data-scroll-target="#tidy-data-stack-unstack"><span class="header-section-number">3.1.11</span> Tidy data; stack, unstack</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jverzani/UsingJ/edit/master/EDA/tabular-data-julia.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jverzani/UsingJ/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tabular data</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Some data sets are naturally stored in a tabular format, like a spreadsheet. This chapter looks at such data.</p>
<p>In the following, we will utilize these basic packages, among others introduced along the way:</p>
<div id="2" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsBase</span>, <span class="bu">StatsPlots</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="data-frames" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="data-frames"><span class="header-section-number">3.1</span> Data frames</h2>
<p>The basic framework for exploratory data analysis is a data set with 1 or more observations for <span class="math inline">\(n\)</span> different cases. For each case (or observation) a <em>variable</em> will be a length-<span class="math inline">\(n\)</span> data set, with values measuring the same type of quantity, or perhaps missing. The variables can be stored as vectors. The collection of variables is <em>traditionally</em> arranged in a rectangular manner with each <em>row</em> representing the measurements for a given case and each column representing the measured values for each variable. That is the columns are homogeneous (as they measure the same thing), but the rows need not be (as different variables are measuring different quantities).</p>
<p>Matrices contain rectangular data, but are homogeneous. As such, a new structure is needed to store tabular data in general. A data frame is a concept borrowed from <a href="https://sites.stat.washington.edu/people/handcock/505/Lectures/lec9.pdf">S Plus</a> where they were introduced in 1991. The R language has data frames as a basic built-in data container. In <code>Julia</code> the structure is implemented in an external package, <code>DataFrames</code>.</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DataFrames</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
An OG package
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>DataFrames</code> package dates back to 2012, at least, and must be one of <code>Julia</code>’s oldest packages. Julia was on version <code>0.1</code> then. It is also under continual development and has a comprehensive set of documentation and tutorials. <span class="citation" data-cites="JSSv107i04">Bouchet-Valat and Kamiński (<a href="../references.html#ref-JSSv107i04" role="doc-biblioref">2023</a>)</span> has an excellent overview including comparisons to other implementations in other languages and context for certain design decisions. This introduction attempts to illustrate some basic usage; consult the provided documentation for additional details and applications.</p>
</div>
</div>
<section id="data-frame-construction" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="data-frame-construction"><span class="header-section-number">3.1.1</span> Data frame construction</h3>
<p>There are different ways to construct a data frame.</p>
<p>Consider the task of the Wirecutter in trying to select the best <a href="https://www.nytimes.com/wirecutter/reviews/best-carry-on-travel-bags/#how-we-picked-and-tested">carry on travel bag</a>. After compiling a list of possible models by scouring travel blogs etc., they select some criteria (capacity, compartment design, aesthetics, comfort, …) and compile data, similar to what one person collected in a <a href="https://docs.google.com/spreadsheets/d/1fSt_sO1s7moXPHbxBCD3JIKPa8QIZxtKWYUjD6ElZ-c/edit#gid=744941088">spreadsheet</a>. Here we create a much simplified spreadsheet for 3 listed bags with measurements of volume, price, laptop compatibility, loading style, and a last-checked date—as this market improves constantly.</p>
<pre><code>product         v  p    l loads       checked
Goruck GR2      40 395  Y front panel 2022-09
Minaal 3.0      35 349  Y front panel 2022-09
Genius          25 228  Y clamshell   2022-10</code></pre>
<p>We see that product is a character, volume and price numeric, laptop compatibility a Boolean value, load style one of a few levels, and the last checked date, a year-month date.</p>
<p>We create vectors to hold each. We load the <code>CategoricalArrays</code> and <code>Dates</code> packages for a few of the variables:</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CategoricalArrays</span>, <span class="bu">Dates</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>product <span class="op">=</span> [<span class="st">"Goruck GR2"</span>, <span class="st">"Minaal 3.0"</span>, <span class="st">"Genius"</span>]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>volume <span class="op">=</span> [<span class="fl">40</span>, <span class="fl">35</span>, <span class="fl">25</span>]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>price <span class="op">=</span> [<span class="fl">395</span>, <span class="fl">349</span>, <span class="fl">228</span>]</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>laptop_compatibility <span class="op">=</span> <span class="fu">categorical</span>([<span class="st">"Y"</span>,<span class="st">"Y"</span>,<span class="st">"Y"</span>])</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>loading_style <span class="op">=</span> <span class="fu">categorical</span>([<span class="st">"front panel"</span>, <span class="st">"front panel"</span>, <span class="st">"clamshell"</span>])</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>date_checked <span class="op">=</span> <span class="fu">Date</span>.(<span class="fl">2022</span>, [<span class="fl">9</span>,<span class="fl">9</span>,<span class="fl">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3-element Vector{Date}:
 2022-09-01
 2022-09-01
 2022-10-01</code></pre>
</div>
</div>
<p>With this, we use the <code>DataFrame</code> constructor to combine these into one data set.</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> <span class="fu">DataFrame</span>(product <span class="op">=</span> product, volume<span class="op">=</span>volume, price<span class="op">=</span>price,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>              var<span class="st">"laptop compatibility"</span><span class="op">=</span>laptop_compatibility,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>              var<span class="st">"loading style"</span><span class="op">=</span>loading_style, var<span class="st">"date checked"</span><span class="op">=</span>date_checked)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">product</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">volume</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">laptop compatibility</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">loading style</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">date checked</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Genius</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">228</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">clamshell</td>
<td style="text-align: left;">2022-10-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The call to the constructor is like that of a named tuple and again, <code>var"..."</code> is employed for names with spaces.</p>
<p>As called above, the constructor binds vectors of equal length into a new multi-variate container.</p>
<p>The <code>describe</code> function will summarize a data frame using different summaries for different types:</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>6×7 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">min</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">median</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">max</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">nmissing</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">eltype</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Symbol">Symbol</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Nothing, Float64}">Union…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Any">Any</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Any">Any</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Any">Any</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="DataType">DataType</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">product</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">Genius</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">String</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">volume</td>
<td style="text-align: left;">33.3333</td>
<td style="text-align: left;">25</td>
<td style="text-align: left;">35.0</td>
<td style="text-align: left;">40</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Int64</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">price</td>
<td style="text-align: left;">324.0</td>
<td style="text-align: left;">228</td>
<td style="text-align: left;">349.0</td>
<td style="text-align: left;">395</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Int64</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">laptop compatibility</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">Y</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">Y</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">CategoricalValue{String, UInt32}</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">loading style</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">clamshell</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">front panel</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">CategoricalValue{String, UInt32}</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">date checked</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">2022-09-01</td>
<td style="text-align: left;">2022-09-01</td>
<td style="text-align: left;">2022-10-01</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Date</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>In the above construction, we repeated the names of the variables to the constructor. A style, also akin to the construction of named tuple, could also have been used where variables after a semicolon are implicitly assumed to have the desired name:</p>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> <span class="fu">DataFrame</span>(; product, volume, price,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>              var<span class="st">"laptop compatibility"</span><span class="op">=</span>laptop_compatibility,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>              var<span class="st">"loading style"</span><span class="op">=</span>loading_style, var<span class="st">"date checked"</span><span class="op">=</span>date_checked)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">product</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">volume</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">laptop compatibility</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">loading style</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">date checked</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Genius</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">228</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">clamshell</td>
<td style="text-align: left;">2022-10-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>(In fact, with the <code>rename!</code> function, or other conveniences, it can be more direct to define the data frame, then rename the columns, avoiding the <code>var</code> above.)</p>
<p>We see that the <code>DataFrame</code> type displays values as we might expect with the column header showing the name of the variable and the storage type. The row numbers are added and may be used for reference to the data values.</p>
<p>There is a convention for attaching new columns to a data frame that allows another alternate construction:</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> <span class="fu">DataFrame</span>()   <span class="co"># empty data frame</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>d.product <span class="op">=</span> product</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>d.volume <span class="op">=</span> volume</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>d.price <span class="op">=</span> price</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>d.<span class="st">"laptop compatibility"</span> <span class="op">=</span> laptop_compatibility</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>d.<span class="st">"loading style"</span> <span class="op">=</span> loading_style</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>d.<span class="st">"date checked"</span> <span class="op">=</span> date_checked</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">product</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">volume</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">laptop compatibility</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">loading style</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">date checked</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Genius</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">228</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">clamshell</td>
<td style="text-align: left;">2022-10-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>This uses one of a few different ways to refer to a column in a data frame.</p>
<p>As another alternative, the <code>insertcols!</code> function can insert multiple columns, for example the last one in the example, could have been written <code>insertcols!(d, "date checked" =&gt; date_checked)</code>.</p>
<p>Before exploring how we might query the data frame, we note that an alternate means to describe the data set is by row, or case. For each row, we might use a named tuple with the names indicating the variable, and the values the measurement. The <code>DataFrame</code> constructor would accept this, here we shorten the names and only do one row (for now):</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> <span class="fu">DataFrame</span>([</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a> (b <span class="op">=</span> <span class="st">"Goruck GR2"</span>, v <span class="op">=</span> <span class="fl">40</span>, p <span class="op">=</span> <span class="fl">395</span>, lap <span class="op">=</span> <span class="st">"Y"</span>, load <span class="op">=</span> <span class="st">"front panel"</span>, d <span class="op">=</span> <span class="fu">Date</span>(<span class="st">"2022-09-01"</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>1×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Here, the variable types are different, as it takes more effort to make one categorical. The same way we defined a column allows us to <em>redefine</em> that column (replacing the container, not re-using it for storage). For example, we could do:</p>
<div id="18" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>d.lap <span class="op">=</span> <span class="fu">categorical</span>(d.lap)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>d.load <span class="op">=</span> <span class="fu">categorical</span>(d.load)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>1-element CategoricalArrays.CategoricalArray{String,1,UInt32}:
 "front panel"</code></pre>
</div>
</div>
<p>and then the two variables would be categorical.</p>
<p>There are other ways to define row by row:</p>
<ul>
<li>A data frame with empty variables can be constructed and then values as tuples may be <code>push!</code>ed onto the data frame</li>
</ul>
<div id="20" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">push!</span>(d,  (<span class="st">"Minaal 3.0"</span>, <span class="fl">35</span>, <span class="fl">349</span>, <span class="st">"Y"</span>, <span class="st">"front panel"</span>, <span class="fu">Date</span>(<span class="st">"2022-09-01"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>A named tuple can also be used.</p>
<ul>
<li>Similarly, rows specified by dictionaries may be pushed onto a data frame</li>
</ul>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">push!</span>(d, <span class="fu">Dict</span>(<span class="op">:</span>b <span class="op">=&gt;</span> <span class="st">"Genius"</span>, <span class="op">:</span>v <span class="op">=&gt;</span> <span class="fl">25</span>, <span class="op">:</span>p <span class="op">=&gt;</span> <span class="fl">228</span>, <span class="op">:</span>lap <span class="op">=&gt;</span> <span class="st">"Y"</span>,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>              <span class="op">:</span>load <span class="op">=&gt;</span> <span class="st">"clamshell"</span>, <span class="op">:</span>d <span class="op">=&gt;</span> <span class="fu">Date</span>(<span class="st">"2022-10-01"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Genius</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">228</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">clamshell</td>
<td style="text-align: left;">2022-10-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>(A dictionary is a <code>key =&gt; value</code> container like a named tuple, but keys may be arbitrary <code>Julia</code> objects—not always symbols—so we explicitly use symbols in the above command.)</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The <code>Tables</code> interface
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the <code>Julia</code> ecosystem, the <code>Tables</code> package provides a lightweight means to describe tabular data, like a data frame, <code>TableOperations</code> provides some basic means to query the data. The different ways in which a data frame can be defined, reflect the different ways <code>Tables</code> objects can be created.</p>
<p>As tables are viewed as rows of homogeneous types, a vector of named tuples is a natural description, whereas tables are also naturally viewed as a collection of named columns, each column a vector. As such, both of these specify a table.</p>
<ul>
<li>As a struct of arrays. This is used by calling <code>DataFrame(a=[1,2], b= [2,1])</code>, say.</li>
<li>As an array of structs. This is used by calling <code>DataFrame([(a=1,b=2), (a=2,b=1)])</code></li>
</ul>
</div>
</div>
<section id="rdataset" class="level4">
<h4 class="anchored" data-anchor-id="rdataset">RDataset</h4>
<p>Data frames are often read in from external sources, and not typed in. The <code>RDataSets</code> package has collected data sets from many different R packages and bundled them into data sets for <code>Julia</code> in the form of data frames. We will use some of these data sets in the examples. To load a data set we need to know its <code>R</code> package and <code>R</code> name:</p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">RDatasets</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>cars <span class="op">=</span> <span class="fu">dataset</span>(<span class="st">"MASS"</span>, <span class="st">"Cars93"</span>)  <span class="co"># package, data set name</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">first</span>(cars, <span class="fl">2</span>)  <span class="co"># first 2 rows only</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×27 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Manufacturer</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MinPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MaxPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGCity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGHighway</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AirBags</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DriveTrain</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Cylinders</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">EngineSize</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Horsepower</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RPM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RevPerMile</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ManTransAvail</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FuelTankCapacity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Passengers</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Length</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Wheelbase</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Width</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">TurnCircle</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RearSeatRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">LuggageRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Weight</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Origin</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Make</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int32}">Int32?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Acura</td>
<td style="text-align: left;">Integra</td>
<td style="text-align: left;">Small</td>
<td style="text-align: right;">12.9</td>
<td style="text-align: right;">15.9</td>
<td style="text-align: right;">18.8</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">31</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">140</td>
<td style="text-align: right;">6300</td>
<td style="text-align: right;">2890</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">13.2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">177</td>
<td style="text-align: right;">102</td>
<td style="text-align: right;">68</td>
<td style="text-align: right;">37</td>
<td style="text-align: right;">26.5</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2705</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Acura Integra</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Acura</td>
<td style="text-align: left;">Legend</td>
<td style="text-align: left;">Midsize</td>
<td style="text-align: right;">29.2</td>
<td style="text-align: right;">33.9</td>
<td style="text-align: right;">38.7</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">25</td>
<td style="text-align: left;">Driver &amp; Passenger</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">6</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">5500</td>
<td style="text-align: right;">2335</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">18.0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">195</td>
<td style="text-align: right;">115</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">30.0</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">3560</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Acura Legend</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="csv.read" class="level4">
<h4 class="anchored" data-anchor-id="csv.read">CSV.read</h4>
<p>For interacting with spreadsheet data, when it is stored like a data frame, it may be convenient to export the data in some format and then read that into a <code>Julia</code> session. A common format is to use comma-separated values, or “csv” data. The <code>CSV</code> package reads such files. The <code>CSV</code> package reads in delimited text data (the source) using the <code>Tables</code> interface and can be instructed to write to a data frame (the sink). The <code>CSV.read</code> file is used below. Here we write to some file to show that we can read it back:</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CSV</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="fu">tempname</span>() <span class="op">*</span> <span class="st">".csv"</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>CSV.<span class="fu">write</span>(f, d)  <span class="co"># write simple data frame to file `f`</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>d1 <span class="op">=</span> CSV.<span class="fu">read</span>(f, DataFrame)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String15">String15</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String1">String1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String15">String15</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Genius</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">228</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">clamshell</td>
<td style="text-align: left;">2022-10-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Comma-separated-value files are simple text files, with no metadata to indicate what type a value may be.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Some guesswork is necessary. We observe that the two categorical variables were read back in as strings. As seen above, that can be addressed through column conversion.</p>
<p>The filename, may be more general. For example, it could be <code>download(url)</code> for some url that points to a csv file to read data from the internet.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Read and write
</div>
</div>
<div class="callout-body-container callout-body">
<p>The methods <code>read</code> and <code>write</code> are qualified in the above usage with the <code>CSV</code> module. In the <code>Julia</code> ecosystem, the <code>FileIO</code> package provides a common framework for reading and writing files; it uses the verbs <code>load</code> and <code>save</code>. This can also be used with <code>DataFrames</code>, though it works through the <code>CSVFiles</code> package—and not <code>CSV</code>, as illustrated above. The read command would look like <code>DataFrame(load(fname))</code> and the write command like <code>save(fname, df)</code>. Here <code>fname</code> would have a “.csv” extension so that the type of file could be detected.</p>
</div>
</div>
<div id="tbl-read-write-data-frame" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-read-write-data-frame-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3.1: Basic usage to read/write <code>.csv</code> file into a data frame.
</figcaption>
<div aria-describedby="tbl-read-write-data-frame-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 40%">
<col style="width: 59%">
</colgroup>
<thead>
<tr class="header">
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>CSV.read(file_name, DataFrame)</code></td>
<td>Read csv file from file with given name</td>
</tr>
<tr class="even">
<td><code>CSV.read(IOBuffer(string), DataFrame)</code></td>
<td>Read csv file from a string using an <code>IOBuffer</code></td>
</tr>
<tr class="odd">
<td><code>CSV.read(download(url), DataFrame)</code></td>
<td>Read csv file an url</td>
</tr>
<tr class="even">
<td><code>open(file_name,"w") do io; CSV.write(io, dd); end</code></td>
<td>Write data frame <code>df</code> to csv file</td>
</tr>
<tr class="odd">
<td><code>DataFrame(load(file_name))</code></td>
<td>Read csv file from file with given name using <code>CSVFiles</code></td>
</tr>
<tr class="even">
<td><code>save(file_name, df)</code></td>
<td>Write data frame <code>df</code> to a csv file using <code>CSVFiles</code></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</section>
<section id="tablescraper" class="level4">
<h4 class="anchored" data-anchor-id="tablescraper">TableScraper</h4>
<p>The <code>TableScraper</code> package can scrape tables from an HTML file in a manner that can be passed to <code>DataFrame</code> for conversion to a data frame. The command <code>DataFrame.(scrape_tables(url))</code> may just work to create the tables, but in practice, only well-formed tables can be scraped successfully; tables used for formatting purposes may fail. <code>TableScraper</code> is built on <code>Cascadia</code> and <code>Gumbo</code>, as is the <code>Harbest</code> package, which provides more access to the underlying data than <code>TableScraper</code>.</p>
</section>
</section>
<section id="column-names" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="column-names"><span class="header-section-number">3.1.2</span> Column names</h3>
<p>The variable names of a data set are returned by the <code>names</code> function, as strings:</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>6-element Vector{String}:
 "b"
 "v"
 "p"
 "lap"
 "load"
 "d"</code></pre>
</div>
</div>
<p>This function has a second argument which can be used to narrow or filter the names that are returned. For example, the following is a convenience for matching columns whose element type is a subtype of <code>Real</code>:</p>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(d, <span class="dt">Real</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>2-element Vector{String}:
 "v"
 "p"</code></pre>
</div>
</div>
<p>The <code>rename!</code> function allows the names to be changed in-place (without returning a new data frame). There are many different calling patterns, but:</p>
<ul>
<li>to replace one name, the form <code>rename!(df, :v =&gt; :nv)</code> is used, where <code>:v</code> is the old name, and <code>:nv</code> the new one. The form follows the generic <code>replace!</code> function. The pair notation can be <em>broadcast</em> (<code>.=&gt;</code>) to replace more than one name, as with <code>replace!(df, [:v1, :v2] .=&gt; [:nv1, :nv2])</code>.</li>
<li>to replace allnames, the form <code>rename!(df, [...])</code> is used, where the vector is of length matching the number of columns in <code>df</code>.</li>
</ul>
</section>
<section id="indexing-and-assignment" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="indexing-and-assignment"><span class="header-section-number">3.1.3</span> Indexing and assignment</h3>
<p>The values in a data frame can be referenced programmatically by a row number and column number, both 1-based. For example, the 2nd row and 3rd column of <code>d</code> can be seen to be <code>349</code> by observation</p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Genius</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">228</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">clamshell</td>
<td style="text-align: left;">2022-10-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>but it can be referenced through indexing (row number first, column number second):</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>d[<span class="fl">2</span>, <span class="fl">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>349</code></pre>
</div>
</div>
<p>A new value can also be assigned with the same indexing reference. Suppose, that bag went on sale. This new price could be adjusted, as follows:</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>d[<span class="fl">2</span>, <span class="fl">3</span>] <span class="op">=</span> <span class="fl">309</span> <span class="co"># a sale price</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>309</code></pre>
</div>
</div>
<section id="column-selectors" class="level4">
<h4 class="anchored" data-anchor-id="column-selectors">Column selectors</h4>
<p>The 3rd column has a name, <code>p</code> in this case. We can use a <a href="https://www.juliabloggers.com/column-selectors-in-dataframes-jl/">column selector</a> to avoid having to know which column number a variable is. For this a string or a symbol may be used, as in:</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>d[<span class="fl">2</span>, <span class="op">:</span>p], d[<span class="fl">2</span>, <span class="st">"p"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(309, 309)</code></pre>
</div>
</div>
<p>More generally, it is possible to use more than 1 column in column selection. For example, to get both the volume and price, for the second bag we have:</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>d[<span class="fl">2</span>, [<span class="op">:</span>v, <span class="op">:</span>p]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>DataFrameRow (2 columns)</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowLabel" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowLabel" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowLabel" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">309</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>As well, either <code>[2, 3]</code> or <code>["v", "p"]</code> could have been used.</p>
<p>For data frames with many columns, a <em>regular</em> expression can be used. The column selector <code>r"^l"</code> would match all columns whose name begins with <code>l</code> (<code>lap</code> and <code>load</code>) in this case. (Regular expressions can be very complicated, but here we only assume that <code>r"name"</code> will match “name” somewhere in the string; <code>r"^name"</code> and <code>r"name$"</code> will match “name” at the beginning and ending of a string. Using a regular expression will return a data frame row (when a row index is specified)—not a value—as it is possible to return 0, 1 or more columns in the selection.</p>
<p>Column selectors, as seen may be column number(s), column names as strings, column names as symbols, and regular expressions.</p>
<p>In addition:</p>
<ul>
<li>Boolean vectors of a length matching the number of columns (<code>d[2, [false, true, true, false, false, false]]</code> would return the 2nd and 3rd columns.)</li>
<li>The value <code>All()</code> which selects all columns</li>
<li>the value <code>Between(a, b)</code> where, <code>a</code> and <code>b</code> are column selectors (such as <code>Between(:v, 3)</code>).</li>
<li><code>Not(...)</code> to select those columns not specified in <code>...</code></li>
<li><code>Cols(a,b,...)</code> which combines different selectors, such as <code>Cols(:v, 3)</code>.</li>
</ul>
</section>
<section id="slices" class="level4">
<h4 class="anchored" data-anchor-id="slices">Slices</h4>
<p>The <code>All()</code> column selector has a shortcut inherited from the indexing of arrays in base <code>Julia</code>, this being a colon, <code>:</code>. When used in the column position it refers to all the values in the row:</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>d[<span class="fl">2</span>, <span class="op">:</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>DataFrameRow (6 columns)</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowLabel" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowLabel" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowLabel" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">309</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>When used in the <em>row position</em>, it refers to all rows:</p>
<div id="44" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>d[<span class="op">:</span>, <span class="fl">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3-element Vector{Int64}:
 395
 309
 228</code></pre>
</div>
</div>
<p>In the above use, a vector is returned, not a data frame, as only one column was selected. But which vector? Is it a <em>copy</em> of the one that <code>d</code> holds, or is it the same container? In base <code>Julia</code> the answer depends on what side of an equals sign the use is on (meaning, if used in assignment the answer is different, as mentioned later). In this usage, a <em>copy</em> is returned.</p>
<p>To get the underlying column (not a copy), the selector <code>!</code> is used instead:</p>
<div id="46" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>d[!, <span class="fl">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3-element Vector{Int64}:
 395
 309
 228</code></pre>
</div>
</div>
<p>The notation <code>d.p</code> also refers to the 3rd variable. In this case, <code>d.p</code> is a view of the underlying data (using <code>!</code>) and not a copy.</p>
<p>The notation <code>d[:,:]</code> will refer to all rows and all columns of <code>d</code>, and in this case will be a <em>copy</em> of the data frame.</p>
</section>
<section id="assignment" class="level4">
<h4 class="anchored" data-anchor-id="assignment">Assignment</h4>
<p>Single values can be assigned, as previously illustrated. These values are assigned to the underlying vector in the data frame, so as with vectors, the assigned value will be promoted to the column type, if necessary. Assigning a value that can’t be promoted will throw and error, as it would were such an assignment tried for a vector. To do such an assignment, the underlying vector must be changed to a wider type.</p>
<p>The row selector <code>:</code> or <code>!</code> had different semantics when accessing the underlying data, the first returning a copy, the second a view. When used with assignment though, <code>:</code> refers to the underlying vector or does <em>in-place</em> assignment; whereas <code>!</code> (and the dot access) will <em>replace</em> the the underlying container with the assigned container.</p>
<p>To illustrate, suppose the prices are rounded down, but actually contain an extra 99 cents. We can reassign <code>price</code> as following:</p>
<div id="48" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>d[!, <span class="op">:</span>p] <span class="op">=</span> price <span class="op">.+</span> <span class="fl">0.99</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3-element Vector{Float64}:
 395.99
 349.99
 228.99</code></pre>
</div>
</div>
<p>as even though <code>price .+ 0.99</code> is no longer an integer vector, the <code>!</code> row indicator will instruct <code>d</code> to point to this new vector. Had <code>d[:, :p] = ...</code> been used above, an error would have been thrown as the underlying container is integer, but the new prices require floating point values to represent them.</p>
<p>Broadcast assignment (using <code>.=</code>) will be similar. The right hand side is expanded, and then assigned. Attempts to assign the wrong value type using <code>:</code> to indicate the rows will error.</p>
</section>
<section id="missing-values" class="level4">
<h4 class="anchored" data-anchor-id="missing-values">Missing values</h4>
<p>Trying to assign a value of <code>missing</code> to a data frame requires the underlying vector to allow missing values. As with vectors, the <code>allowmissing</code> function is useful. For example, to give the 2nd bag a price of missing, we could do:</p>
<div id="50" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">allowmissing!</span>(d, <span class="op">:</span>p)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>d[<span class="fl">2</span>, <span class="op">:</span>p] <span class="op">=</span> <span class="cn">missing</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>missing</code></pre>
</div>
</div>
<p>By using the mutating form (with the trailing <code>!</code>), the data frame <code>d</code> is mutated in the <code>allowmissing!</code> call. This could be observed by looking a the underlying column type.</p>
<p>The new type is a union of the old type and <code>Missing</code>, so we could reassign the old value:</p>
<div id="52" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>d[<span class="fl">2</span>, <span class="op">:</span>p] <span class="op">=</span> <span class="fl">349.99</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Genius</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">228.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">clamshell</td>
<td style="text-align: left;">2022-10-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="tables.jl-interface" class="level4">
<h4 class="anchored" data-anchor-id="tables.jl-interface">Tables.jl interface</h4>
<p>A table, like a data frame can be expected to loop, or iterate, over columns, say to find which columns are numeric. Or, they can be expected to iterate over rows, say to find which values are within a certain range. What should be the case with a data frame? As there are reasons to prefer either, none is specified. Rather, there is a difference based on the calling function. Data frames respect the <code>Tables</code> interface, which has methods to iterate over rows or columns. When iterating over columns, the individual vectors are given; when iterating over rows, a <code>DataFrameRow</code> object is returned. Calling <code>copy</code> on these rows objects will return a named tuple.</p>
<p>The basic iterators are <code>eachrow</code> and <code>eachcol</code>. For example, to see the column type for a data frame, we can broadcast <code>eltype</code> over the variables returned by <code>eachcol</code>:</p>
<div id="54" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eltype</span>.(<span class="fu">eachcol</span>(d))  <span class="op">|&gt;</span> permutedims</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>1×6 Matrix{Type}:
 String  Int64  Union{Missing, Float64}  …  Date</code></pre>
</div>
</div>
<p>To get the data frame as a vector of named tuples, then broadcasting <code>NamedTuple</code> over <code>eachrow</code> can be used: <code>NamedTuple.(eachrow(d))</code>; <code>Base.copy</code> is an alias. <code>Tables.rowtable(d)</code> will produce this vector of named tuples, as well.</p>
</section>
</section>
<section id="sorting" class="level3" data-number="3.1.4">
<h3 data-number="3.1.4" class="anchored" data-anchor-id="sorting"><span class="header-section-number">3.1.4</span> Sorting</h3>
<p>A data frame can be sorted by specifying a permutation of the indices, such as is returned by <code>sortperm</code>. For example, <code>d[sortperm(d.price), :]</code> will sort by price in increasing order. The keyword argument <code>rev</code> can be passed <code>true</code> to reverse the default sort order.</p>
<p>The generic <code>sort</code> function has a method for data frames, that offers a more convenient functionality. The <code>sort!</code> method does in-place sorting. The simplest call is to pass in a column to sort by, as in</p>
<div id="56" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(d, <span class="op">:</span>p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Genius</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">228.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">clamshell</td>
<td style="text-align: left;">2022-10-01</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>This sorts by the price (<code>:p</code>) variable in <em>increasing</em> order. To sort by decreasing order a keyword argument <code>rev=true</code> can be specified:</p>
<div id="58" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(d, <span class="st">"v"</span>; rev<span class="op">=</span><span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Genius</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">228.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">clamshell</td>
<td style="text-align: left;">2022-10-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>There can be one or more column selectors. For this, the <code>order</code> function can be used to reverse just one of the columns, as in the following, which first sorts the dates in reverse order (newest first) and then within a data, uses lowest price first to sort:</p>
<div id="60" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(d, [<span class="fu">order</span>(<span class="st">"d"</span>, rev<span class="op">=</span><span class="cn">true</span>), <span class="op">:</span>p])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Genius</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">228.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">clamshell</td>
<td style="text-align: left;">2022-10-01</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="filtering-rows" class="level3" data-number="3.1.5">
<h3 data-number="3.1.5" class="anchored" data-anchor-id="filtering-rows"><span class="header-section-number">3.1.5</span> Filtering rows</h3>
<p>Filtering, or subsetting, is a means to select a specified selection of rows.</p>
<p>Let’s consider the <code>cars</code> data set, previously defined by loading <code>dataset("MASS", "Cars93")</code>. This data set consists of 27 measurements on 93 cars from the 1990s. The data set comes from R’s <code>MASS</code> package, and is documented there.</p>
<p>Two ready ways to filter are by using specific indices, or by using Boolean indices generated by a logical comparison.</p>
<p>For the <code>cars</code> data set, the latter can be used to extract the Volkswagen models. To generate the indices we compare the <code>:Manufacturer</code> variable with the string <code>Volkswagen</code> to return a vector of length 93 that indicates if the manufacturer is VW. This is done with <em>broadcasting</em>: <code>cars.Manufacturer .== "Volkswagen"</code>. We use the easy dot access to variables in <code>cars</code>, alternatively <code>cars[:, :Manufacturer]</code> (or, more efficiently, <code>!</code>, as is used by the dot access) could be used were <code>:Manufacturer</code> coming from some variable. With this row selector, we have:</p>
<div id="62" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>cars[cars.Manufacturer <span class="op">.==</span> <span class="st">"Volkswagen"</span>, <span class="op">:</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>4×27 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Manufacturer</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MinPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MaxPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGCity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGHighway</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AirBags</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DriveTrain</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Cylinders</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">EngineSize</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Horsepower</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RPM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RevPerMile</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ManTransAvail</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FuelTankCapacity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Passengers</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Length</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Wheelbase</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Width</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">TurnCircle</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RearSeatRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">LuggageRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Weight</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Origin</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Make</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int32}">Int32?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Fox</td>
<td style="text-align: left;">Small</td>
<td style="text-align: right;">8.7</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">5500</td>
<td style="text-align: right;">2550</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">12.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2240</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Fox</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Eurovan</td>
<td style="text-align: left;">Van</td>
<td style="text-align: right;">16.6</td>
<td style="text-align: right;">19.7</td>
<td style="text-align: right;">22.7</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">21</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">5</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">4500</td>
<td style="text-align: right;">2915</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">21.1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">187</td>
<td style="text-align: right;">115</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">34.0</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right;">3960</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Eurovan</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Passat</td>
<td style="text-align: left;">Compact</td>
<td style="text-align: right;">17.6</td>
<td style="text-align: right;">20.0</td>
<td style="text-align: right;">22.4</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">5800</td>
<td style="text-align: right;">2685</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">18.5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">31.5</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">2985</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Passat</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Corrado</td>
<td style="text-align: left;">Sporty</td>
<td style="text-align: right;">22.9</td>
<td style="text-align: right;">23.3</td>
<td style="text-align: right;">23.7</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">25</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">6</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">178</td>
<td style="text-align: right;">5800</td>
<td style="text-align: right;">2385</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">18.5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">159</td>
<td style="text-align: right;">97</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">2810</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Corrado</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>This approach lends itself to the description “find all rows matching some value” then “extract the identified rows,”—written as two steps to emphasize there are two passes through the data. Another mental model would be loop over the rows, and keep those that match the query. This is done generically by the <code>filter</code> function for collections in <code>Julia</code> or by the <code>subset</code> function of <code>DataFrames</code>.</p>
<p>The <code>filter(predicate, collection)</code> function is used to identify just the values in the collection for which the predicate function returns <code>true</code>. When a data frame is used with <code>filter</code>, the iteration is over the rows, so the wrapping <code>eachrow</code> iterator is not needed. We need a predicate function to replace the <code>.==</code> above. One follows. It doesn’t need <code>.==</code>, as <code>r</code> is a data frame row and access produces a value not a vector:</p>
<div id="64" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(r <span class="op">-&gt;</span> r.Manufacturer <span class="op">==</span> <span class="st">"Volkswagen"</span>, cars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>4×27 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Manufacturer</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MinPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MaxPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGCity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGHighway</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AirBags</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DriveTrain</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Cylinders</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">EngineSize</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Horsepower</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RPM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RevPerMile</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ManTransAvail</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FuelTankCapacity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Passengers</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Length</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Wheelbase</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Width</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">TurnCircle</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RearSeatRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">LuggageRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Weight</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Origin</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Make</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int32}">Int32?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Fox</td>
<td style="text-align: left;">Small</td>
<td style="text-align: right;">8.7</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">5500</td>
<td style="text-align: right;">2550</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">12.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2240</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Fox</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Eurovan</td>
<td style="text-align: left;">Van</td>
<td style="text-align: right;">16.6</td>
<td style="text-align: right;">19.7</td>
<td style="text-align: right;">22.7</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">21</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">5</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">4500</td>
<td style="text-align: right;">2915</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">21.1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">187</td>
<td style="text-align: right;">115</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">34.0</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right;">3960</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Eurovan</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Passat</td>
<td style="text-align: left;">Compact</td>
<td style="text-align: right;">17.6</td>
<td style="text-align: right;">20.0</td>
<td style="text-align: right;">22.4</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">5800</td>
<td style="text-align: right;">2685</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">18.5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">31.5</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">2985</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Passat</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Corrado</td>
<td style="text-align: left;">Sporty</td>
<td style="text-align: right;">22.9</td>
<td style="text-align: right;">23.3</td>
<td style="text-align: right;">23.7</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">25</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">6</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">178</td>
<td style="text-align: right;">5800</td>
<td style="text-align: right;">2385</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">18.5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">159</td>
<td style="text-align: right;">97</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">2810</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Corrado</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>There are some <em>conveniences</em> that have been developed to make the predicate functions even easier to write, which will be introduced incrementally:</p>
<p>The basic binary comparisons, like <code>==</code>, are defined by functions essentially of the form <code>(a,b) -&gt; ==(a,b)</code>. There are <em>partially applied</em> versions, essentially <code>a -&gt; ==(a,b)</code>, with <code>b</code> applied, formed by <code>==(b)</code>. So the syntax <code>==("Volkswagen")</code> is a predicate taking a single argument which is then compared for equality to the string <code>"Volkswagen"</code>.</p>
<p>However, <code>r</code> is a data frame row, what we need to pass to <code>==("Volkswagen")</code> is the value of the <code>:Manufacturer</code> column. For this another convenience is available.</p>
<p>The <code>pair</code> syntax, <code>=&gt;</code> of the form <code>column selector(s) =&gt; predicate function</code> will pass just the value(s) in the column(s) to the predicate function. Combined, the above can be simplified to:</p>
<div id="66" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="op">:</span>Manufacturer <span class="op">=&gt;</span> <span class="op">==</span>(<span class="st">"Volkswagen"</span>), cars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>4×27 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Manufacturer</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MinPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MaxPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGCity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGHighway</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AirBags</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DriveTrain</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Cylinders</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">EngineSize</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Horsepower</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RPM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RevPerMile</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ManTransAvail</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FuelTankCapacity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Passengers</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Length</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Wheelbase</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Width</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">TurnCircle</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RearSeatRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">LuggageRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Weight</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Origin</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Make</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int32}">Int32?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Fox</td>
<td style="text-align: left;">Small</td>
<td style="text-align: right;">8.7</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">5500</td>
<td style="text-align: right;">2550</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">12.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2240</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Fox</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Eurovan</td>
<td style="text-align: left;">Van</td>
<td style="text-align: right;">16.6</td>
<td style="text-align: right;">19.7</td>
<td style="text-align: right;">22.7</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">21</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">5</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">4500</td>
<td style="text-align: right;">2915</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">21.1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">187</td>
<td style="text-align: right;">115</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">34.0</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right;">3960</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Eurovan</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Passat</td>
<td style="text-align: left;">Compact</td>
<td style="text-align: right;">17.6</td>
<td style="text-align: right;">20.0</td>
<td style="text-align: right;">22.4</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">5800</td>
<td style="text-align: right;">2685</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">18.5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">31.5</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">2985</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Passat</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Corrado</td>
<td style="text-align: left;">Sporty</td>
<td style="text-align: right;">22.9</td>
<td style="text-align: right;">23.3</td>
<td style="text-align: right;">23.7</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">25</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">6</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">178</td>
<td style="text-align: right;">5800</td>
<td style="text-align: right;">2385</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">18.5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">159</td>
<td style="text-align: right;">97</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">2810</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Corrado</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>It doesn’t save much for this simple example, but this specification style is the basis of the <code>DataFrames</code> mini language, which provides a standardized and performant means of wrangling a data frame.</p>
<p>Filtering may be done on one or more values. There are different approaches.</p>
<p>For example, to first filter by the manufacturer, then by city mileage, we might write a more complicated predicate function using <code>&amp;&amp;</code> to combine Boolean values:</p>
<div id="68" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pred</span>(r) <span class="op">=</span> r.Manufacturer <span class="op">==</span> <span class="st">"Volkswagen"</span> <span class="op">&amp;&amp;</span> r.MPGCity <span class="op">&gt;=</span> <span class="fl">20</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(pred, cars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×27 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Manufacturer</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MinPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MaxPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGCity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGHighway</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AirBags</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DriveTrain</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Cylinders</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">EngineSize</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Horsepower</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RPM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RevPerMile</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ManTransAvail</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FuelTankCapacity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Passengers</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Length</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Wheelbase</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Width</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">TurnCircle</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RearSeatRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">LuggageRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Weight</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Origin</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Make</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int32}">Int32?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Fox</td>
<td style="text-align: left;">Small</td>
<td style="text-align: right;">8.7</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">5500</td>
<td style="text-align: right;">2550</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">12.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2240</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Fox</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Passat</td>
<td style="text-align: left;">Compact</td>
<td style="text-align: right;">17.6</td>
<td style="text-align: right;">20.0</td>
<td style="text-align: right;">22.4</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">5800</td>
<td style="text-align: right;">2685</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">18.5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">31.5</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">2985</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Passat</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The mini language can also be used. On the left hand side of (the first) <code>=&gt;</code> a vector of column selectors may be indicated, in which the predicate function (on the right hand side of the first <code>=&gt;</code>) will get multiple arguments that can be used to implement the logic:</p>
<div id="70" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pred</span>(m, mpg) <span class="op">=</span> m <span class="op">==</span> <span class="st">"Volkswagen"</span> <span class="op">&amp;&amp;</span> mpg <span class="op">&gt;=</span> <span class="fl">20</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>([<span class="op">:</span>Manufacturer, <span class="op">:</span>MPGCity] <span class="op">=&gt;</span> pred, cars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×27 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Manufacturer</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MinPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MaxPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGCity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGHighway</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AirBags</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DriveTrain</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Cylinders</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">EngineSize</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Horsepower</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RPM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RevPerMile</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ManTransAvail</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FuelTankCapacity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Passengers</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Length</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Wheelbase</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Width</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">TurnCircle</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RearSeatRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">LuggageRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Weight</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Origin</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Make</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int32}">Int32?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Fox</td>
<td style="text-align: left;">Small</td>
<td style="text-align: right;">8.7</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">5500</td>
<td style="text-align: right;">2550</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">12.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2240</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Fox</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Passat</td>
<td style="text-align: left;">Compact</td>
<td style="text-align: right;">17.6</td>
<td style="text-align: right;">20.0</td>
<td style="text-align: right;">22.4</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">5800</td>
<td style="text-align: right;">2685</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">18.5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">31.5</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">2985</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Passat</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Finally, we could use <code>filter</code> twice:</p>
<div id="72" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>cars1 <span class="op">=</span> <span class="fu">filter</span>(<span class="op">:</span>Manufacturer <span class="op">=&gt;</span> <span class="op">==</span>(<span class="st">"Volkswagen"</span>), cars)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>cars2 <span class="op">=</span> <span class="fu">filter</span>(<span class="op">:</span>MPGCity <span class="op">=&gt;</span> <span class="op">&gt;=</span>(<span class="fl">20</span>), cars1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×27 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Manufacturer</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MinPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MaxPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGCity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGHighway</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AirBags</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DriveTrain</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Cylinders</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">EngineSize</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Horsepower</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RPM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RevPerMile</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ManTransAvail</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FuelTankCapacity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Passengers</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Length</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Wheelbase</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Width</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">TurnCircle</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RearSeatRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">LuggageRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Weight</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Origin</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Make</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int32}">Int32?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Fox</td>
<td style="text-align: left;">Small</td>
<td style="text-align: right;">8.7</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">5500</td>
<td style="text-align: right;">2550</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">12.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2240</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Fox</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Passat</td>
<td style="text-align: left;">Compact</td>
<td style="text-align: right;">17.6</td>
<td style="text-align: right;">20.0</td>
<td style="text-align: right;">22.4</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">5800</td>
<td style="text-align: right;">2685</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">18.5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">31.5</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">2985</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Passat</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The above required the introduction of an intermediate data frame to store the result of the first <code>filter</code> call to pass to the second. This threading through of the modified data is quite common in processing pipelines. The first two approaches with complicated predicate functions can grow unwieldy, so staged modification is common. To support that, the chaining or piping operation (<code>|&gt;</code>) is often used:</p>
<div id="74" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="op">:</span>Manufacturer <span class="op">=&gt;</span> <span class="op">==</span>(<span class="st">"Volkswagen"</span>), cars) <span class="op">|&gt;</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>    d <span class="op">-&gt;</span> <span class="fu">filter</span>(<span class="op">:</span>MPGCity <span class="op">=&gt;</span> <span class="op">&gt;=</span>(<span class="fl">20</span>), d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×27 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Manufacturer</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MinPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MaxPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGCity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGHighway</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AirBags</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DriveTrain</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Cylinders</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">EngineSize</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Horsepower</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RPM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RevPerMile</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ManTransAvail</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FuelTankCapacity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Passengers</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Length</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Wheelbase</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Width</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">TurnCircle</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RearSeatRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">LuggageRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Weight</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Origin</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Make</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int32}">Int32?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Fox</td>
<td style="text-align: left;">Small</td>
<td style="text-align: right;">8.7</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">5500</td>
<td style="text-align: right;">2550</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">12.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2240</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Fox</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Passat</td>
<td style="text-align: left;">Compact</td>
<td style="text-align: right;">17.6</td>
<td style="text-align: right;">20.0</td>
<td style="text-align: right;">22.4</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">5800</td>
<td style="text-align: right;">2685</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">18.5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">31.5</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">2985</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Passat</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The right-hand side of <code>|&gt;</code> expects a function for application, so an anonymous function is created. There are <em>macros</em> available in user-contributed packages that shorten this pattern by using a placeholder.</p>
<p>A popular one is, <code>@chain</code>, in the <code>Chain</code> package, with its basic usage based on two simple principles:</p>
<ul>
<li>a new line is implicitly a pipe</li>
<li>a <code>_</code> receives the argument from the pipe. If none is given, the first argument does</li>
</ul>
<p>For example,</p>
<div id="76" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Chain</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="78" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@chain</span> cars <span class="cf">begin</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="op">:</span>Manufacturer <span class="op">=&gt;</span> <span class="op">==</span>(<span class="st">"Volkswagen"</span>), _)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="op">:</span>MPGCity <span class="op">=&gt;</span> <span class="op">&gt;=</span>(<span class="fl">20</span>), _)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×27 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Manufacturer</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MinPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MaxPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGCity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGHighway</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AirBags</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DriveTrain</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Cylinders</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">EngineSize</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Horsepower</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RPM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RevPerMile</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ManTransAvail</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FuelTankCapacity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Passengers</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Length</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Wheelbase</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Width</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">TurnCircle</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RearSeatRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">LuggageRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Weight</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Origin</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Make</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int32}">Int32?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Fox</td>
<td style="text-align: left;">Small</td>
<td style="text-align: right;">8.7</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">5500</td>
<td style="text-align: right;">2550</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">12.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2240</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Fox</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Passat</td>
<td style="text-align: left;">Compact</td>
<td style="text-align: right;">17.6</td>
<td style="text-align: right;">20.0</td>
<td style="text-align: right;">22.4</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">5800</td>
<td style="text-align: right;">2685</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">18.5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">31.5</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">2985</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Passat</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="subset" class="level4">
<h4 class="anchored" data-anchor-id="subset">Subset</h4>
<p>The calling style <code>filter(predicate, collection)</code> is consistently used with several higher-order functions, for example, <code>map</code> and <code>reduce</code> and is supported by <code>Julia</code>’s <code>do</code> syntax.</p>
<p>However, with data frames, the convention is to have action functions expect the data frame in the first position.</p>
<p>The <code>subset</code> function also returns a filtered copy of the data frame with rows matching a certain selection criteria. It’s usage is somewhat similar to <code>filter</code> with the order of its arguments reversed, but the predicate must return a vector of indices, so broadcasting or the <code>ByRow</code> function may be necessary.</p>
<p>For example, these produce the same data frame:</p>
<div id="80" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="op">=</span> <span class="fu">subset</span>(cars, <span class="op">:</span>Manufacturer <span class="op">=&gt;</span> m <span class="op">-&gt;</span> m <span class="op">.==</span> <span class="st">"Volkswagen"</span>) <span class="co"># use .== not just ==</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>d2 <span class="op">=</span> <span class="fu">subset</span>(cars, <span class="op">:</span>Manufacturer <span class="op">=&gt;</span> <span class="fu">ByRow</span>(<span class="op">==</span>(<span class="st">"Volkswagen"</span>))) <span class="co"># use `ByRow` to ensure predicate is applied to each</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>4×27 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Manufacturer</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MinPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MaxPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGCity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGHighway</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AirBags</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DriveTrain</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Cylinders</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">EngineSize</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Horsepower</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RPM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RevPerMile</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ManTransAvail</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FuelTankCapacity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Passengers</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Length</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Wheelbase</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Width</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">TurnCircle</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RearSeatRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">LuggageRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Weight</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Origin</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Make</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int32}">Int32?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Fox</td>
<td style="text-align: left;">Small</td>
<td style="text-align: right;">8.7</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">5500</td>
<td style="text-align: right;">2550</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">12.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2240</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Fox</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Eurovan</td>
<td style="text-align: left;">Van</td>
<td style="text-align: right;">16.6</td>
<td style="text-align: right;">19.7</td>
<td style="text-align: right;">22.7</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">21</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">5</td>
<td style="text-align: right;">2.5</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">4500</td>
<td style="text-align: right;">2915</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">21.1</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">187</td>
<td style="text-align: right;">115</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">34.0</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right;">3960</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Eurovan</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Passat</td>
<td style="text-align: left;">Compact</td>
<td style="text-align: right;">17.6</td>
<td style="text-align: right;">20.0</td>
<td style="text-align: right;">22.4</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">5800</td>
<td style="text-align: right;">2685</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">18.5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">31.5</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">2985</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Passat</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Corrado</td>
<td style="text-align: left;">Sporty</td>
<td style="text-align: right;">22.9</td>
<td style="text-align: right;">23.3</td>
<td style="text-align: right;">23.7</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">25</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">6</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">178</td>
<td style="text-align: right;">5800</td>
<td style="text-align: right;">2385</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">18.5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">159</td>
<td style="text-align: right;">97</td>
<td style="text-align: right;">66</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">2810</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Corrado</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Unlike <code>filter</code>, <code>subset</code> allows multiple arguments to be applied:</p>
<div id="82" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(cars,</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>       <span class="op">:</span>Manufacturer <span class="op">=&gt;</span> <span class="fu">ByRow</span>(<span class="op">==</span>(<span class="st">"Volkswagen"</span>)),</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>       <span class="op">:</span>MPGCity      <span class="op">=&gt;</span> <span class="fu">ByRow</span>(<span class="op">&gt;=</span>(<span class="fl">20</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×27 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Manufacturer</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MinPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MaxPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGCity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGHighway</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">AirBags</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DriveTrain</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Cylinders</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">EngineSize</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Horsepower</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RPM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RevPerMile</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ManTransAvail</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FuelTankCapacity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Passengers</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Length</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Wheelbase</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Width</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">TurnCircle</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RearSeatRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">LuggageRoom</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Weight</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Origin</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Make</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int32}">Int32?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int32">Int32</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Fox</td>
<td style="text-align: left;">Small</td>
<td style="text-align: right;">8.7</td>
<td style="text-align: right;">9.1</td>
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">81</td>
<td style="text-align: right;">5500</td>
<td style="text-align: right;">2550</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">12.4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">93</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">26.0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">2240</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Fox</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Volkswagen</td>
<td style="text-align: left;">Passat</td>
<td style="text-align: left;">Compact</td>
<td style="text-align: right;">17.6</td>
<td style="text-align: right;">20.0</td>
<td style="text-align: right;">22.4</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">None</td>
<td style="text-align: left;">Front</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">2.0</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">5800</td>
<td style="text-align: right;">2685</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: right;">18.5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">180</td>
<td style="text-align: right;">103</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">31.5</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">2985</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: left;">Volkswagen Passat</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The mini language uses a default of <code>identity</code> for the function so, if the columns are Boolean, they can be used to subset the data:</p>
<div id="84" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>dd <span class="op">=</span> <span class="fu">DataFrame</span>(a <span class="op">=</span> [<span class="cn">true</span>, <span class="cn">false</span>], b <span class="op">=</span> [<span class="cn">true</span>, <span class="cn">missing</span>])</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(dd, <span class="op">:</span>a)  <span class="co"># just first row</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>1×2 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">a</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Bool">Bool</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Bool}">Bool?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: right;">true</td>
<td style="text-align: right;">true</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>For data with missing values, like in the <code>:b</code> column of <code>dd</code>, the comparison operators implement 3-valued logic, meaning the response can be <code>true</code>, <code>false</code>, <em>or</em> <code>missing</code>. Using <code>subset(dd, :b)</code> above will error. The keyword <code>skipmissing</code> can be passed <code>true</code> to have these skipped over. The default is false.</p>
<div id="86" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(dd, <span class="op">:</span>b; skipmissing<span class="op">=</span><span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>1×2 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">a</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Bool">Bool</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Bool}">Bool?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: right;">true</td>
<td style="text-align: right;">true</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The <code>dropmissing</code> function filters out each row that has a <code>missing</code> value.</p>
</section>
</section>
<section id="selecting-columns-transforming-data" class="level3" data-number="3.1.6">
<h3 data-number="3.1.6" class="anchored" data-anchor-id="selecting-columns-transforming-data"><span class="header-section-number">3.1.6</span> Selecting columns; transforming data</h3>
<p>Filtering of a data frame can be viewed as accessing the data in <code>df</code> with a boolean set of row indices, as in <code>df[inds, :]</code>. (There are flags to have a “view” of the data, as in <code>df[inds, !]</code>). Filtering returns a data frame with a possibly reduced number of rows, and the same number of columns.</p>
<p>The <code>select</code> function is related in that it can be viewed as passing a Boolean vector of column indices to select specific columns or variables, as in <code>df[:, inds]</code>. The syntax of <code>select</code> also extends this allowing transformations of the data and reassignment, as could be achieved through this pattern: <code>df.new_variable = f(other_variables_in_df)</code>.</p>
<p>The <code>select</code> function will return a data frame with the same number of rows (cases) as the original data frame. The variables returned are selected using column selectors. There is support for the <code>DataFrames</code> mini language.</p>
<p>First, we can select one or more columns by separating column selectors with commas. In the following, using the backpack data in the variable <code>d</code>, we select the first column by column number, the second using a symbol, the third by a string, and the fourth and fifth using a regular expression:<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<div id="88" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(d, <span class="fl">1</span>, <span class="op">:</span>v, <span class="st">"p"</span>, <span class="st">r"^l"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×5 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Genius</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">228.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">clamshell</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>One use of <code>select</code> is to rearrange the column order, say by moving a column to the front. The <code>:</code> or <code>All()</code> column selector will add the rest. That is this command would move “<code>d</code>” to the front of the other columns: <code>select(d, :d, All())</code>.</p>
<p>Selection also allows an easy renaming of column names, using the pairs notation <code>column name =&gt; new column name</code>:</p>
<div id="90" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(d, <span class="op">:</span>v <span class="op">=&gt;</span> <span class="op">:</span>volume, <span class="st">"p"</span> <span class="op">=&gt;</span> <span class="st">"price"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×2 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">volume</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">price</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395.99</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349.99</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">228.99</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>This usage is a supported abbreviation of <code>source_column =&gt; function =&gt; target_column_name</code>, where the function is <code>identity</code>. Here the function is not necessarily a predicate function, as it is with <code>subset</code>, but rather a function which returns a vector of the same length as the number of columns in the data frame (as <code>select</code> <em>always</em> returns the same number of columns as the data frame it is passed.)</p>
<p>The function receives column vectors and should return a column vector. For a scalar function, it must be applied to each entry of the column vector, that is, each row. Broadcasting is one manner to do this. As used previously, the <code>DataFrames</code> package provides <code>ByRow</code> to also apply a function to each row of the column vector(s).</p>
<p>For example to compute a ratio of price to volume, we might have:</p>
<div id="92" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(d, [<span class="op">:</span>p, <span class="op">:</span>v] <span class="op">=&gt;</span> <span class="fu">ByRow</span>((p,v) <span class="op">-&gt;</span> p<span class="op">/</span>v) <span class="op">=&gt;</span> <span class="st">"price to volume"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×1 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">price to volume</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: right;">9.89975</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: right;">9.99971</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: right;">9.1596</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The above would be equivalent to <code>select(d, [:p, :v] =&gt; ((p,v) -&gt; p./v) =&gt; "price to volume")</code> (broadcasted <code>p ./ v</code> <strong>and</strong> parentheses), but not <code>select(d, [:p, :v] =&gt; (p,v) -&gt; p./v =&gt; "price to volume")</code>, as the precedence rules for <code>=&gt;</code> do not parse the expressions identically. That is, the use of parentheses around an anonymous function is needed.</p>
<p>The specification of a target column name is not necessary, as one will be generated. In this particular example, it would be <code>:p_v_function</code>. For named functions, the automatic namings are a bit more informative, as the method name replaces the “<code>function</code>” part. The <code>renamecols</code> keyword argument can be set to <code>false</code> to drop the addition of a function name, which in this case would leave <code>:p_v</code> as the name. For a single-column selector it would not rename the column, rather replace it.</p>
<p>The above reduced the number of columns to just that specified. The <code>:</code> selector will select <em>all</em> columns (as it does with indexing) and return them:</p>
<div id="94" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(d, [<span class="op">:</span>p, <span class="op">:</span>v] <span class="op">=&gt;</span> <span class="fu">ByRow</span>((p,v) <span class="op">-&gt;</span> p<span class="op">/</span>v) <span class="op">=&gt;</span> <span class="st">"price to volume"</span>, <span class="op">:</span>) <span class="co"># return all columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×7 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">price to volume</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: right;">9.89975</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: right;">9.99971</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: right;">9.1596</td>
<td style="text-align: left;">Genius</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">228.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">clamshell</td>
<td style="text-align: left;">2022-10-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>As seen in this last example, the source column selectors can select more than one column. The function receives multiple arguments. It is possible that there be <em>multiple</em> target columns. For example, we could compute both price-to-volume and volume-to-price quantities. A function to do so would be</p>
<div id="96" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pv_and_vp</span>(p,v) <span class="op">=</span> [p<span class="op">/</span>v, v<span class="op">/</span>p]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>pv_and_vp (generic function with 1 method)</code></pre>
</div>
</div>
<p>When we use this, we see the two values are stored in one column.</p>
<div id="98" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(d, [<span class="op">:</span>p, <span class="op">:</span>v] <span class="op">=&gt;</span> <span class="fu">ByRow</span>(pv_and_vp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×1 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p_v_pv_and_vp</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Vector{Float64}">Array…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">[9.89975, 0.101013]</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">[9.99971, 0.100003]</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">[9.1596, 0.109175]</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>To split these up, we can give <em>two</em> names:</p>
<div id="100" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(d, [<span class="op">:</span>p, <span class="op">:</span>v] <span class="op">=&gt;</span> <span class="fu">ByRow</span>(pv_and_vp) <span class="op">=&gt;</span> [<span class="op">:</span>pv, <span class="op">:</span>vp])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×2 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">pv</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">vp</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: right;">9.89975</td>
<td style="text-align: right;">0.101013</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: right;">9.99971</td>
<td style="text-align: right;">0.100003</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: right;">9.1596</td>
<td style="text-align: right;">0.109175</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<section id="astable" class="level4">
<h4 class="anchored" data-anchor-id="astable"><code>AsTable</code></h4>
<p>The <code>AsTable</code> function has two meanings in the mini language. If on the target side, it assumes the output of the function is a vector of containers (in this example the vectors <code>[p/v, v/p]</code>) that should be expanded into multiple columns. It uses the keys (were the containers named tuples) or, in this case generates them, to create multiple columns in the destination:</p>
<div id="102" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(d, [<span class="op">:</span>p, <span class="op">:</span>v] <span class="op">=&gt;</span> <span class="fu">ByRow</span>(pv_and_vp) <span class="op">=&gt;</span> AsTable)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×2 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">x1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">x2</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: right;">9.89975</td>
<td style="text-align: right;">0.101013</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: right;">9.99971</td>
<td style="text-align: right;">0.100003</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: right;">9.1596</td>
<td style="text-align: right;">0.109175</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Had we used a named tuple in our function, <code>pv_and_vp(p, v) = (pv = p/v, vp = v/p)</code>, then the column names would come from the tuple’s names and need not be generated.</p>
<p>When <code>AsTable</code> is used on the source columns, as in <code>AsTable([:p,:v])</code> then the function receives a named tuple with column vector entries. (For this, <code>pv_and_vp</code> would be written <code>pv_and_vp(r) = [r.p/r.v, r.v/r.p]</code>, with <code>r</code> representing a row in a two-column table with names <code>:p</code> and <code>:v</code>.</p>
</section>
<section id="transform" class="level4">
<h4 class="anchored" data-anchor-id="transform">Transform</h4>
<p>Extending the columns in the data frame by <code>select</code> is common enough that the function <code>transform</code> is supplied which always keeps the columns of the original data frame, though they can also be modified through the mini language. The use of transform is equivalent to <code>select(df, :, args...)</code>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The DataFrames’ mini language
</div>
</div>
<div class="callout-body-container callout-body">
<p>The mini language is well documented in the documentation string of <code>transform</code> and the <a href="https://bkamins.github.io/julialang/2020/12/24/minilanguage.html">blog post</a> of Bogumil Kasminski “DataFrames.jl minilanguage explained.”</p>
</div>
</div>
</section>
</section>
<section id="combine" class="level3" data-number="3.1.7">
<h3 data-number="3.1.7" class="anchored" data-anchor-id="combine"><span class="header-section-number">3.1.7</span> Combine</h3>
<p>The <code>combine</code> function creates a new data frame whose columns are the result of transformations applied to the source data frame. The name will be more clear after we discuss grouping or splitting of a data set.</p>
<p>A typical usage of combine is to apply some reduction to the data, for example finding an average.</p>
<p>In this example, we use the <code>mean</code> function from the <code>StatsBase</code> package and apply that to the <code>:MPGCity</code> measurements in the <code>cars</code> data:</p>
<div id="104" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">combine</span>(cars, <span class="op">:</span>MPGCity <span class="op">=&gt;</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>1×1 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGCity_mean</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: right;">22.3656</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>(A second pair can be used to specify a name for the target, as in <code>:MPGCity =&gt; mean =&gt; :AvgMPGCity</code>)</p>
<p>There are several numeric variables in this data set, we may wish to find the mean of more than 1 at a time. For this, we can broadcast the columns via <code>.=&gt;</code>, as in this example:</p>
<div id="106" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">combine</span>(cars, [<span class="op">:</span>MPGCity, <span class="op">:</span>MPGHighway] <span class="op">.=&gt;</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>1×2 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGCity_mean</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGHighway_mean</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: right;">22.3656</td>
<td style="text-align: right;">29.086</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>(That is an alternate to <code>combine(cars, :MPGCity =&gt; mean, :MPGHighway =&gt; mean)</code>.)</p>
<p>Broadcasting <code>=&gt;</code> lends itself to succinctly applying a function to multiple columns.</p>
<p>For example, to apply <code>mean</code> to all the numeric values, we might select them first (using the filtering feature of <code>names</code>), then pass to the mini language, as follows:</p>
<div id="108" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>nms <span class="op">=</span> <span class="fu">names</span>(cars, <span class="dt">Real</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">combine</span>(cars, nms <span class="op">.=&gt;</span> mean; renamecols<span class="op">=</span><span class="cn">false</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>1×16 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MinPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MaxPrice</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGCity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGHighway</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">EngineSize</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Horsepower</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RPM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">RevPerMile</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">FuelTankCapacity</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Passengers</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Length</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Wheelbase</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Width</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">TurnCircle</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Weight</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: right;">17.1258</td>
<td style="text-align: right;">19.5097</td>
<td style="text-align: right;">21.8989</td>
<td style="text-align: right;">22.3656</td>
<td style="text-align: right;">29.086</td>
<td style="text-align: right;">2.66774</td>
<td style="text-align: right;">143.828</td>
<td style="text-align: right;">5280.65</td>
<td style="text-align: right;">2332.2</td>
<td style="text-align: right;">16.6645</td>
<td style="text-align: right;">5.08602</td>
<td style="text-align: right;">183.204</td>
<td style="text-align: right;">103.946</td>
<td style="text-align: right;">69.3763</td>
<td style="text-align: right;">38.957</td>
<td style="text-align: right;">3072.9</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>More than one transformation at a time is possible, as already seen in the mini language. With <code>combine</code> the number of rows is determined by the output of the transformation. In this example, the <code>mean</code> reduces to a number, but <code>unique</code> reduces <code>:Origin</code> to the number of levels. The result of <code>mean</code> is repeated, <strong>it is not</strong> the mean for each group (a task we demonstrate shortly):</p>
<div id="110" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">combine</span>(cars, <span class="op">:</span>MPGCity <span class="op">=&gt;</span> mean, <span class="op">:</span>Origin <span class="op">=&gt;</span> unique)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×2 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGCity_mean</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Origin_unique</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: right;">22.3656</td>
<td style="text-align: left;">non-USA</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: right;">22.3656</td>
<td style="text-align: left;">USA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="flatten" class="level3" data-number="3.1.8">
<h3 data-number="3.1.8" class="anchored" data-anchor-id="flatten"><span class="header-section-number">3.1.8</span> Flatten</h3>
<p>As mentioned, the <code>repeat</code> function is used to repeat values in a vector, or other iterable. The simplest usage looks like this:</p>
<div id="112" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">repeat</span>([<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>], <span class="fl">2</span>) <span class="op">|&gt;</span> show</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1, 2, 3, 1, 2, 3]</code></pre>
</div>
</div>
<p>A common use of repetition is to take two variables, say <code>x</code> and <code>y</code>, perhaps of unequal length and create a data frame with two columns: one to store the values and one to indicate if a value came from <code>x</code> or <code>y</code>. This could be achieved like</p>
<div id="114" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>]</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> [<span class="fl">4</span>, <span class="fl">5</span>]</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="fu">DataFrame</span>(variable<span class="op">=</span><span class="fu">vcat</span>(<span class="fu">repeat</span>([<span class="op">:</span>x], <span class="fu">length</span>(x)), <span class="fu">repeat</span>([<span class="op">:</span>y], <span class="fu">length</span>(y))),</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>          values <span class="op">=</span> <span class="fu">vcat</span>(x,y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>5×2 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">values</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Symbol">Symbol</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">x</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">x</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">x</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">y</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">y</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The <code>flatten</code> function offers an alternative. Consider the data frame:</p>
<div id="116" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>]</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> [<span class="fl">4</span>, <span class="fl">5</span>]</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>dxy <span class="op">=</span> <span class="fu">DataFrame</span>(variable<span class="op">=</span>[<span class="op">:</span>x,<span class="op">:</span>y], value<span class="op">=</span>[x, y])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×2 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">value</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Symbol">Symbol</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Vector{Int64}">Array…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">x</td>
<td style="text-align: left;">[1, 2, 3]</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">y</td>
<td style="text-align: left;">[4, 5]</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The <code>flatten</code> function will iterate over the indicated columns and repeat the other variables:</p>
<div id="118" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">flatten</span>(dxy, <span class="op">:</span>value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>5×2 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">value</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Symbol">Symbol</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">x</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">x</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">x</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">y</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">y</td>
<td style="text-align: right;">5</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="splitapplycombine" class="level3" data-number="3.1.9">
<h3 data-number="3.1.9" class="anchored" data-anchor-id="splitapplycombine"><span class="header-section-number">3.1.9</span> SplitApplyCombine</h3>
<p>The split-apply-combine strategy for wrangling data frames was popularized in the influential paper “<em>The Split-Apply-Combine Strategy for Data Analysis</em>: <span class="citation" data-cites="JSSv040i01">(<a href="../references.html#ref-JSSv040i01" role="doc-biblioref">Wickham 2011</a>)</span> by H. Wickham which introduces this description:”where you break up a big problem into manageable pieces, operate on each piece independently and then put all the pieces back together.”</p>
<section id="grouping-data" class="level4">
<h4 class="anchored" data-anchor-id="grouping-data">Grouping data</h4>
<p>The <code>groupby</code> function for data frames does the breaking up, the <code>DataFrames</code> mini language can operate on each piece, and the <code>combine</code> function can put things together again.</p>
<p>Grouping takes one or more <em>categorical variables</em> and creates a “grouped” data frame for each different set of <em>combined</em> levels. That is one grouped data frame for each possible combination of the levels. The <code>groupby</code> function splits the data frame into pieces of type <code>GroupedDataFrame</code>. The basic signature is <code>groupby(df, cols; sort=nothing, skipmissing=false)</code>. The <code>cols</code> are one or more column selectors. The value of <code>sort</code> defaults to <code>nothing</code> leaving the order of the groups in the result undefined, but the grouping uses the fastest identified algorithm. The <code>skipmissing</code> argument can instruct the skipping of rows which have missing values in the selected columns.</p>
<p>For example, grouping the baggage data by loading style, returns two sub data frames.</p>
<div id="120" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>gdf <span class="op">=</span> <span class="fu">groupby</span>(d, <span class="op">:</span>load)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<p><b>GroupedDataFrame with 2 groups based on key: load</b></p><div><div style="float: left;"><span>First Group (2 rows): load = CategoricalArrays.CategoricalValue{String, UInt32} "front panel"</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
</tbody>
</table>
</div><p>⋮</p><div><div style="float: left;"><span>Last Group (1 row): load = CategoricalArrays.CategoricalValue{String, UInt32} "clamshell"</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Genius</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">228.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">clamshell</td>
<td style="text-align: left;">2022-10-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Grouping by more than one variable is achieved by passing in a selector with multiple variables. The following also creates two sub data frames, but only because the unique combination of both load and date are the same as just load:</p>
<div id="122" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>gdf <span class="op">=</span> <span class="fu">groupby</span>(d, [<span class="op">:</span>load, <span class="op">:</span>d])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<p><b>GroupedDataFrame with 2 groups based on keys: load, d</b></p><div><div style="float: left;"><span>First Group (2 rows): load = CategoricalArrays.CategoricalValue{String, UInt32} "front panel", d = 2022-09-01</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
</tbody>
</table>
</div><p>⋮</p><div><div style="float: left;"><span>Last Group (1 row): load = CategoricalArrays.CategoricalValue{String, UInt32} "clamshell", d = 2022-10-01</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Genius</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">228.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">clamshell</td>
<td style="text-align: left;">2022-10-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Indices may be used to get each sub data frame. Moreover, the <code>keys</code> method returns keys, like indices, to efficiently look up the different sub data frames in <code>gdf</code>. The levels for the keys are found in the property <code>.load</code>, as with <code>keys(gdf)[1].load</code>. Grouped data frames may be iterated over; the <code>pairs</code> iterator iterates over both keys and values.</p>
<p>The <code>select</code> and <code>subset</code> functions work over <code>GroupedDataFrame</code> objects, here we see the returned values are combined:</p>
<div id="124" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(gdf, <span class="op">:</span>p <span class="op">=&gt;</span> <span class="fu">ByRow</span>(<span class="op">&lt;=</span>(<span class="fl">350</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Genius</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">228.99</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">clamshell</td>
<td style="text-align: left;">2022-10-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>(The command <code>[subset(g, :p =&gt; ByRow(&lt;=(350))) for g in gdf]</code> avoids the <code>combine</code> step.)</p>
</section>
<section id="group-and-combine" class="level4">
<h4 class="anchored" data-anchor-id="group-and-combine">Group and combine</h4>
<p>We can see that <code>combine</code> also works over <code>GroupedDataFrame</code> objects. This example shows how to find the mean city mileage of groups formed by the value of <code>:Origin</code> in the <code>cars</code> data set:</p>
<div id="126" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">combine</span>(<span class="fu">groupby</span>(cars, <span class="op">:</span>Origin), <span class="op">:</span>MPGCity <span class="op">=&gt;</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×2 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Origin</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGCity_mean</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">USA</td>
<td style="text-align: right;">20.9583</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: right;">23.8667</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Typically, the function applied to a column is a reduction, which results in <em>aggregated data</em>.</p>
<p>By default the keys used to group (<code>:Origin</code>) are kept by <code>combine</code>. The <code>keepkeys</code> argument for <code>combine</code> when applied to grouped data controls this feature.</p>
<p>More than one column can be used to group the data. This example first groups by the number of cylinders, then groups by origin. For each of the 9 resulting groups, the group mean for city mileage is taken:</p>
<div id="128" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">combine</span>(<span class="fu">groupby</span>(cars, [<span class="op">:</span>Cylinders, <span class="op">:</span>Origin]), <span class="op">:</span>MPGCity <span class="op">=&gt;</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>9×3 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Cylinders</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Origin</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGCity_mean</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: right;">39.3333</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">USA</td>
<td style="text-align: right;">24.4091</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: right;">25.2222</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: right;">18.5</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">USA</td>
<td style="text-align: right;">18.35</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: right;">18.5455</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">7</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">USA</td>
<td style="text-align: right;">17.0</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">8</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: right;">17.0</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9</td>
<td style="text-align: left;">rotary</td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: right;">17.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The <code>@chain</code> macro may make this more readable:</p>
<div id="130" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@chain</span> cars <span class="cf">begin</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">groupby</span>([<span class="op">:</span>Cylinders, <span class="op">:</span>Origin])</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">combine</span>(<span class="op">:</span>MPGCity <span class="op">=&gt;</span> mean)</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    describe</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×7 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">min</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">median</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">max</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">nmissing</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">eltype</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Symbol">Symbol</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Nothing, Float64}">Union…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Any">Any</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Nothing, Float64}">Union…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Any">Any</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="DataType">DataType</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Cylinders</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">3</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">rotary</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">CategoricalValue{String, UInt8}</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Origin</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">USA</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">non-USA</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">CategoricalValue{String, UInt8}</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">MPGCity_mean</td>
<td style="text-align: left;">21.7067</td>
<td style="text-align: left;">17.0</td>
<td style="text-align: left;">18.5</td>
<td style="text-align: left;">39.3333</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Float64</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="exm-legos-example" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.1 (Lego sets)</strong></span> For an example, we download a data set from the internet describing all the sets of Legos sold during some time period. This data set is part of the data sets provided by <code>openintro.org</code>, an organization trying to make interesting educational products that are free and transparent.</p>
<div id="132" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>csv_data <span class="op">=</span> <span class="fu">download</span>(<span class="st">"https://www.openintro.org/data/csv/lego_population.csv"</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>legos <span class="op">=</span> CSV.<span class="fu">read</span>(csv_data, DataFrame)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">first</span>(legos, <span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×14 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">item_number</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">set_name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">theme</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">pieces</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">amazon_price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ages</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">pages</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">minifigures</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">packaging</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">weight</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">unique_pieces</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">size</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String31">String31</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String31">String31</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String31">String31</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String15">String15</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String3">String3</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String31">String31</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String31">String31</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: right;">41916</td>
<td style="text-align: left;">Extra Dots - Series 2</td>
<td style="text-align: left;">DOTS</td>
<td style="text-align: left;">109</td>
<td style="text-align: left;">3.99</td>
<td style="text-align: left;">3.44</td>
<td style="text-align: right;">2020</td>
<td style="text-align: left;">Ages_6+</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Foil pack</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">Small</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: right;">41908</td>
<td style="text-align: left;">Extra Dots - Series 1</td>
<td style="text-align: left;">DOTS</td>
<td style="text-align: left;">109</td>
<td style="text-align: left;">3.99</td>
<td style="text-align: left;">3.99</td>
<td style="text-align: right;">2020</td>
<td style="text-align: left;">Ages_6+</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">Foil pack</td>
<td style="text-align: left;">NA</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">Small</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Let’s explore this data.</p>
<p>The size of the data set is printed, though suppressed above as only the first 2 rows are requested to be shown, or can be programmatically identified with <code>size(legos)</code>.</p>
<div id="134" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">size</span>(legos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(1304, 14)</code></pre>
</div>
</div>
<p>Each row is a product; there are a lot of different ones.</p>
<p>The types <em>identified</em> by <code>CSV.read</code> are not perfect. The data uses <code>NA</code> for not-available. We read again using the argument <code>missingstring="NA"</code>:</p>
<div id="136" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>legos <span class="op">=</span> CSV.<span class="fu">read</span>(csv_data, DataFrame; missingstring<span class="op">=</span><span class="st">"NA"</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">first</span>(legos, <span class="fl">2</span>)  <span class="co"># show first 2 rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×14 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">item_number</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">set_name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">theme</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">pieces</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">amazon_price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ages</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">pages</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">minifigures</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">packaging</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">weight</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">unique_pieces</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">size</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, InlineStrings.String31}">String31?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String15">String15</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, InlineStrings.String31}">String31?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, InlineStrings.String31}">String31?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, InlineStrings.String7}">String7?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: right;">41916</td>
<td style="text-align: left;">Extra Dots - Series 2</td>
<td style="text-align: left;">DOTS</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">3.99</td>
<td style="text-align: right;">3.44</td>
<td style="text-align: right;">2020</td>
<td style="text-align: left;">Ages_6+</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: left;">Foil pack</td>
<td style="text-align: left; font-style: italic;">missing</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Small</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: right;">41908</td>
<td style="text-align: left;">Extra Dots - Series 1</td>
<td style="text-align: left;">DOTS</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">3.99</td>
<td style="text-align: right;">3.99</td>
<td style="text-align: right;">2020</td>
<td style="text-align: left;">Ages_6+</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: left;">Foil pack</td>
<td style="text-align: left; font-style: italic;">missing</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Small</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The <code>:theme</code> and <code>:packaging</code> variables are categorical, so we make them so:</p>
<div id="138" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>legos.theme <span class="op">=</span> <span class="fu">categorical</span>(legos.theme)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>legos.packaging <span class="op">=</span> <span class="fu">categorical</span>(legos.packaging);</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">first</span>(legos, <span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×14 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">item_number</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">set_name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">theme</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">pieces</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">amazon_price</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ages</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">pages</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">minifigures</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">packaging</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">weight</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">unique_pieces</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">size</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, CategoricalArrays.CategoricalValue{InlineStrings.String31, UInt32}}">Cat…?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String15">String15</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, CategoricalArrays.CategoricalValue{InlineStrings.String31, UInt32}}">Cat…?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, InlineStrings.String31}">String31?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, InlineStrings.String7}">String7?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: right;">41916</td>
<td style="text-align: left;">Extra Dots - Series 2</td>
<td style="text-align: left;">DOTS</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">3.99</td>
<td style="text-align: right;">3.44</td>
<td style="text-align: right;">2020</td>
<td style="text-align: left;">Ages_6+</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: left;">Foil pack</td>
<td style="text-align: left; font-style: italic;">missing</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Small</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: right;">41908</td>
<td style="text-align: left;">Extra Dots - Series 1</td>
<td style="text-align: left;">DOTS</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">3.99</td>
<td style="text-align: right;">3.99</td>
<td style="text-align: right;">2020</td>
<td style="text-align: left;">Ages_6+</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: left;">Foil pack</td>
<td style="text-align: left; font-style: italic;">missing</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Small</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We see data on the number of pieces and the age range. Is there some relationship?</p>
<p>The <code>:age</code> variable should be an ordered factor, ordered by the youngest age intended for use. The <code>:ages</code> variable has a pattern <code>Ages_startXXX</code> where <code>XXX</code> may be <code>+</code> to indicate or up, or a dash to indicate a range. We use this to identify the youngest intended age.</p>
<div id="140" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># alternative to</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co"># `(m = match(r"Ages_(\d+)", x); m === nothing ? missing : parse(Int, m.captures[1]))`</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">pick_first_age</span>(x)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ismissing</span>(x) <span class="op">&amp;&amp;</span> <span class="cf">return</span> <span class="cn">missing</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>    nos <span class="op">=</span> <span class="fu">collect</span>(<span class="fu">string</span>(<span class="fl">0</span><span class="op">:</span><span class="fl">9</span><span class="op">...</span>))</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    out <span class="op">=</span> <span class="st">""</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> xi <span class="kw">in</span> x[<span class="fl">6</span><span class="op">:</span><span class="kw">end</span>] <span class="co"># drop Ages_</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>        !(xi <span class="kw">in</span> nos) <span class="op">&amp;&amp;</span> <span class="cf">break</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>        out <span class="op">=</span> out <span class="op">*</span> xi</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>    out <span class="op">==</span> <span class="st">""</span> <span class="op">&amp;&amp;</span> <span class="cf">return</span> <span class="cn">missing</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">parse</span>(<span class="dt">Int</span>, out)</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a><span class="fu">transform!</span>(legos, <span class="op">:</span>ages <span class="op">=&gt;</span> <span class="fu">ByRow</span>(pick_first_age) <span class="op">=&gt;</span> <span class="op">:</span>youngest_age)</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>legos.youngest_age <span class="op">=</span> <span class="fu">categorical</span>(legos.youngest_age, ordered<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a><span class="fu">first</span>(legos[<span class="op">:</span>,<span class="st">r"age"</span>], <span class="fl">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×3 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ages</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">pages</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">youngest_age</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String15">String15</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, CategoricalArrays.CategoricalValue{Int64, UInt32}}">Cat…?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Ages_6+</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: left;">6</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Ages_6+</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: left;">6</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>With that ordering, an expected pattern becomes clear—kits for older users have on average more pieces—though there are unexpected exceptions:</p>
<div id="142" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@chain</span> legos <span class="cf">begin</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">groupby</span>(<span class="op">:</span>youngest_age)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">combine</span>([<span class="op">:</span>pieces, <span class="op">:</span>unique_pieces] <span class="op">.=&gt;</span> mean<span class="op">∘</span>skipmissing</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>            <span class="op">.=&gt;</span> [<span class="op">:</span>avg_pieces, <span class="op">:</span>avg_unique_pieces])</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>16×3 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">youngest_age</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">avg_pieces</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">avg_unique_pieces</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, CategoricalArrays.CategoricalValue{Int64, UInt32}}">Cat…?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left; font-style: italic;">missing</td>
<td style="text-align: right;">127.592</td>
<td style="text-align: right;">40.5604</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">1</td>
<td style="text-align: right;">37.2083</td>
<td style="text-align: right;">26.2174</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">2</td>
<td style="text-align: right;">55.617</td>
<td style="text-align: right;">31.2979</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">140.0</td>
<td style="text-align: right;">41.0</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">4</td>
<td style="text-align: right;">194.74</td>
<td style="text-align: right;">87.2857</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">5</td>
<td style="text-align: right;">147.712</td>
<td style="text-align: right;">85.1557</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">7</td>
<td style="text-align: left;">6</td>
<td style="text-align: right;">191.079</td>
<td style="text-align: right;">87.1289</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">8</td>
<td style="text-align: left;">7</td>
<td style="text-align: right;">265.556</td>
<td style="text-align: right;">108.816</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9</td>
<td style="text-align: left;">8</td>
<td style="text-align: right;">491.193</td>
<td style="text-align: right;">173.801</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">10</td>
<td style="text-align: left;">9</td>
<td style="text-align: right;">859.182</td>
<td style="text-align: right;">252.773</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">11</td>
<td style="text-align: left;">10</td>
<td style="text-align: right;">417.52</td>
<td style="text-align: right;">109.768</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">12</td>
<td style="text-align: left;">11</td>
<td style="text-align: right;">2357.86</td>
<td style="text-align: right;">214.143</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">13</td>
<td style="text-align: left;">12</td>
<td style="text-align: right;">1307.29</td>
<td style="text-align: right;">256.4</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">14</td>
<td style="text-align: left;">14</td>
<td style="text-align: right;">1617.25</td>
<td style="text-align: right;">349.5</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">15</td>
<td style="text-align: left;">16</td>
<td style="text-align: right;">2454.79</td>
<td style="text-align: right;">409.107</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">16</td>
<td style="text-align: left;">18</td>
<td style="text-align: right;">2073.84</td>
<td style="text-align: right;">214.294</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>(We composed the two functions <code>skipmissing</code> with <code>mean</code> using the <code>\circ[tab]</code> operator and use <code>.=&gt;</code> in both places to avoid defining the transformation function twice.)</p>
<hr>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Lego Group
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://en.wikipedia.org/wiki/Lego">Lego</a>, was the largest toy company in the world by 2021. By 2015 it had produced over 600 billion parts.</p>
</div>
</div>
<p>Lego is a mature company with an origin dating to 1934. The number of products per year should be fairly stable, though it is easy enough to check. The data set has a <code>:year</code> variable, so we would only need to group the data by that, then count the number of cases per each group. The <code>nrow</code> function will count the cases. This function is special cased in the <code>DataFrames</code>’ mini language and can appear by itself:</p>
<div id="144" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">combine</span>(<span class="fu">groupby</span>(legos, <span class="op">:</span>year), nrow) <span class="co"># use `nrow =&gt; :n`, or some such, to label differently</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×2 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">nrow</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">442</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">423</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">439</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We can take other summaries by year, for example, here we find the average price by year and size:</p>
<div id="146" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@chain</span> legos <span class="cf">begin</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">groupby</span>([<span class="op">:</span>year, <span class="op">:</span>size])</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">combine</span>(nrow <span class="op">=&gt;</span> <span class="op">:</span>n,</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span>price <span class="op">=&gt;</span> mean<span class="op">∘</span>skipmissing <span class="op">=&gt;</span> <span class="op">:</span>avg_price</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>9×4 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">size</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">avg_price</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, InlineStrings.String7}">String7?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: right;">2018</td>
<td style="text-align: left;">Small</td>
<td style="text-align: right;">324</td>
<td style="text-align: right;">45.7792</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: right;">2018</td>
<td style="text-align: left;">Large</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">28.59</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: right;">2018</td>
<td style="text-align: left; font-style: italic;">missing</td>
<td style="text-align: right;">97</td>
<td style="text-align: right;">25.8135</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">Small</td>
<td style="text-align: right;">322</td>
<td style="text-align: right;">50.4663</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left;">Large</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">29.6329</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: right;">2019</td>
<td style="text-align: left; font-style: italic;">missing</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">13.8536</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">7</td>
<td style="text-align: right;">2020</td>
<td style="text-align: left;">Small</td>
<td style="text-align: right;">335</td>
<td style="text-align: right;">49.8104</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">8</td>
<td style="text-align: right;">2020</td>
<td style="text-align: left;">Large</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">33.5456</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9</td>
<td style="text-align: right;">2020</td>
<td style="text-align: left; font-style: italic;">missing</td>
<td style="text-align: right;">86</td>
<td style="text-align: right;">21.6959</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The youngest age range is a bit long. We wish to collapse it to the ranges 1-6, 7-12, and 12-18. The data has been stored as a categorical array. The <code>cut</code> function can group numeric data easily, but to group categorical data, the cut-ranges must be promoted to a <code>CategoricalValue</code>. We have the following, where <code>Ref</code> is used to stop the broadcasting for that value:</p>
<div id="148" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>vals <span class="op">=</span> <span class="fu">CategoricalValue</span>.([<span class="fl">1</span>, <span class="fl">6</span>, <span class="fl">12</span>, <span class="fl">18</span>], <span class="fu">Ref</span>(legos.youngest_age))</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">transform!</span>(legos,</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>           <span class="op">:</span>youngest_age <span class="op">=&gt;</span> (x <span class="fu">-&gt;cut</span>(x, vals; extend<span class="op">=</span><span class="cn">true</span>))</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>           <span class="op">=&gt;</span> <span class="op">:</span>youngest_age_range);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We now check if the number of pieces has dramatically changed over the year. We break up the data by the age range, as we expect variation in that value so it is best to dis-aggregate over that factor:</p>
<div id="150" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@chain</span> legos <span class="cf">begin</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">groupby</span>([<span class="op">:</span>youngest_age_range, <span class="op">:</span>year])</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">combine</span>(nrow <span class="op">=&gt;</span> <span class="op">:</span>n,</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>            <span class="op">:</span>pieces <span class="op">=&gt;</span> mean<span class="op">∘</span>skipmissing <span class="op">=&gt;</span> <span class="op">:</span>avg_pieces)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>12×4 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">youngest_age_range</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">n</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">avg_pieces</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, CategoricalArrays.CategoricalValue{String, UInt32}}">Cat…?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left; font-style: italic;">missing</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">165.379</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left; font-style: italic;">missing</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">95.7778</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left; font-style: italic;">missing</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">111.8</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">[1, 6)</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">98</td>
<td style="text-align: right;">131.561</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">[1, 6)</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">92</td>
<td style="text-align: right;">122.533</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">[1, 6)</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">92</td>
<td style="text-align: right;">153.413</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">7</td>
<td style="text-align: left;">[6, 12)</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">292</td>
<td style="text-align: right;">341.866</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">8</td>
<td style="text-align: left;">[6, 12)</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">275</td>
<td style="text-align: right;">389.945</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9</td>
<td style="text-align: left;">[6, 12)</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">276</td>
<td style="text-align: right;">365.887</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">10</td>
<td style="text-align: left;">[12, 18]</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">1956.21</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">11</td>
<td style="text-align: left;">[12, 18]</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">1938.95</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">12</td>
<td style="text-align: left;">[12, 18]</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">2111.3</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>No real pattern shows up.</p>
<p>There are many different themes. The command <code>unique(legos.theme)</code> shows 41. Which are the most popular? To see, the data is grouped by the theme, each group is counted, missing themes are dropped, then the data frame is sorted and the top 5 rows are shown:</p>
<div id="152" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@chain</span> legos <span class="cf">begin</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">groupby</span>(<span class="op">:</span>theme)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">combine</span>(nrow <span class="op">=&gt;</span> <span class="op">:</span>n)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    dropmissing</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sort</span>(<span class="op">:</span>n; rev<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">first</span>(<span class="fl">5</span>)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>5×2 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">theme</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">n</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{InlineStrings.String31, UInt32}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Star Wars™</td>
<td style="text-align: right;">119</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Friends</td>
<td style="text-align: right;">103</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">City</td>
<td style="text-align: right;">101</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">NINJAGO®</td>
<td style="text-align: right;">78</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">DUPLO®</td>
<td style="text-align: right;">53</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</section>
<section id="the-splitapplycombine-package" class="level4">
<h4 class="anchored" data-anchor-id="the-splitapplycombine-package">The SplitApplyCombine package</h4>
<p>There is support for the split-apply-combine paradigm outside of the <code>DataFrames</code> package in the package <code>SplitApplyCombine</code>. This package is much lighter weight than <code>DataFrames</code>. This support targets other representations of tabular data, such as a vector of named tuples:</p>
<div id="154" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">SplitApplyCombine</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>tbl <span class="op">=</span> [</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>(b <span class="op">=</span> <span class="st">"Goruck GR2"</span>, v <span class="op">=</span> <span class="fl">40</span>, p <span class="op">=</span> <span class="fl">395</span>, lap <span class="op">=</span> <span class="st">"Y"</span>, load <span class="op">=</span> <span class="st">"front panel"</span>, d <span class="op">=</span> <span class="fu">Date</span>(<span class="st">"2022-09-01"</span>)),</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>(b <span class="op">=</span> <span class="st">"Minaal 3.0"</span>, v <span class="op">=</span> <span class="fl">35</span>, p <span class="op">=</span> <span class="fl">349</span>, lap <span class="op">=</span> <span class="st">"Y"</span>, load <span class="op">=</span> <span class="st">"front panel"</span>, d <span class="op">=</span> <span class="fu">Date</span>(<span class="st">"2022-09-01"</span>)),</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>(b <span class="op">=</span> <span class="st">"Genius    "</span>,     v <span class="op">=</span> <span class="fl">25</span>, p <span class="op">=</span> <span class="fl">228</span>, lap <span class="op">=</span> <span class="st">"Y"</span>, load <span class="op">=</span> <span class="st">"clamshell"</span>,   d <span class="op">=</span> <span class="fu">Date</span>(<span class="st">"2022-10-01"</span>))</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>WARNING: using SplitApplyCombine.product in module Notebook conflicts with an existing identifier.
WARNING: using SplitApplyCombine.flatten in module Notebook conflicts with an existing identifier.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3-element Vector{@NamedTuple{b::String, v::Int64, p::Int64, lap::String, load::String, d::Date}}:
 (b = "Goruck GR2", v = 40, p = 395, lap = "Y", load = "front panel", d = Date("2022-09-01"))
 (b = "Minaal 3.0", v = 35, p = 349, lap = "Y", load = "front panel", d = Date("2022-09-01"))
 (b = "Genius    ", v = 25, p = 228, lap = "Y", load = "clamshell", d = Date("2022-10-01"))</code></pre>
</div>
</div>
<p>Many of the main verbs are generic functions: <code>filter</code>, <code>map</code>, <code>reduce</code>; <code>group</code> does grouping. There are some others. A few examples follow.</p>
<p>For indexing this structure, we can’t index by <code>[row, col]</code>, rather we can use <code>[row][col]</code> notation, the first to extract the row, the second to access the entries in the column. For example, here we index a selected column by position, by name, and then with multiple names:</p>
<div id="156" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>tbl[<span class="fl">2</span>][<span class="fl">2</span>], tbl[<span class="fl">2</span>].v, tbl[<span class="fl">2</span>][ [<span class="op">:</span>v, <span class="op">:</span>p] ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(35, 35, (v = 35, p = 349))</code></pre>
</div>
</div>
<p>The <code>invert</code> function from <code>SplitApplyCombine</code> reverses the access pattern, allowing, in this case, <code>[col][row]</code> access, with:</p>
<div id="158" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>itbl <span class="op">=</span> <span class="fu">invert</span>(tbl)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>itbl[<span class="fl">3</span>][<span class="fl">1</span>], itbl[<span class="op">:</span>p][<span class="fl">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(395, 349)</code></pre>
</div>
</div>
<p>In some ways, the <code>invert</code> function flips the viewpoint from an array of structs to a struct of arrays.</p>
<p>To filter out rows, we have the same calling style as with data frames: <code>filter(pred, tbl)</code>. With the outer container of <code>tbl</code> being an array, no special method is utilized, iteration is over each row. For example,</p>
<div id="160" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(r <span class="op">-&gt;</span> r.v <span class="op">&gt;=</span> <span class="fl">35</span>, tbl) <span class="op">|&gt;</span> DataFrame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>(The call to <code>DataFrame</code> is to take advantage of the prettier printing. <code>DataFrame</code> can consume a vector of named tuples for its input.)</p>
<p>The <code>DataPipes</code> package composes a bit more nicely with this approach, but we continue using <code>Chain</code> for examples<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, like this one of nested calls to <code>filter</code>:</p>
<div id="162" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@chain</span> tbl <span class="cf">begin</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(r <span class="op">-&gt;</span> r.v <span class="op">&gt;=</span> <span class="fl">35</span>,  _)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(r <span class="op">-&gt;</span> r.p <span class="op">&gt;=</span> <span class="fl">350</span>, _)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    DataFrame</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>1×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">lap</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">load</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Dates.Date">Date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395</td>
<td style="text-align: left;">Y</td>
<td style="text-align: left;">front panel</td>
<td style="text-align: left;">2022-09-01</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Selecting columns and adding a transformation can be achieved through <code>map</code>, which iterates over each named tuple in this example:</p>
<div id="164" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(r <span class="op">-&gt;</span> (b<span class="op">=</span>r.b, v<span class="op">=</span>r.v, p<span class="op">=</span>r.p, pv <span class="op">=</span> <span class="fu">round</span>(r.p<span class="op">/</span>r.v; digits<span class="op">=</span><span class="fl">2</span>)), tbl) <span class="op">|&gt;</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>    DataFrame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×4 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">b</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">v</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">p</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">pv</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Goruck GR2</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">395</td>
<td style="text-align: right;">9.88</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Minaal 3.0</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">349</td>
<td style="text-align: right;">9.97</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Genius</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">228</td>
<td style="text-align: right;">9.12</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The <code>group</code> function can group <em>by</em> values of a function call. This example from the package’s Readme is instructive:</p>
<div id="166" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>nms <span class="op">=</span> [<span class="st">"Andrew Smith"</span>, <span class="st">"John Smith"</span>, <span class="st">"Alice Baker"</span>,</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">"Robert Baker"</span>, <span class="st">"Jane Smith"</span>, <span class="st">"Jason Bourne"</span>]</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="fu">group</span>(last, <span class="fu">split</span>.(nms))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3-element Dictionaries.Dictionary{SubString{String}, Vector{Vector{SubString{String}}}}:
  "Smith" │ Vector{SubString{String}}[["Andrew", "Smith"], ["John", "Smith"], […
  "Baker" │ Vector{SubString{String}}[["Alice", "Baker"], ["Robert", "Baker"]]
 "Bourne" │ Vector{SubString{String}}[["Jason", "Bourne"]]</code></pre>
</div>
</div>
<p>The names are split on spaces, and the keys of the group are determined by the <code>last</code> function, which here gets the last piece after splitting (aka the “last” name, but by coincidence, not intelligence).</p>
<p>For numeric operations, this is quite convenient. Here we <code>group</code> by the remainder upon division by <code>3</code>:</p>
<div id="168" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">group</span>(x <span class="op">-&gt;</span> <span class="fu">rem</span>(x,<span class="fl">3</span>), <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3-element Dictionaries.Dictionary{Int64, Vector{Int64}}:
 1 │ [1, 4, 7, 10]
 2 │ [2, 5, 8]
 0 │ [3, 6, 9]</code></pre>
</div>
</div>
<p>The grouping basically creates a dictionary and adds to the key determined by the function.</p>
<p>To apply a function to the values of a base <code>Julia</code> dictionary is not directly supported by <code>map</code>, however the dictionary used by <code>group</code> (from the <code>Dictionaries</code> packages) does allow this, so we could, for example, add up the values in each group with:</p>
<div id="170" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(sum, <span class="fu">group</span>(x <span class="op">-&gt;</span> <span class="fu">rem</span>(x,<span class="fl">3</span>), <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3-element Dictionaries.Dictionary{Int64, Int64}:
 1 │ 22
 2 │ 15
 0 │ 18</code></pre>
</div>
</div>
<p>The <code>group</code> function can do this in one call, by placing the function to apply in between the <code>by</code> function and the table. Here we apply <code>first</code> to pick off the first name. That is, <code>["Andrew", "Smith"]</code> becomes just <code>"Andrew"</code>, the first element of that vector.</p>
<div id="172" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>gps <span class="op">=</span> <span class="fu">group</span>(last, first, <span class="fu">split</span>.(nms))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>3-element Dictionaries.Dictionary{SubString{String}, Vector{SubString{String}}}:
  "Smith" │ SubString{String}["Andrew", "John", "Jane"]
  "Baker" │ SubString{String}["Alice", "Robert"]
 "Bourne" │ SubString{String}["Jason"]</code></pre>
</div>
</div>
<div id="exm-prison-count" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.2 (A tally function)</strong></span> The <code>Tally</code> package provides a quick way to tally up numbers. Here we do a simplified version.</p>
<p>To tally, we have three steps: group by each by value, count the number in each groups, sort the values. This is implemented with this composition of functions:</p>
<div id="174" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tally</span>(v; by<span class="op">=</span>identity) <span class="op">=</span> SplitApplyCombine.<span class="fu">sortkeys</span>(<span class="fu">map</span>(length, <span class="fu">group</span>(by, v)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>tally (generic function with 1 method)</code></pre>
</div>
</div>
<p>To see, we have:</p>
<div id="176" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> <span class="fu">rand</span>(<span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">50</span>)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> <span class="fu">tally</span>(v)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>5-element Dictionaries.Dictionary{Int64, Int64}:
 1 │ 11
 2 │ 7
 3 │ 15
 4 │ 9
 5 │ 8</code></pre>
</div>
</div>
<p>Using <code>map</code>, we can provide an alternate, oft used view for tallying:</p>
<div id="178" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>tallies <span class="op">=</span> <span class="st">"\u007C"</span><span class="op">^</span><span class="fl">4</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>ftally <span class="op">=</span> <span class="st">"┼┼┼┼ "</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">prison_count</span>(x)</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>    d, r <span class="op">=</span> <span class="fu">divrem</span>(x, <span class="fl">5</span>)</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>    ftally<span class="op">^</span>d <span class="op">*</span> tallies[<span class="fl">1</span><span class="op">:</span>r]</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(prison_count, d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>5-element Dictionaries.Dictionary{Int64, Any}:
 1 │ "┼┼┼┼ ┼┼┼┼ |"
 2 │ "┼┼┼┼ ||"
 3 │ "┼┼┼┼ ┼┼┼┼ ┼┼┼┼ "
 4 │ "┼┼┼┼ ||||"
 5 │ "┼┼┼┼ |||"</code></pre>
</div>
</div>
</div>
<div id="exm-stem-leaf" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.3 (A simple stem and leaf diagram)</strong></span> The grouping and sorting made quite accessible by <code>SplitApplyCombine</code> could also be used to produce a simple stem-and-leaf type diagram. Here we don’t bother displaying stems with no associated leaves, which does change the interpretation of spread in the data, and could easily be added in, though it takes us a bit afield, as it requires some manipulation of the display:</p>
<div id="180" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fu">rand</span>(<span class="fl">0</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">32</span>)  <span class="co"># 32 test scores</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>stem_unit <span class="op">=</span> <span class="fl">10</span>       <span class="co"># stem * 10 is value of stem</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="pp">@chain</span> x <span class="cf">begin</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>.(<span class="dt">Int</span>, <span class="fl">10</span><span class="op">*</span>_<span class="op">/</span>stem_unit)</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>    SplitApplyCombine.<span class="fu">group</span>(x <span class="op">-&gt;</span> x <span class="op">÷</span> <span class="fl">10</span>, <span class="fu">x-&gt;rem</span>(x,<span class="fl">10</span>), _)</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>    SplitApplyCombine.<span class="fu">sortkeys</span>(_)</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(sort, _)</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">map</span>(x <span class="op">-&gt;</span> <span class="fu">parse</span>(<span class="dt">Int</span>,<span class="fu">join</span>(x)), _)</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>9-element Dictionaries.Dictionary{Int64, Int64}:
 0 │ 149
 1 │ 236
 2 │ 3389
 3 │ 22
 4 │ 28
 6 │ 4
 7 │ 57
 8 │ 67
 9 │ 22259</code></pre>
</div>
</div>
</div>
<hr>
<p>Let’s return to the <code>cars</code> data and use <code>group</code> to identify the average mileage per type. For this task, we group by <code>:Type</code>and then apply a function to extract the mileage from a row. The <code>copy.(eachrow(cars))</code> command creates a vector of named tuples.</p>
<div id="182" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>cs <span class="op">=</span> <span class="fu">copy</span>.(<span class="fu">eachrow</span>(cars))  <span class="co"># Can also call `NamedTuple` for `copy`</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>gps <span class="op">=</span> <span class="fu">group</span>(r <span class="op">-&gt;</span> r.<span class="dt">Type</span>, r <span class="op">-&gt;</span> r.MPGCity, cs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>6-element Dictionaries.Dictionary{CategoricalValue{String, UInt8}, Vector{Int32}}:
 CategoricalValue{String, UInt8} "Smal… │ Int32[25, 29, 23, 29, 31, 23, 46, 42,…
 CategoricalValue{String, UInt8} "Mids… │ Int32[18, 19, 22, 22, 19, 16, 21, 21,…
 CategoricalValue{String, UInt8} "Comp… │ Int32[20, 25, 25, 23, 22, 22, 24, 26,…
 CategoricalValue{String, UInt8} "Larg… │ Int32[19, 16, 16, 17, 20, 20, 20, 18,…
 CategoricalValue{String, UInt8} "Spor… │ Int32[19, 17, 18, 22, 24, 30, 24, 26,…
  CategoricalValue{String, UInt8} "Van" │ Int32[18, 15, 17, 15, 18, 17, 18, 18,…</code></pre>
</div>
</div>
<p>We now can map <code>mean</code> over each group:</p>
<div id="184" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>ms <span class="op">=</span> <span class="fu">map</span>(mean, gps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>6-element Dictionaries.Dictionary{CategoricalValue{String, UInt8}, Float64}:
   CategoricalValue{String, UInt8} "Small" │ 29.857142857142858
 CategoricalValue{String, UInt8} "Midsize" │ 19.545454545454547
 CategoricalValue{String, UInt8} "Compact" │ 22.6875
   CategoricalValue{String, UInt8} "Large" │ 18.363636363636363
  CategoricalValue{String, UInt8} "Sporty" │ 21.785714285714285
     CategoricalValue{String, UInt8} "Van" │ 17.0</code></pre>
</div>
</div>
<p>This requires two passes through the grouped data, the first to get just the mileage values, the next to call <code>mean</code>. The following <code>DataFrames</code> syntax hides this:</p>
<div id="186" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">combine</span>(<span class="fu">groupby</span>(cars, <span class="op">:</span><span class="dt">Type</span>), <span class="op">:</span>MPGHighway <span class="op">=&gt;</span> mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>6×2 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPGHighway_mean</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Compact</td>
<td style="text-align: right;">29.875</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Large</td>
<td style="text-align: right;">26.7273</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Midsize</td>
<td style="text-align: right;">26.7273</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Small</td>
<td style="text-align: right;">35.4762</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">Sporty</td>
<td style="text-align: right;">28.7857</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">Van</td>
<td style="text-align: right;">21.8889</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Reductions, like sum and count which can be written easily using the higher-order function <code>reduce</code>, have support to combine the grouping and reduction. The <code>groupreduce</code> function takes the additional arguments of <code>reduce</code> (an <em>op</em>eration and an optional <code>init</code> value). For example, to get the group sum, we could call:</p>
<div id="188" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">groupreduce</span>(r <span class="op">-&gt;</span> r.<span class="dt">Type</span>, r <span class="op">-&gt;</span> r.MPGCity, <span class="op">+</span>, cs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>6-element Dictionaries.Dictionary{CategoricalValue{String, UInt8}, Int32}:
   CategoricalValue{String, UInt8} "Small" │ 627
 CategoricalValue{String, UInt8} "Midsize" │ 430
 CategoricalValue{String, UInt8} "Compact" │ 363
   CategoricalValue{String, UInt8} "Large" │ 202
  CategoricalValue{String, UInt8} "Sporty" │ 305
     CategoricalValue{String, UInt8} "Van" │ 153</code></pre>
</div>
</div>
<p>The group sum and group count have shortcuts, so the mean could have been computed as:</p>
<div id="190" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">groupsum</span>(r <span class="op">-&gt;</span> r.<span class="dt">Type</span>, r <span class="op">-&gt;</span> r.MPGCity, cs) <span class="op">./</span> <span class="fu">groupcount</span>(r <span class="op">-&gt;</span> r.<span class="dt">Type</span>, cs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>6-element Dictionaries.Dictionary{CategoricalValue{String, UInt8}, Float64}:
   CategoricalValue{String, UInt8} "Small" │ 29.857142857142858
 CategoricalValue{String, UInt8} "Midsize" │ 19.545454545454547
 CategoricalValue{String, UInt8} "Compact" │ 22.6875
   CategoricalValue{String, UInt8} "Large" │ 18.363636363636363
  CategoricalValue{String, UInt8} "Sporty" │ 21.785714285714285
     CategoricalValue{String, UInt8} "Van" │ 17.0</code></pre>
</div>
</div>
<p>(Unlike for a <code>Dict</code> instance, the dictionaries above allow such division.)</p>
<hr>
<p>The “combine” part of the paradigm takes the pieces and reassembles. The data frames example returns a data frame, whereas with <code>SplitApplyCombine.jl</code> we have a dictionary. A dictionary does not map directly to a data frame. While both dictionaries and named tuples are associative arrays, we wouldn’t necessarily want to map our data to a row. Rather, here we use the <code>pairs</code> iterator to iterate over the keys and values to produce an array of named tuples:</p>
<div id="192" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>[ (; <span class="dt">Type</span>, MPG) for (<span class="dt">Type</span>,MPG) <span class="kw">in</span> <span class="fu">pairs</span>(ms)] <span class="op">|&gt;</span> DataFrame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>6×2 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">MPG</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Small</td>
<td style="text-align: right;">29.8571</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Midsize</td>
<td style="text-align: right;">19.5455</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Compact</td>
<td style="text-align: right;">22.6875</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Large</td>
<td style="text-align: right;">18.3636</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">Sporty</td>
<td style="text-align: right;">21.7857</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">Van</td>
<td style="text-align: right;">17.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="aggregating-data" class="level3" data-number="3.1.10">
<h3 data-number="3.1.10" class="anchored" data-anchor-id="aggregating-data"><span class="header-section-number">3.1.10</span> Aggregating data</h3>
<p>Somewhat inverse to flattening data is to aggregate data, by which we mean combining multiple columns into a single one, or combining multiple rows into a single one. The <code>select</code> and <code>combine</code> methods can do these tasks.</p>
<p>Consider the three price variables in the <code>cars</code> data. We can find an average of the three price numbers easily enough. This function allows the specification as different arguments, not in a container:</p>
<div id="194" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">_mean</span>(xs<span class="op">...</span>) <span class="op">=</span> <span class="fu">mean</span>(xs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>_mean (generic function with 1 method)</code></pre>
</div>
</div>
<p>We can then use <code>select</code> to aggregate the three price variables. In the following, these are selected with a regular expression:</p>
<div id="196" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>cars_price <span class="op">=</span> <span class="fu">select</span>(cars, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="st">r"Price"</span> <span class="op">=&gt;</span> <span class="fu">ByRow</span>(_mean) <span class="op">=&gt;</span> <span class="op">:</span>price)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">first</span>(cars_price, <span class="fl">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×4 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Manufacturer</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">price</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Acura</td>
<td style="text-align: left;">Integra</td>
<td style="text-align: left;">Small</td>
<td style="text-align: right;">15.8667</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Acura</td>
<td style="text-align: left;">Legend</td>
<td style="text-align: left;">Midsize</td>
<td style="text-align: right;">33.9333</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Audi</td>
<td style="text-align: left;">90</td>
<td style="text-align: left;">Compact</td>
<td style="text-align: right;">29.1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>To aggregate over columns, the <code>groupby</code> construct can be used to specify the groupings to aggregate over. In the following this is the car type. The <code>Chain</code> style is used to make the steps more explicit:</p>
<div id="198" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@chain</span> cars_price <span class="cf">begin</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">groupby</span>(<span class="op">:</span><span class="dt">Type</span>)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">combine</span>(<span class="op">:</span>price <span class="op">=&gt;</span> mean <span class="op">=&gt;</span> <span class="op">:</span>avg_price)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>6×2 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">avg_price</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Compact</td>
<td style="text-align: right;">18.2104</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Large</td>
<td style="text-align: right;">24.303</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Midsize</td>
<td style="text-align: right;">27.2152</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Small</td>
<td style="text-align: right;">10.1667</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">Sporty</td>
<td style="text-align: right;">19.4024</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">Van</td>
<td style="text-align: right;">19.1111</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>As <code>mean</code> is a reduction, the result has one row for each unique set of levels in the column selector specified to <code>groupby</code>. Again, that these columns appear in the output is due to the chosen default value of<code>keepkeys</code>.</p>
<p>This similar example shows grouping by two variables and then aggregating miles per gallon over each:</p>
<div id="200" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@chain</span> cars <span class="cf">begin</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">groupby</span>([<span class="op">:</span><span class="dt">Type</span>, <span class="op">:</span>DriveTrain])</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">combine</span>(<span class="op">:</span>MPGHighway <span class="op">=&gt;</span> mean <span class="op">=&gt;</span> <span class="op">:</span>avg_MPG)</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">sort</span>(<span class="op">:</span>avg_MPG, rev<span class="op">=</span><span class="cn">true</span>)</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>14×3 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Type</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">DriveTrain</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">avg_MPG</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="CategoricalArrays.CategoricalValue{String, UInt8}">Cat…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Float64">Float64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Small</td>
<td style="text-align: left;">Front</td>
<td style="text-align: right;">35.6842</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Small</td>
<td style="text-align: left;">4WD</td>
<td style="text-align: right;">33.5</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Sporty</td>
<td style="text-align: left;">Front</td>
<td style="text-align: right;">30.5714</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Compact</td>
<td style="text-align: left;">Front</td>
<td style="text-align: right;">30.0769</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">Compact</td>
<td style="text-align: left;">4WD</td>
<td style="text-align: right;">30.0</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">Compact</td>
<td style="text-align: left;">Rear</td>
<td style="text-align: right;">28.5</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">7</td>
<td style="text-align: left;">Large</td>
<td style="text-align: left;">Front</td>
<td style="text-align: right;">27.2857</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">8</td>
<td style="text-align: left;">Midsize</td>
<td style="text-align: left;">Front</td>
<td style="text-align: right;">27.1765</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">9</td>
<td style="text-align: left;">Sporty</td>
<td style="text-align: left;">4WD</td>
<td style="text-align: right;">27.0</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">10</td>
<td style="text-align: left;">Sporty</td>
<td style="text-align: left;">Rear</td>
<td style="text-align: right;">27.0</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">11</td>
<td style="text-align: left;">Large</td>
<td style="text-align: left;">Rear</td>
<td style="text-align: right;">25.75</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">12</td>
<td style="text-align: left;">Midsize</td>
<td style="text-align: left;">Rear</td>
<td style="text-align: right;">25.2</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">13</td>
<td style="text-align: left;">Van</td>
<td style="text-align: left;">Front</td>
<td style="text-align: right;">22.5</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">14</td>
<td style="text-align: left;">Van</td>
<td style="text-align: left;">4WD</td>
<td style="text-align: right;">21.4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="tidy-data-stack-unstack" class="level3" data-number="3.1.11">
<h3 data-number="3.1.11" class="anchored" data-anchor-id="tidy-data-stack-unstack"><span class="header-section-number">3.1.11</span> Tidy data; stack, unstack</h3>
<p>The split-apply-combine paradigm suggest that storing data so that it can be split readily is preferable to other ways of storage. The notion of “tidy data,” <span class="citation" data-cites="tidy-data">(<a href="../references.html#ref-tidy-data" role="doc-biblioref">Wickham 2014</a>)</span> as presented in R’s <code>tidyr</code> package and described in this <a href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html">vignette</a> suggests data sets should follow:</p>
<ul>
<li>Every column is a <em>variable</em>.</li>
<li>Every row is an <em>observation</em>.</li>
<li>Every cell is a single <em>value</em>.</li>
</ul>
<p>These terms are defined by</p>
<blockquote class="blockquote">
<p>A dataset is a collection of values, usually either numbers (if quantitative) or strings (if qualitative). Values are organised in two ways. Every value belongs to a variable and an observation. A variable contains all values that measure the same underlying attribute (like height, temperature, duration) across units. An observation contains all values measured on the same unit (like a person, or a day, or a race) across attributes.</p>
</blockquote>
<p>In addition to <code>flatten</code>, the <code>DataFrames</code> package provides the functions <code>stack</code> and <code>unstack</code> for tidying data.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stack and unstack
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>stack</code> and <code>unstack</code> commands are used to move from “wide” format, where related values are stored in multiple columns with column names representing some level, to “long” format, where related values are stored in one column, and their categorical levels in another column.</p>
<p>For example, this wide format as the attributes are in columns <code>:A</code> and <code>:B</code>; the values in columns <code>:C</code> and <code>:D</code>.</p>
<div id="202" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>wide <span class="op">=</span> <span class="fu">DataFrame</span>(A<span class="op">=</span>[<span class="st">"A"</span>,<span class="st">"B"</span>], B<span class="op">=</span>[<span class="st">"a"</span>,<span class="st">"b"</span>], C<span class="op">=</span>[<span class="st">"c1"</span>,<span class="st">"c2"</span>], D<span class="op">=</span>[<span class="st">"d1"</span>,<span class="st">"d2"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×4 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">A</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">B</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">C</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">D</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">a</td>
<td style="text-align: left;">c1</td>
<td style="text-align: left;">d1</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">c2</td>
<td style="text-align: left;">d2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>With the <code>stack</code> function, the values are placed into a single column (by default <code>:value</code>) and the variable names placed into a single column (by default <code>:variable</code>):</p>
<div id="204" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>long <span class="op">=</span> <span class="fu">stack</span>(wide, [<span class="op">:</span>C, <span class="op">:</span>D])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>4×4 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">A</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">B</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">value</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">a</td>
<td style="text-align: left;">C</td>
<td style="text-align: left;">c1</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">C</td>
<td style="text-align: left;">c2</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">a</td>
<td style="text-align: left;">D</td>
<td style="text-align: left;">d1</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">D</td>
<td style="text-align: left;">d2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The values in the <code>:variable</code> column come from the data frame names.</p>
<p>With <code>unstack</code> the data can be spread back out into “wide” format. We pass in the two columns indicating the variable and the values to <code>unstack</code>:</p>
<div id="206" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unstack</span>(long, <span class="op">:</span>variable, <span class="op">:</span>value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×4 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">A</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">B</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">C</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">D</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, String}">String?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, String}">String?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">a</td>
<td style="text-align: left;">c1</td>
<td style="text-align: left;">d1</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">b</td>
<td style="text-align: left;">c2</td>
<td style="text-align: left;">d2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>We illustrate this further with an abbreviated version of an example in the <code>tidyr</code> vignette.</p>
<p>Consider this data from the Global Historical Climatology Network for one weather station (MX17004) in Mexico for five months in 2010. The full data has 31 days per month, this abbreviated data works with just the first 8:</p>
<div id="208" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>weather <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="st">"id","year","month","element","d1","d2","d3","d4","d5","d6","d7","d8"</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="st">"MX17004","2010","1","tmax","---","---","---","---","---","---","---","---"</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="st">"MX17004","2010","1","tmin","---","---","---","---","---","---","---","---"</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="st">"MX17004","2010","2","tmax","---","27.3","24.1","---","---","---","---","---"</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="st">"MX17004","2010","2","tmin","---","14.4","14.4","---","---","---","---","---"</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a><span class="st">"MX17004","2010","3","tmax","---","---","---","---","32.1","---","---","---"</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a><span class="st">"MX17004","2010","3","tmin","---","---","---","---","14.2","---","---","---"</span></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a><span class="st">"MX17004","2010","4","tmax","---","---","---","---","---","---","---","---"</span></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a><span class="st">"MX17004","2010","4","tmin","---","---","---","---","---","---","---","---"</span></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a><span class="st">"MX17004","2010","5","tmax","---","---","---","---","---","---","---","---"</span></span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a><span class="st">"MX17004","2010","5","tmin","---","---","---","---","---","---","---","---"</span></span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> CSV.<span class="fu">read</span>(<span class="fu">IOBuffer</span>(weather), DataFrame; missingstring<span class="op">=</span><span class="st">"---"</span>)</span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a><span class="fu">first</span>(w, <span class="fl">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>4×12 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">month</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">element</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d1</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d3</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d4</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d5</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d6</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">d8</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Missing">Missing</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Missing">Missing</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Missing">Missing</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Missing">Missing</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Missing">Missing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">tmax</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">tmin</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">tmax</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right;">27.3</td>
<td style="text-align: right;">24.1</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">tmin</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right;">14.4</td>
<td style="text-align: right;">14.4</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>This example is said to have variables stored in both rows and columns. The first step to tidying the data is to stack days 1 through 8 into a column. We use the <code>Between</code> column selector to select the columns for <code>d1</code> though <code>d8</code> (an alternative to, say, <code>r"^d"</code>):</p>
<div id="210" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>w1 <span class="op">=</span> <span class="pp">@chain</span> w <span class="cf">begin</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stack</span>(<span class="fu">Between</span>(<span class="op">:</span>d1, <span class="op">:</span>d8); variable_name <span class="op">=</span> <span class="op">:</span>day)</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="op">:</span>value <span class="op">=&gt;</span> !ismissing, _)</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="cf">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>6×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">month</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">element</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">day</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">value</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="String">String</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">tmax</td>
<td style="text-align: left;">d2</td>
<td style="text-align: right;">27.3</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">tmin</td>
<td style="text-align: left;">d2</td>
<td style="text-align: right;">14.4</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">tmax</td>
<td style="text-align: left;">d3</td>
<td style="text-align: right;">24.1</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">tmin</td>
<td style="text-align: left;">d3</td>
<td style="text-align: right;">14.4</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">tmax</td>
<td style="text-align: left;">d5</td>
<td style="text-align: right;">32.1</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">tmin</td>
<td style="text-align: left;">d5</td>
<td style="text-align: right;">14.2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>As in the example being followed, missing values are skipped, requiring the reader to imply the lack of measurement on a given day.</p>
<p>The day is coded with a leading “d” and as a string, not an integer. We can strip this prefix out using a regular expression or, as here, string indexing then parse the result to an integer:</p>
<div id="212" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">transform!</span>(w1, <span class="op">:</span>day <span class="op">=&gt;</span> <span class="fu">ByRow</span>(x <span class="op">-&gt;</span> <span class="fu">parse</span>(<span class="dt">Int</span>, x[<span class="fl">2</span><span class="op">:</span><span class="kw">end</span>])) <span class="op">=&gt;</span> <span class="op">:</span>day)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>6×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">month</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">element</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">day</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">value</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">tmax</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">27.3</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">tmin</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">14.4</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">tmax</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">24.1</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">tmin</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">14.4</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">tmax</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">32.1</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">6</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">tmin</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">14.2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Finally, the <code>element</code> column does not hold a variable, rather it stores the names of two variables (<code>tmin</code> and <code>tmax</code>). For this the data is “unstacked” splitting the longer variable <code>value</code> in two:</p>
<div id="214" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>w2 <span class="op">=</span> <span class="fu">unstack</span>(w1, <span class="op">:</span>element, <span class="op">:</span>value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×6 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">year</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">month</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">day</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">tmax</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">tmin</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Float64}">Float64?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">27.3</td>
<td style="text-align: right;">14.4</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">24.1</td>
<td style="text-align: right;">14.4</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">MX17004</td>
<td style="text-align: right;">2010</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">32.1</td>
<td style="text-align: right;">14.2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>As described in the vignette, now each variable is in one column, and each row describes one day.</p>
<section id="joins" class="level3" data-number="3.1.12">
<h3 data-number="3.1.12" class="anchored" data-anchor-id="joins"><span class="header-section-number">3.1.12</span> Joins</h3>
<p>Consider the three following assessments of some class. The students have somewhat spotty attendance:</p>
<div id="216" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="st">first,last,points</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="st">Alice, Smith, 100</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a><span class="st">Bob, Jones, 200</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>t2 <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a><span class="st">first,last,score</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a><span class="st">Carol, Gates, 125</span></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a><span class="st">Chad, Gad, 200</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a><span class="st">Bob, Jones, 225</span></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>t3 <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a><span class="st">first,last,points</span></span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a><span class="st">Bob, Jones, 300</span></span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a><span class="st">Carol, Gates, 150</span></span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a><span class="st">Erin, Dan, 100</span></span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb141-20"><a href="#cb141-20" aria-hidden="true" tabindex="-1"></a>a1, a2, a3 <span class="op">=</span> [CSV.<span class="fu">read</span>(<span class="fu">IOBuffer</span>(txt), DataFrame) for txt <span class="op">∈</span> (t1, t2, t3)];</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We have several ways to combine these three data frames.</p>
<p>We can concatenate them using <code>vcat</code>. Before doing so, we need to align the column names, as the second data set used a different name:</p>
<div id="218" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select!</span>(a2, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="op">:</span>score <span class="op">=&gt;</span> <span class="op">:</span>points);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>vcat</code> method for data frames takes a named argument <code>source</code> allowing a variable to be appended indicating the source of the data frame. The following will indicate with a <code>1</code>, <code>2</code>, or <code>3</code> what data frame contributed what row:</p>
<div id="220" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>aₛ <span class="op">=</span> <span class="fu">vcat</span>(a1, a2, a3; source<span class="op">=:</span>assignment)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(aₛ)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>4×7 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">mean</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">min</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">median</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">max</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">nmissing</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">eltype</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Symbol">Symbol</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Nothing, Float64}">Union…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Any">Any</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Nothing, Float64}">Union…</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Any">Any</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="DataType">DataType</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">first</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">Alice</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">Erin</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">String7</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">last</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">Dan</td>
<td style="text-align: left; font-style: italic;"></td>
<td style="text-align: left;">Smith</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">String7</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">points</td>
<td style="text-align: left;">175.0</td>
<td style="text-align: left;">100</td>
<td style="text-align: left;">175.0</td>
<td style="text-align: left;">300</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Int64</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">assignment</td>
<td style="text-align: left;">2.125</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">2.0</td>
<td style="text-align: left;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">Int64</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Similarly, <code>append!</code> could be used in combination with <code>reduce</code> (as in <code>reduce(append!, (a1, a2, a3))</code>).</p>
<p>A more common alternative to the above is to <em>join</em> the data frames using one of several join commands. Joins allow multiple tables to be merged, or mashed. into one. We briefly illustrate the implementations in <code>DataFrames</code> of outer, left, right, inner, semi, and anti joins, leaving the cross join and further details to the documentation.</p>
<p>We return to the original data, with the differently named columns:</p>
<div id="222" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>a1, a2, a3 <span class="op">=</span> [CSV.<span class="fu">read</span>(<span class="fu">IOBuffer</span>(txt), DataFrame) for txt <span class="op">∈</span> (t1, t2, t3)];</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The first join we introduce is <code>outerjoin</code>. It combines two data frames with rows for keys found in <em>any</em> of the data frames passed in.</p>
<div id="224" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">outerjoin</span>(a1, a2, on<span class="op">=</span>[<span class="st">"first"</span>, <span class="st">"last"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>4×4 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">first</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">last</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">points</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">score</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Bob</td>
<td style="text-align: left;">Jones</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">225</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Alice</td>
<td style="text-align: left;">Smith</td>
<td style="text-align: right;">100</td>
<td style="text-align: right; font-style: italic;">missing</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Carol</td>
<td style="text-align: left;">Gates</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right;">125</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Chad</td>
<td style="text-align: left;">Gad</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right;">200</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The <code>on</code> argument is a column name (or names as above) to join the data frames on. They need not have the same name; the values passed to <code>on</code> may be pairs indicating the mapping. (That is, if we were joining on the last variable, <code>on=:points =&gt; :score</code> would be possible.)</p>
<p>The variable to join on is often called the “key,” though in <code>Julia</code> that terminology is also used with associative arrays.</p>
<p>The joined data frame includes all columns from either data frame not specified in <code>on</code>. The resulting data frame, in this case, is in a wide, not tidy, format.</p>
<p>In the above, the columns do not have names in conflict. However, were <code>a1</code> and <code>a3</code> joined, they would have been. Passing <code>makeunique=true</code> instructs distinguishing names to be produced:</p>
<div id="226" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">outerjoin</span>(a1, a3, on<span class="op">=</span>[<span class="st">"first"</span>, <span class="st">"last"</span>], makeunique<span class="op">=</span><span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>4×4 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">first</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">last</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">points</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">points_1</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Bob</td>
<td style="text-align: left;">Jones</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">300</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Alice</td>
<td style="text-align: left;">Smith</td>
<td style="text-align: right;">100</td>
<td style="text-align: right; font-style: italic;">missing</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Carol</td>
<td style="text-align: left;">Gates</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right;">150</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Erin</td>
<td style="text-align: left;">Dan</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right;">100</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>More than two data frames may be passed to <code>outerjoin</code>, as illustrated below where all three are. The result includes a row for each person (key) in any of the data sets.</p>
<div id="228" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">outerjoin</span>(a1, a2, a3, on<span class="op">=</span>[<span class="st">"first"</span>, <span class="st">"last"</span>], makeunique<span class="op">=</span><span class="cn">true</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>5×5 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">first</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">last</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">points</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">score</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">points_1</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Bob</td>
<td style="text-align: left;">Jones</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">225</td>
<td style="text-align: right;">300</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Carol</td>
<td style="text-align: left;">Gates</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right;">125</td>
<td style="text-align: right;">150</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Alice</td>
<td style="text-align: left;">Smith</td>
<td style="text-align: right;">100</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">4</td>
<td style="text-align: left;">Chad</td>
<td style="text-align: left;">Gad</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right;">200</td>
<td style="text-align: right; font-style: italic;">missing</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">5</td>
<td style="text-align: left;">Erin</td>
<td style="text-align: left;">Dan</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right;">100</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>From the <code>outerjoin</code>, we easily note that only the first listed student was present for all the assessments.</p>
<p>Three other joins related to <code>outerjoin</code> are:</p>
<ul>
<li><code>leftjoin(df1, df2; on, ...)</code> which includes all rows in the left data frame</li>
<li><code>rightjoin(df1, df2; on, ...)</code> which includes all rows in the right data frame (similar to <code>leftjoin(df2, df1)</code>.</li>
<li><code>innerjoin(df1, df2; on, ...)</code> which includes all rows with keys in <em>both</em> data data frames.</li>
</ul>
<p>To illustrate:</p>
<div id="230" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">leftjoin</span>(a1, a2, on<span class="op">=</span>[<span class="st">"first"</span>, <span class="st">"last"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>2×4 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">first</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">last</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">points</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">score</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Bob</td>
<td style="text-align: left;">Jones</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">225</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Alice</td>
<td style="text-align: left;">Smith</td>
<td style="text-align: right;">100</td>
<td style="text-align: right; font-style: italic;">missing</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="232" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rightjoin</span>(a1, a2, on<span class="op">=</span>[<span class="st">"first"</span>, <span class="st">"last"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>3×4 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">first</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">last</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">points</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">score</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Union{Missing, Int64}">Int64?</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Bob</td>
<td style="text-align: left;">Jones</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">225</td>
</tr>
<tr class="even">
<td class="rowNumber" style="text-align: right; font-weight: bold;">2</td>
<td style="text-align: left;">Carol</td>
<td style="text-align: left;">Gates</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right;">125</td>
</tr>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">3</td>
<td style="text-align: left;">Chad</td>
<td style="text-align: left;">Gad</td>
<td style="text-align: right; font-style: italic;">missing</td>
<td style="text-align: right;">200</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>In the following, we must qualify the function below, as <code>SplitApplyCombine</code> has a conflicting use, though this isn’t typically needed:</p>
<div id="234" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>DataFrames.<span class="fu">innerjoin</span>(a1, a2, on<span class="op">=</span>[<span class="st">"first"</span>, <span class="st">"last"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>1×4 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">first</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">last</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">points</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">score</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Bob</td>
<td style="text-align: left;">Jones</td>
<td style="text-align: right;">200</td>
<td style="text-align: right;">225</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Joins have an analog in set operations: the outer join is like a union, the inner join is like an intersection.</p>
<p>The next two joins do not join columns, as the ones above. Rather, they use the second data frame to filter out rows of the first data frame.</p>
<p>The <code>semijoin</code> returns the rows of the left data frame that <em>match</em> a key of the right data frame:</p>
<div id="236" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semijoin</span>(a1, a2[<span class="fl">3</span><span class="op">:</span><span class="fl">3</span>, <span class="op">:</span>]; on<span class="op">=</span>[<span class="st">"first"</span>, <span class="st">"last"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>1×3 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">first</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">last</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">points</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Bob</td>
<td style="text-align: left;">Jones</td>
<td style="text-align: right;">200</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>An <code>antijoin</code> includes rows in the left data frame that <em>do not</em> match a key in the right data frame. (Like the set difference). Here we see the row in common to <code>a1</code> and <code>a2</code> is not included:</p>
<div id="238" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="fu">antijoin</span>(a1, a2, on<span class="op">=</span>[<span class="st">"first"</span>, <span class="st">"last"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div><div style="float: left;"><span>1×3 DataFrame</span></div><div style="clear: both;"></div></div><div class="data-frame" style="overflow-x: scroll;">
<table class="data-frame caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;">Row</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">first</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">last</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">points</th>
</tr>
<tr class="subheader headerLastRow even">
<th class="rowNumber" data-quarto-table-cell-role="th" style="text-align: right; font-weight: bold;"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="InlineStrings.String7">String7</th>
<th style="text-align: left;" data-quarto-table-cell-role="th" title="Int64">Int64</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td class="rowNumber" style="text-align: right; font-weight: bold;">1</td>
<td style="text-align: left;">Alice</td>
<td style="text-align: left;">Smith</td>
<td style="text-align: right;">100</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>


</section>
</div>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-JSSv107i04" class="csl-entry" role="listitem">
Bouchet-Valat, M., and Kamiński, B. (2023), <span>“DataFrames.jl: Flexible and fast tabular data in julia,”</span> <em>Journal of Statistical Software</em>, 107, 1â32. <a href="https://doi.org/10.18637/jss.v107.i04">https://doi.org/10.18637/jss.v107.i04</a>.
</div>
<div id="ref-JSSv040i01" class="csl-entry" role="listitem">
Wickham, H. (2011), <span>“The split-apply-combine strategy for data analysis,”</span> <em>Journal of Statistical Software</em>, 40, 1–29. <a href="https://doi.org/10.18637/jss.v040.i01">https://doi.org/10.18637/jss.v040.i01</a>.
</div>
<div id="ref-tidy-data" class="csl-entry" role="listitem">
Wickham, H. (2014), <span>“<a href="http://www.jstatsoft.org/v59/i10/">Tidy data</a>,”</span> <em>The Journal of Statistical Software</em>, 59.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>There are other storage formats available within <code>Julia</code> that can contain more detail on the data, e.g.&nbsp;<code>Arrow</code>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>This combination of column selectors is also performed by <code>Cols(1, :v, "p", r"^l")</code>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>The <code>DataPipes</code> package inserts a magical <code>_</code> in the last positional argument, which is common with higher-order functions like <code>filter</code>. The example could become <code>@p tbl |&gt; filter(_.v &gt;= 25) |&gt; filter(_.p &gt;= 350)</code> with the new lines replacing the pipe operation as a convenience with longer chains<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../EDA/univariate-julia.html" class="pagination-link" aria-label="Univariate data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Univariate data</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../EDA/bivariate-julia.html" class="pagination-link" aria-label="Bivariate data">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bivariate data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jverzani/UsingJ/edit/master/EDA/tabular-data-julia.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jverzani/UsingJ/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>© Copyright 2023-25, John Verzani. All rights reserved.</p>
</div>
  </div>
</footer>




</body></html>