<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Probability distributions – Using Julia for Introductory Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Inference/inference.html" rel="next">
<link href="../EDA/makie.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-KS515LKBGZ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-KS515LKBGZ', { 'anonymize_ip': true});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Inference/distributions.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Probability distributions</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Using Julia for Introductory Statistics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jverzani/UsingJ" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Julia introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/univariate-julia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Univariate data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/tabular-data-julia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Tabular data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/bivariate-julia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Bivariate data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/categorical-data-julia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Categorical data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../EDA/makie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The <code>AlgebraOfGraphics</code> package</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Inference/distributions.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Probability distributions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Inference/inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Inference</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../LinearModels/linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">The linear regression model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#probability" id="toc-probability" class="nav-link active" data-scroll-target="#probability"><span class="header-section-number">7.1</span> Probability</a>
  <ul class="collapse">
  <li><a href="#statistical-language" id="toc-statistical-language" class="nav-link" data-scroll-target="#statistical-language"><span class="header-section-number">7.1.1</span> Statistical language</a></li>
  </ul></li>
  <li><a href="#the-distributions-package" id="toc-the-distributions-package" class="nav-link" data-scroll-target="#the-distributions-package"><span class="header-section-number">7.2</span> The Distributions package</a>
  <ul class="collapse">
  <li><a href="#bernoulli-binomial-geometric" id="toc-bernoulli-binomial-geometric" class="nav-link" data-scroll-target="#bernoulli-binomial-geometric"><span class="header-section-number">7.2.1</span> Bernoulli, Binomial, Geometric</a></li>
  <li><a href="#uniform-and-discretenonparametric-distributions" id="toc-uniform-and-discretenonparametric-distributions" class="nav-link" data-scroll-target="#uniform-and-discretenonparametric-distributions"><span class="header-section-number">7.2.2</span> Uniform and DiscreteNonParametric distributions</a></li>
  <li><a href="#the-continuous-uniform-distribution" id="toc-the-continuous-uniform-distribution" class="nav-link" data-scroll-target="#the-continuous-uniform-distribution"><span class="header-section-number">7.2.3</span> The continuous uniform distribution</a></li>
  <li><a href="#the-normal-distribution" id="toc-the-normal-distribution" class="nav-link" data-scroll-target="#the-normal-distribution"><span class="header-section-number">7.2.4</span> The normal distribution</a></li>
  <li><a href="#the-chi-squared-distribution" id="toc-the-chi-squared-distribution" class="nav-link" data-scroll-target="#the-chi-squared-distribution"><span class="header-section-number">7.2.5</span> The Chi-squared distribution</a></li>
  <li><a href="#the-t-and-f-distributions" id="toc-the-t-and-f-distributions" class="nav-link" data-scroll-target="#the-t-and-f-distributions"><span class="header-section-number">7.2.6</span> The T and F distributions</a></li>
  </ul></li>
  <li><a href="#sampling-distributions" id="toc-sampling-distributions" class="nav-link" data-scroll-target="#sampling-distributions"><span class="header-section-number">7.3</span> Sampling distributions</a>
  <ul class="collapse">
  <li><a href="#the-sample-mean" id="toc-the-sample-mean" class="nav-link" data-scroll-target="#the-sample-mean"><span class="header-section-number">7.3.1</span> The sample mean</a></li>
  <li><a href="#the-sample-variance" id="toc-the-sample-variance" class="nav-link" data-scroll-target="#the-sample-variance"><span class="header-section-number">7.3.2</span> The sample variance</a></li>
  <li><a href="#the-sample-median" id="toc-the-sample-median" class="nav-link" data-scroll-target="#the-sample-median"><span class="header-section-number">7.3.3</span> The sample median</a></li>
  <li><a href="#the-chi-squared-statistic" id="toc-the-chi-squared-statistic" class="nav-link" data-scroll-target="#the-chi-squared-statistic"><span class="header-section-number">7.3.4</span> The Chi-squared statistic</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/jverzani/UsingJ/edit/master/Inference/distributions.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jverzani/UsingJ/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Probability distributions</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Exploratory data analysis differs from statistics. A statistical model for a measurement involves a description of the random nature of the measurement. To describe randomness, the language of probability is used. Much of this language is implemented in the <code>Distributions</code> package of <code>Julia</code>, loaded below with other packages:</p>
<div id="3dd7df39" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">StatsBase</span>, <span class="bu">DataFrames</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">CairoMakie</span>, <span class="bu">AlgebraOfGraphics</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="probability" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="probability"><span class="header-section-number">7.1</span> Probability</h2>
<p>This section quickly reviews the basic concepts of probability.</p>
<p>Mathematically a probability is an assignment of numbers to a collection of events (sets) of a probability space. These values may be understood from a model or through long term frequencies. For example, consider the tossing of a <em>fair</em> coin. By writing “fair” the assumption is implicitly made that each side (heads or tails) is equally likely to occur on a given toss. That is a mathematical assumption. This can be reaffirmed by tossing the coin <em>many</em> times and counting the frequency of a heads occuring. If the coin is fair, the expectation is that heads will occur in about half the tosses.</p>
<p>The mathematical model involves a formalism of sample spaces and events. There are some subtleties due to infinite sets, but we limit our use of events to subsets of finite or countably infinite sets or intervals of the real line. A probability <em>measure</em> is a function <span class="math inline">\(P\)</span> which assigns each event <span class="math inline">\(E\)</span> a number with:</p>
<ul>
<li><span class="math inline">\(0 \leq P(E) \leq 1\)</span></li>
<li>The probability of the empty event is <span class="math inline">\(P(\emptyset) = 0\)</span>, the probability of the the sample space is <span class="math inline">\(P(\Omega) = 1\)</span>.</li>
<li>If events <span class="math inline">\(E_1, E_2, \dots\)</span> are <em>disjoint</em> then the probability of their <em>union</em> is the sum of the individual probabilities.</li>
</ul>
<p>A <em>random variable</em>, <span class="math inline">\(X\)</span>, is a function which takes an <em>outcome</em> (an element of an event) in a sample space and assigns a number. Random variables naturally generate <em>events</em> through sets of the type <span class="math inline">\(\{X = k\}\)</span> for some <span class="math inline">\(k\)</span>. This event being <em>all</em> outcomes for which <span class="math inline">\(X\)</span> would be <span class="math inline">\(k\)</span>. Similarly, <span class="math inline">\(\{X \leq a\}\)</span> for some <span class="math inline">\(a\)</span> describes an event. These are the <em>typical</em> events of statistics.</p>
<p>The rules of probability lead to a few well used formulas: <span class="math inline">\(P(X \leq a) = 1 - P(X &gt; a)\)</span> and <em>for</em> <strong>discrete</strong> random variables <span class="math inline">\(P(X \leq k) = \sum_{j \leq k} P(X = j)\)</span>. Both illustrated in <a href="#fig-distributions" class="quarto-xref">Figure&nbsp;<span>7.1</span></a>.</p>
<div id="fig-distributions" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-distributions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div id="ab8d065f" class="cell quarto-layout-cell" data-execution_count="2" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output cell-output-display" data-execution_count="3">
<div>
<figure class="figure">
<p><img src="distributions_files/figure-html/cell-3-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="a7afd628" class="cell quarto-layout-cell" data-execution_count="3" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output cell-output-display" data-execution_count="4">
<div>
<figure class="figure">
<p><img src="distributions_files/figure-html/cell-4-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-distributions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.1: Illustrations of <span class="math inline">\(P(X \leq a)\)</span> = <span class="math inline">\(1 - P(X &gt; a)\)</span> for a discrete and continuous distribution.
</figcaption>
</figure>
</div>
<p>A <em>distribution</em> of a random variable is a description of the probabilities of events generated by a random variable. For our purposes, it is sufficient to describe events of the type <span class="math inline">\(\{X \leq a\}\)</span>, <span class="math inline">\(\{X &lt; a\}\)</span>, or <span class="math inline">\(\{X = a\}\)</span>, others being formed through intersections and unions. A valid description of the <em>cumulative distribution function</em>, <span class="math inline">\(F(a) = P(X \leq a)\)</span>, (abbreviated cdf) describes the distribution of a random variable.</p>
<p>There are 2 types of distributions where a related function describes the distribution, discrete and continuous distributions.</p>
<p>A <strong>discrete</strong> random variable is one which has <span class="math inline">\(P(X = k) &gt; 0\)</span> for at most a finite or <em>countably</em> infinite set of numbers. For example, if <span class="math inline">\(X\)</span> is the number of coin tosses producing heads in <span class="math inline">\(n\)</span> tosses, then the finite <span class="math inline">\(k\)</span>s are <span class="math inline">\(0,1,2, \dots, n\)</span>. Whereas, if <span class="math inline">\(X\)</span> is the number of coin tosses needed to toss <em>one</em> head. The <span class="math inline">\(k\)</span> would be <span class="math inline">\(1, 2, \dots\)</span> (with no upper bound, as one could get extremely unlucky). For <em>discrete</em> random variables it is enough to describe <span class="math inline">\(f(k) = P(X=k)\)</span> for the valid <span class="math inline">\(k\)</span>s. The function <span class="math inline">\(f(k)\)</span> is called the pdf (probability distribution function). An immediate consequence is <span class="math inline">\(\sum_k f(k) = 1\)</span> and <span class="math inline">\(f(k) \geq 0\)</span>.</p>
<p>A <strong>continuous</strong> random variable is described by a function <span class="math inline">\(f(x)\)</span> where <span class="math inline">\(P(X \leq a)\)</span> is given by the <em>area</em> under <span class="math inline">\(f(x)\)</span> between <span class="math inline">\(-\infty\)</span> and <span class="math inline">\(a\)</span>. The function <span class="math inline">\(f(x)\)</span> is called the pdf (probability density function). An immediate consequence is the <em>total</em> area under <span class="math inline">\(f(x)\)</span> is <span class="math inline">\(1\)</span> and <span class="math inline">\(f(x) \geq 0\)</span>.</p>
<p>When defined, the pdf is the basic description of the distribution of a random variable. It says what is <em>possible</em> and <em>how likely</em> possible things are. For the two cases above, this is done differently. In the discrete case, the possible values are all <span class="math inline">\(k\)</span> where <span class="math inline">\(f(k) =P(X=k) &gt; 0\)</span>, but not all values are equally likely unless <span class="math inline">\(f(k)\)</span> is a constant. For the continuous case there are <strong>no</strong> values with <span class="math inline">\(P(X=k) &gt; 0\)</span>, as probabilities are assigned to area, and the corresponding area to this event, for any <span class="math inline">\(k\)</span>, is <span class="math inline">\(0\)</span>. Rather, values can only appear in itervals with positive area (<span class="math inline">\(f(x) &gt; 0\)</span> within this interval) and for equal-length intervals, those with more area above them are more likely to contain values.</p>
<p>A data set in statistics, <span class="math inline">\(x_1, x_2, \dots, x_n\)</span>, is typically modeled by a collection of random variables, <span class="math inline">\(X_1, X_2, \dots, X_n\)</span>. That is, the random variables describe the <em>possible</em> values that can be collected, the values (<span class="math inline">\(x_1, x_2,\dots\)</span>) describe the actual values that were collected. Put differently, random variables describe what can happen <em>before</em> a measurement, the values are the result of the measurement.</p>
<p>The <em>joint</em> cumulative distribution is the probability <span class="math inline">\(P(X_1 \leq a_1, X_2 \leq a_2, \dots X_n \leq a_n)\)</span>. A common assumption made for statistics is that each of the random variables is</p>
<ul>
<li><em>identically distributed</em>, meaning <span class="math inline">\(F(a) = P(X_i \leq a) = P(X_j \leq a)\)</span> for each pair <span class="math inline">\((i,j)\)</span>.</li>
<li><em>independent</em>, which means that knowing the value of <span class="math inline">\(X_i\)</span> does not effect the probabilities regarding values for <span class="math inline">\(X_j\)</span>, <span class="math inline">\(j \neq i\)</span>. (If you know a first toss of a fair coin is heads, it doesn’t change the odds that the second toss will be heads.)</li>
</ul>
<p>With these two assumptions, the random variables <span class="math inline">\(X_1, X_2, \cdots, X_n\)</span> are termed an <em>iid</em> <em>random sample</em>. For an iid random sample, this simplification applies: <span class="math inline">\(P(X_1 \leq a_1, X_2 \leq a_2, \dots X_n \leq a_n)=F(a_1)\cdot F(a_2) \cdots F(a_n)\)</span> (independence means “multiply”).</p>
<p>In general, the distribution of a random variable may be hard to describe. For example, suppose the random variable is the sample median, <span class="math inline">\(M\)</span>, of <span class="math inline">\(X_1, X_2, \cdots, X_n\)</span>. With the assumption of an iid random sample, a formula for the <em>distribution</em> of <span class="math inline">\(M\)</span> can be worked out in terms of the underlying pdf, <span class="math inline">\(f\)</span> and cdf, <span class="math inline">\(F\)</span>. But without that assumption, it becomes intractable, in general.</p>
<p>When a distribution can not be fully identified, it can still be described. A few basic summaries of a probability distribution are:</p>
<ul>
<li><p>The <em>mean</em> or average value. For a discrete distribution this is <span class="math inline">\(\sum_k k P(X=k)\)</span>, which is a <em>weighted</em> average of the possible values, weighted by how likely they are. For a continuous distribution, a similar formula using calculus concepts applies. Both can be viewed from a center of mass perspective. The symbol <span class="math inline">\(\mu\)</span> or <span class="math inline">\(E(X)\)</span> (expectation) is used to represent the mean.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p></li>
<li><p>The <em>variance</em> of a probability distribution describes the spread; the <em>standard deviation</em> is the square root of the variance. For a random variable, the variance is described by the <em>average value</em> of the centered random variable, squared: <span class="math inline">\(E( (X - \mu)^2 )\)</span>. The symbol <span class="math inline">\(\sigma^2\)</span> is used to represent the variance, <span class="math inline">\(\sigma\)</span> then is the standard deviation. <span class="math inline">\(VAR(X)\)</span> is also used to represent the variance of a random variable, similarly <span class="math inline">\(SD(X)\)</span> is used for the standard deviation.</p></li>
</ul>
<p>The transformation <span class="math inline">\(X - \mu = X - E(X)\)</span> centers the random variable <span class="math inline">\(X\)</span>, so that <span class="math inline">\(E(X-\mu) = 0\)</span>.</p>
<p>The transformation <span class="math inline">\(Z = (X - \mu)/\sigma\)</span>, following the <span class="math inline">\(z\)</span>-score, centers and <em>scales</em> the random variable <span class="math inline">\(X\)</span>. The random variable <span class="math inline">\(Z\)</span> has <span class="math inline">\(E(Z) = 0\)</span> and <span class="math inline">\(VAR(Z) = 1\)</span>.</p>
<p>For a <em>random sample</em> <span class="math inline">\(X_1, X_2, \dots, X_n\)</span> the sum <span class="math inline">\(S = \sum_k X_k\)</span> has the property that <span class="math inline">\(E(S) = \sum_k E(X_k)\)</span> (“expectations add”). This is true even if the sample is not iid. For example, finding the average number of heads in <span class="math inline">\(100\)</span> tosses of a fair coin is easy, it being <span class="math inline">\(100 \cdot (1/2) = 50\)</span>, the <span class="math inline">\(1/2\)</span> being the expectation of a single heads where <span class="math inline">\(X_i=1\)</span> if heads, and <span class="math inline">\(X_i=0\)</span> if tails.</p>
<p>While <span class="math inline">\(E(X_1 + X_2) = E(X_1) + E(X_2)\)</span>, as expectations are <em>linear</em> and satisfy <span class="math inline">\(E(aX+bY) = aE(X)+bE(Y)\)</span>, it is not the case that <span class="math inline">\(E(X_1 \cdot X_2) = E(X_1) \cdot E(X_2)\)</span> in general – though it is true when the two random variables are independent. As such, the variance of <span class="math inline">\(S= \sum_k X_k\)</span> is:</p>
<p><span class="math display">\[
VAR(\sum_k X_k) = \sum_k VAR(X_k) + 2 \sum_{i &lt; j} COV(X_i, X_j),
\]</span></p>
<p>where the <em>covariance</em> is <span class="math inline">\(COV(X_i,X_j) = E((X_i - E(X_i)) \cdot (X_j - E(X_j)))\)</span>. If, the random variables in the sample are independent, then the covariances are <span class="math inline">\(0\)</span> and the variance of a sum is the sum of the variances.</p>
<section id="statistical-language" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="statistical-language"><span class="header-section-number">7.1.1</span> Statistical language</h3>
<p>In statistics we have seen a random sample is a sequence of random variables <span class="math inline">\(X_1, X_2, \dots, X_n\)</span>. Assume this is an iid random sample.</p>
<p>The <em>population</em> is the common distribution of each random variable in the random sample. Populations have a pdf and cdf, often denoted <span class="math inline">\(f_X(x)\)</span> and <span class="math inline">\(F_X(x)\)</span>. Populations are summarized by <em>parameters</em>, such as the mean (<span class="math inline">\(\mu\)</span>) or the standard deviation (<span class="math inline">\(\sigma\)</span>).</p>
<p>A statistic is some summary of a random sample. For example, the median, or middle value, or the sample mean <span class="math inline">\(\bar{X} = (X_1 + X_2 + \cdots X_n)/n\)</span>. Statistics are also <em>random variables</em> and so are described by a distribution (when computable) or summarized by values such as the mean or standard deviation.</p>
<p>For the sample mean from an iid random sample, the above says:</p>
<p><span class="math display">\[\begin{align*}
E(\bar{X}) &amp;=  E\left(\frac{X_1 + X_2 + \cdots + X_n}{n}\right) \\
&amp;= \frac{1}{n} \sum_k E(X_k) \\
&amp;= \frac{1}{n} \sum_k \mu = \mu;\\
VAR(\bar{X}) &amp;= \frac{1}{n^2} \cdot \left(\sum_k VAR(X_k) + 2\sum_{i &lt; j} COV(X_i,X_j)\right)\\
&amp;= \frac{1}{n^2}\sum_k VAR(X_k) \\
&amp;= \frac{1}{n^2} n \cdot \sigma^2 = \frac{\sigma^2}{n}.
\end{align*}\]</span></p>
<p>The standard deviation then is <span class="math inline">\(SD(\bar{X}) = \sigma/\sqrt{n}\)</span>.</p>
<p>In short, the expected value of the mean is the expected value of the <em>population</em>; the variance of the mean (of an iid random sample) is the variance of the population <em>divided</em> by the sample size, <span class="math inline">\(n\)</span>. The latter speaks to variability: there is more variability in a single random value than in an average of the random values. The distribution of <span class="math inline">\(\bar{X}\)</span> can be expressed through formulas in terms of <span class="math inline">\(f_X(x)\)</span>, but is <em>well approximated</em> as <span class="math inline">\(n\)</span> gets large by a distribution characterized by its mean and standard deviation, as will be seen.</p>
<p>There are parallels between random variables and data sets:</p>
<ul>
<li>The random sample <span class="math inline">\(X_1, X_2, \dots, X_n\)</span> is realized in a data set by values <span class="math inline">\(x_1, x_2, ... x_n\)</span>.</li>
<li>The distribution, <span class="math inline">\(f_X(x)\)</span>, is reflected in the data set.</li>
<li>The distribution, <span class="math inline">\(f_X(x)\)</span> is <em>typically</em> described by key <em>parameters</em></li>
<li>The data set is <em>typically</em> summarized by sample statistics.</li>
</ul>
<p>Statistical inference makes statements using the language of probability about the <em>parameters</em> in terms of various sample statistics.</p>
<p>An intuitive example is the tossing of a fair coin modeling heads by a <span class="math inline">\(1\)</span> and tails by a <span class="math inline">\(0\)</span> then we can <em>parameterize</em> the distribution by <span class="math inline">\(f(1) = P(X=1) = p\)</span> and <span class="math inline">\(f(0) = P(X=0) = 1 - P(X=1) = 1-p\)</span>. This distribution is summarized by <span class="math inline">\(\mu=p\)</span>, <span class="math inline">\(\sigma = \sqrt{p(1-p)}\)</span>. A <em>fair</em> coin would have <span class="math inline">\(p=1/2\)</span>. A sequence of coin tosses, say H,T,T,H,H might be modeled by a sequence of iid random variables, each having this distribution. Then we might expect a few things, where <span class="math inline">\(\hat{p}\)</span> below is the proportion of heads in the <span class="math inline">\(n\)</span> tosses:</p>
<ul>
<li>A given data set is not random, but it may be viewed as the result of a random process and had that process been run again would likely result in a different outcome. These different outcomes may be described probabalistically in terms of a distribution.</li>
<li>If <span class="math inline">\(n\)</span> is large enough, the sample proportion <span class="math inline">\(\hat{p}\)</span> should be <em>close</em> to the population proportion <span class="math inline">\(p\)</span>.</li>
<li>Were the sampling repeated, the variation in the values of <span class="math inline">\(\hat{p}\)</span> should be smaller for larger sample sizes, <span class="math inline">\(n\)</span>.</li>
</ul>
<p>These imprecise statements can be made more precise, as will be seen. Figure <a href="#fig-pop-parameters-sample" class="quarto-xref">Figure&nbsp;<span>7.2</span></a> illustrates a population, several different samples from it with the <em>sample means</em> visualized by a density plot. The density plot is centered at the same location as the population, but is narrower, reflecting smaller variability.</p>
<div id="cell-fig-pop-parameters-sample" class="cell" data-execution_count="4">
<div class="cell-output cell-output-display" data-execution_count="5">
<div id="fig-pop-parameters-sample" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pop-parameters-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="distributions_files/figure-html/fig-pop-parameters-sample-output-1.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pop-parameters-sample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.2: The top-left figure shows a population, the lower left parameters associated with the population. The top-right shows one sample from the population in red, other possible samples in blue with sample means summarized in the bottom most row. A density estimate of these sample means appears in the lower right figure showing how it is centered on the population, but more concentrated. Inference uses the language of probability to characterize a population parameter based on a single random sample.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Inferential statistics is similar: A population is a distribution summarized by parameters. A random sample drawn from a population is summarized by statistics. A statistic summarizes just one sample, but the language of probability is used to infer from that one sample, statements about the parameters which would be apparent were there many different random samples.</p>
</section>
</section>
<section id="the-distributions-package" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="the-distributions-package"><span class="header-section-number">7.2</span> The Distributions package</h2>
<p>While populations are in general described by a cdf, populations which are discrete or continuous are more naturally described by their pdf. There are many standard pdfs used to describe different types of randomness and supported in the <code>Distributions</code> package. This section reviews several.</p>
<div id="a18850f3" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="bernoulli-binomial-geometric" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="bernoulli-binomial-geometric"><span class="header-section-number">7.2.1</span> Bernoulli, Binomial, Geometric</h3>
<p>The simplest non-trivial distribution is that used to model a coin toss: <span class="math inline">\(P(X=1)=p\)</span> and <span class="math inline">\(P(X=0) = 1-p\)</span>. We see this is <em>parameterized</em> by <span class="math inline">\(p\)</span>, the probability of heads (say). This also happens to be the mean of this distribution. By the rules of probability, we must have <span class="math inline">\(0 \leq p \leq 1\)</span>.</p>
<p>In the <code>Distributions</code> package, named distributions are given a type, in this case <code>Bernoulli</code> which requires a value of <span class="math inline">\(p\)</span> to be formed. The following code uses the type and confirms the mean of this distribution is indeed <span class="math inline">\(p\)</span>:</p>
<div id="5a096dd6" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fl">0.25</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>Be <span class="op">=</span> <span class="fu">Bernoulli</span>(p)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Be)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>0.25</code></pre>
</div>
</div>
<p>The <code>Bernoulli(p)</code> distribution is very simple, but combinations of <span class="math inline">\(Bernoulli(p)\)</span> random variables give rise to many interesting distributions. For example, the number of heads in 10 coin tosses could be modeled by the sum of 10 Bernoulli random variables. The distribution of this random variable is described by the <code>Binomial</code> distribution. It has two parameters: <span class="math inline">\(p\)</span> for the Bernoulli <span class="math inline">\(10\)</span> for the number of tosses and is implemented with the <code>Binomial(n,p)</code> type. There are several summary statistics for the types supported by <code>Distributions</code>, including: <code>mean</code>, <code>median</code>, <code>std</code>:</p>
<div id="3fceb29d" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>n, p <span class="op">=</span> <span class="fl">10</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">2</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> <span class="fu">Binomial</span>(n, p)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(B),  <span class="fu">median</span>(B), <span class="fu">std</span>(B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>(5.0, 5, 1.5811388300841898)</code></pre>
</div>
</div>
<p>The mean and standard deviation for the Binomial can be easily computed when this statistic is viewed as a sample mean of 10 Bernoulli random variables (<span class="math inline">\(np\)</span> and <span class="math inline">\(\sqrt{np(1-p)}\)</span>).</p>
<p>More is known. For example, the value of this random variable can only be between 0 and 10. The <code>extrema</code> function combines both the <code>minimum</code> and <code>maximum</code> functions to give this:</p>
<div id="19fa02c6" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extrema</span>(B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>(0, 10)</code></pre>
</div>
</div>
<p>The <code>insupport</code> function is similar, returning <code>true</code> or <code>false</code> if a value, <code>x</code>, is in the support of the distribution, that is if <code>x</code> is a <em>possible</em> value:</p>
<div id="d2533acc" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">insupport</span>(B, <span class="fl">5</span>), <span class="fu">insupport</span>(B, <span class="fl">15</span>), <span class="fu">insupport</span>(B, <span class="fl">5.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>(true, false, false)</code></pre>
</div>
</div>
<p>We see only <code>5</code> is a possible value. Its probability, <span class="math inline">\(P(X=5)\)</span> for this discrete distribution, is computed by <code>pdf</code>:</p>
<div id="a9e735e1" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(B, <span class="fl">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>0.24609375000000022</code></pre>
</div>
</div>
<p><a href="#fig-binomials" class="quarto-xref">Figure&nbsp;<span>7.3</span></a> shows different examples of the binomial distribution. When both <span class="math inline">\(np\)</span> and <span class="math inline">\(n(1-p)\)</span> are <span class="math inline">\(5\)</span> or more, the shape is roughly symmetric.</p>
<div id="fig-binomials" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-binomials-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div id="a2c60875" class="cell quarto-layout-cell" data-execution_count="11" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output cell-output-display" data-execution_count="12">
<div>
<figure class="figure">
<p><img src="distributions_files/figure-html/cell-12-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cc6b171c" class="cell quarto-layout-cell" data-execution_count="12" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="cell-output cell-output-display" data-execution_count="13">
<div>
<figure class="figure">
<p><img src="distributions_files/figure-html/cell-13-output-1.svg" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-binomials-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.3: The binomial distribution for different <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span> values. The left graphic fixes <span class="math inline">\(n=20\)</span> and shows different <span class="math inline">\(p\)</span> values. One is more “bell-shaped” as both <span class="math inline">\(np\)</span> and <span class="math inline">\(n(1-p)\)</span> are bigger than <span class="math inline">\(5\)</span>. The right graphic shows a fixed <span class="math inline">\(p\)</span> and different <span class="math inline">\(n\)</span>s. As <span class="math inline">\(n\)</span> gets bigger, the shape is more bell shaped.
</figcaption>
</figure>
</div>
<p>The cumulative distribution function is computed by <code>cdf</code> with the same calling style, <code>cdf(D, x)</code>. The complementary cumulative distribution function, <code>1 - F(x)</code>, is computed by <code>ccdf(D, x)</code>.</p>
<p>The cumulative distribution, <span class="math inline">\(F(a)\)</span>, finds the value <span class="math inline">\(p\)</span> for a given value of <span class="math inline">\(a\)</span> in <span class="math inline">\(p = P(X \leq a)\)</span>. It’s inverse operation, finding a value <span class="math inline">\(a\)</span> in <span class="math inline">\(p=P(X \leq a)\)</span> for a given <span class="math inline">\(p\)</span>, is returned by <code>quantile</code>.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> Quantiles are computed with the calling style <code>quantile(D, p)</code>.</p>
<p>A related question is the number of coin tosses needed to get the <em>first</em> heads. If <span class="math inline">\(X\)</span> is this distribution, the the event <span class="math inline">\(\{X &gt; k\}\)</span> can be described as the first <span class="math inline">\(k\)</span> tosses were tails. This probability is directly computable. The distribution of this number depends only on the parameter <span class="math inline">\(p\)</span> and is called the <em>Geometric distribution</em>.</p>
<p>For example, we can see here the mean, and standard deviation, and also that the the number is unbounded:</p>
<div id="611913bc" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> <span class="fu">Geometric</span>(p)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(G), <span class="fu">std</span>(G), <span class="fu">extrema</span>(G) <span class="co"># 1/p, 1/√p, 0,1,...,∞</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>(1.0, 1.4142135623730951, (0, Inf))</code></pre>
</div>
</div>
</section>
<section id="uniform-and-discretenonparametric-distributions" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="uniform-and-discretenonparametric-distributions"><span class="header-section-number">7.2.2</span> Uniform and DiscreteNonParametric distributions</h3>
<p>A <em>discrete</em> uniform random variable on <span class="math inline">\(a, a+1, \dots, b\)</span> assigns equal weight to each value. Hence, each possible value is equally likely. The <code>DiscreteUniform(a,b)</code> type models this distribution. For example, to model the roll of a 6-sided die, we might have:</p>
<div id="96a36791" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>D <span class="op">=</span> <span class="fu">DiscreteUniform</span>(<span class="fl">1</span>,<span class="fl">6</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(D), <span class="fu">std</span>(D)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>(3.5, 1.707825127659933)</code></pre>
</div>
</div>
<p>More generally, a distribution which assigns weight <span class="math inline">\(p_k\)</span> to values <span class="math inline">\(x_1, x_2, \dots, x_n\)</span> is modeled by the <code>DiscreteNonParametric(xs, ps)</code> distribution. For example, Benford’s “law” is an observation that the first non-zero digit of many data sets follows a certain pattern. For this the <em>possible</em> values are <span class="math inline">\(1\)</span> through <span class="math inline">\(9\)</span> and their probabilities are <span class="math inline">\(f(k) = P(X=k) = \log_{10}(k+1) - \log_{10}(k)\)</span>. We can model this with:</p>
<div id="21735f44" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ps <span class="op">=</span> <span class="fu">log10</span>.(xs <span class="op">.+</span> <span class="fl">1</span>) <span class="op">-</span> <span class="fu">log10</span>.(xs)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> <span class="fu">DiscreteNonParametric</span>(xs, ps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>DiscreteNonParametric{Int64, Float64, UnitRange{Int64}, Vector{Float64}}(
support: 1:9
p: [0.3010299956639812, 0.17609125905568124, 0.12493873660829996, 0.09691001300805646, 0.07918124604762478, 0.06694678963061318, 0.057991946977686726, 0.05115252244738133, 0.04575749056067513]
)</code></pre>
</div>
</div>
<p>We can answer questions like the mean, the standard deviation, and what is the probability the number is <code>5</code> or less with:</p>
<div id="d7d7ad57" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(B), <span class="fu">std</span>(B), <span class="fu">cdf</span>(B, <span class="fl">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>(3.4402369671232065, 2.4609982997506656, 0.7781512503836436)</code></pre>
</div>
</div>
<div id="cell-fig-Benford" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">5</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>ks <span class="op">=</span> <span class="fu">support</span>(B)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>ps <span class="op">=</span> <span class="fu">pdf</span>.(B, ks)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>as <span class="op">=</span> <span class="fu">ifelse</span>.(ks <span class="op">.&lt;=</span> a, <span class="st">"X ≤ </span><span class="sc">$</span>a<span class="st">"</span>, <span class="st">"X &gt; </span><span class="sc">$</span>a<span class="st">"</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>layers <span class="op">=</span> <span class="fu">visual</span>(Rangebars) <span class="op">+</span> <span class="fu">visual</span>(Scatter)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fu">data</span>((; ks, ps, as)) <span class="op">*</span> layers <span class="op">*</span> <span class="fu">mapping</span>(<span class="op">:</span>ks, <span class="op">:</span>ps, <span class="op">:</span>ps <span class="op">=&gt;</span> zero, color<span class="op">=:</span>as)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div id="fig-benford" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-benford-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="distributions_files/figure-html/fig-benford-output-1.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-benford-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.4: Benford’s law illustrated with values <span class="math inline">\(5\)</span> or less illustrated
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <code>Distributions</code> the <code>Categorical</code> type can alse have been used to construct this distribution, it being a special case of <code>DiscreteNonParametric</code> with the <code>xs</code> being <span class="math inline">\(1, \dots, k\)</span>.</p>
<p>The multinomial distribution is the distribution of counts for a sequence of <span class="math inline">\(n\)</span> iid random variables from a <code>Categorical</code> distribution. This generalizes the binomial distribution. Let <span class="math inline">\(X_i\)</span> be the number of type <span class="math inline">\(i\)</span> in <span class="math inline">\(n\)</span> samples. Then <span class="math inline">\(X_1 + X_2 + \cdots + X_k = n\)</span>, so these are not independent. They have mean <span class="math inline">\(E(X_i)=np_i\)</span>, variance <span class="math inline">\(VAR(X_i) = np_i (1-p_i)\)</span>, like the binomial, but covariance <span class="math inline">\(COV(X_i, X_j) = -np_i p_j, i \neq j\)</span>. (Negative, as large values for <span class="math inline">\(X_i\)</span> correlate with smaller values for <span class="math inline">\(X_j\)</span> when <span class="math inline">\(i \neq j\)</span>.)</p>
</section>
<section id="the-continuous-uniform-distribution" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="the-continuous-uniform-distribution"><span class="header-section-number">7.2.3</span> The continuous uniform distribution</h3>
<p>The continuous uniform distribution models equally likely outcomes over an interval <span class="math inline">\([a,b]\)</span>. (The endpoints possibly open, as mathematically they have no chance of being selected.) For example, the built-in <code>rand</code> function for Float64 values returns random numbers which are modeled by being uniform over <span class="math inline">\([0,1)\)</span>. (That they can be <code>0</code> but not <code>1</code> is a reality of how computers and mathematical models aren’t always exactly the same, but rather the model is an abstraction of the implementation.)</p>
<p>The <code>Uniform(a,b)</code> type models these numbers. Here we see <code>rand</code> being used to randomly sample <span class="math inline">\(3\)</span> uniform numbers using a more general interface than the use of <code>rand</code> in base <code>Julia</code>:</p>
<div id="af2a54cf" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>U <span class="op">=</span> <span class="fu">Uniform</span>(<span class="fl">0</span>, <span class="fl">1</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rand</span>(U, <span class="fl">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>3-element Vector{Float64}:
 0.5563874645453806
 0.6823698185902889
 0.15811784668574047</code></pre>
</div>
</div>
<p>If <span class="math inline">\(U\)</span> is Uniform on <span class="math inline">\([0,1]\)</span> then <span class="math inline">\(Y = aU + b\)</span> is uniform on <span class="math inline">\([b, b+a]\)</span>. The difference in means is shifted by <span class="math inline">\(b + E(U)\)</span>, the difference in standard deviations is scaled by <span class="math inline">\(a\)</span>. We can do the algebra of linear transformations using overloaded operations:</p>
<div id="73f470f4" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> <span class="fl">2</span>, <span class="fl">3</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> a <span class="op">*</span> U <span class="op">+</span> b</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>q1 <span class="op">=</span> <span class="fu">mean</span>(U) <span class="op">==</span> <span class="fu">mean</span>(Y) <span class="op">-</span> (b <span class="op">+</span> <span class="fu">mean</span>(U)) <span class="op">==</span> (<span class="fl">1</span> <span class="op">+</span> <span class="fl">0</span>)<span class="op">/</span><span class="fl">2</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>q2 <span class="op">=</span> <span class="fu">std</span>(U) <span class="op">==</span> <span class="fu">std</span>(Y)<span class="op">/</span>a  <span class="op">==</span> <span class="fu">sqrt</span>(<span class="fl">1</span><span class="op">/</span><span class="fl">12</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>q1, q2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>(true, true)</code></pre>
</div>
</div>
</section>
<section id="the-normal-distribution" class="level3" data-number="7.2.4">
<h3 data-number="7.2.4" class="anchored" data-anchor-id="the-normal-distribution"><span class="header-section-number">7.2.4</span> The normal distribution</h3>
<p>The most important distribution in statistics is called the normal distribution. This is a bell-shaped distribution completely described by its mean and standard deviation, <code>Normal(mu, sigma)</code> (though some math books use the variance, <span class="math inline">\(\sigma^2\)</span> for the second parameter). The <em>standard</em> normal has <span class="math inline">\(\mu=0\)</span> and <span class="math inline">\(\sigma=1\)</span>. Standard normal random variables are generically denoted by <span class="math inline">\(Z\)</span>:</p>
<div id="7ff0378c" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> <span class="fu">Normal</span>(<span class="fl">0</span>, <span class="fl">1</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(Z), <span class="fu">std</span>(Z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>(0.0, 1.0)</code></pre>
</div>
</div>
<p>There are many facts about standard normals that are useful to know. First we have the three rules of thumb – <span class="math inline">\(68\)</span>, <span class="math inline">\(95\)</span>, <span class="math inline">\(99.7\)</span> – describing the amount of area above <span class="math inline">\([-1,1]\)</span>, <span class="math inline">\([-2,2]\)</span>, and <span class="math inline">\([-3,3]\)</span>. We can see these from the <code>cdf</code> with:</p>
<div id="0f1280a9" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">between</span>(Z, a, b) <span class="op">=</span> <span class="fu">cdf</span>(Z,b) <span class="op">-</span> <span class="fu">cdf</span>(Z,a)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">between</span>(Z, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>), <span class="fu">between</span>(Z, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>), <span class="fu">between</span>(Z, <span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>(0.6826894921370861, 0.9544997361036416, 0.9973002039367398)</code></pre>
</div>
</div>
<p>These values are important as the <span class="math inline">\(z\)</span> scores of different data sets are often assumed to be normal or approximately normal, so, for example, about 95% of such a data set should have <span class="math inline">\(z\)</span> scores within <span class="math inline">\(-2\)</span> and <span class="math inline">\(2\)</span>.</p>
<p>The transformation <span class="math inline">\(Y = \mu + \sigma \cdot Z\)</span> will produce a normal with mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span>, modeled more directly by <code>Normal(mu, sigma)</code>.</p>
<p>A common question in introductory statistics is what values <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> correspond to <span class="math inline">\((1-\alpha)\cdot 100\)</span>% of the area under the pdf of <span class="math inline">\(Y\)</span>? There are infinitely many such answers, but only one pair that is symmetric about the mean, <span class="math inline">\(\mu\)</span>. This can be found with the help of <code>quantile</code> <em>and</em> the observation that <em>since</em> the pdf of <span class="math inline">\(Y\)</span> is symmetric, there will be area <span class="math inline">\(1 - \alpha\)</span> <strong>plus</strong> <span class="math inline">\(\alpha/2\)</span> to the left of <span class="math inline">\(b\)</span>, a question tailor-made for <code>quantile</code>. From <span class="math inline">\(b\)</span>, <span class="math inline">\(a\)</span> can be found from symmetry, it being equidistant from the mean as <span class="math inline">\(b\)</span> is.</p>
<p>For example:</p>
<div id="1090af52" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>mu, sigma <span class="op">=</span> <span class="fl">10</span>, <span class="fl">20</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> <span class="fu">Normal</span>(mu, sigma)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fu">quantile</span>(Y, <span class="fl">1</span> <span class="op">-</span> alpha <span class="op">+</span> alpha<span class="op">/</span><span class="fl">2</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> mu <span class="op">-</span> (b <span class="op">-</span> mu)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>a, b, <span class="fu">between</span>(Y, a, b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>(-29.19927969080115, 49.19927969080115, 0.9500000000000004)</code></pre>
</div>
</div>
<p>An observation of De Moivre in 1733 about the binomial proved foundational. Suppose we consider the binomial distribution with <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span> such that <span class="math inline">\(np\)</span> and <span class="math inline">\(n\cdot(1-p)\)</span> are both <span class="math inline">\(10\)</span> or more. Then <span class="math inline">\(\mu = np\)</span> and <span class="math inline">\(\sigma = \sqrt{np(1-p)}\)</span>. The cdf of this distribution was observed to be <em>very</em> well approximated by the cdf of the <span class="math inline">\(Normal(\mu, \sigma)\)</span> distribution. Furthermore, <em>asymptotically</em> they are equal.</p>
<p>For example, the following searches for the largest discrepancy in the cdfs:</p>
<div id="0c08bce6" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>n, p <span class="op">=</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>mu, sigma <span class="op">=</span> n<span class="op">*</span>p, <span class="fu">sqrt</span>(<span class="fu">n*p*</span>(<span class="fl">1</span><span class="op">-</span>p))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>B, Y <span class="op">=</span> <span class="fu">Binomial</span>(n,p), <span class="fu">Normal</span>(mu, sigma)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>ks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">100</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">findmax</span>(<span class="fu">abs</span>(<span class="fu">cdf</span>(B, k) <span class="op">-</span> <span class="fu">cdf</span>(Y, k)) <span class="cf">for</span> k <span class="kw">in</span> ks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>(0.046989293624614625, 34)</code></pre>
</div>
</div>
<p>This shows an error of not more than <span class="math inline">\(0.0469...\)</span> in approximating the binomial with the normal. The <em>continuity correction</em> adjusts for the discrete nature of the binomial by comparing <span class="math inline">\(k\)</span> to <span class="math inline">\(k+1/2\)</span> for the normal. The following is more accurate, as can be seen:</p>
<div id="08b4ef2e" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">findmax</span>(<span class="fu">abs</span>(<span class="fu">cdf</span>(B, k) <span class="op">-</span> <span class="fu">cdf</span>(Y, k<span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>)) <span class="cf">for</span> k <span class="kw">in</span> ks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>(0.004701503073942237, 34)</code></pre>
</div>
</div>
<p>Of course, computationally it is often just as easy to call <code>cdf(B, k)</code> as it is to call <code>cdf(Y, k + 1/2)</code>, so the advantage here is theoretical for computationally tractable values of <span class="math inline">\(n\)</span> and <span class="math inline">\(k\)</span>. This particular approximation is generalized in the central limit theorem.</p>
</section>
<section id="the-chi-squared-distribution" class="level3" data-number="7.2.5">
<h3 data-number="7.2.5" class="anchored" data-anchor-id="the-chi-squared-distribution"><span class="header-section-number">7.2.5</span> The Chi-squared distribution</h3>
<p>Let <span class="math inline">\(Z\)</span> be a standard normal random variable. As seen, a linear transform of <span class="math inline">\(Z\)</span>: <span class="math inline">\(Y=\sigma Z + \mu\)</span> will have distribution of <span class="math inline">\(Normal(\mu,\sigma)\)</span>, a different transform <span class="math inline">\(Y=Z^2\)</span> can have its distribution computed using some tricks, e.g.&nbsp;(<span class="math inline">\(P(Z^2 &lt; a) = P(-\sqrt{a} &lt; Z &lt; \sqrt{a})\)</span>.) If we have an iid random sample, <span class="math inline">\(Z_1, Z_2, \dots, Z_n\)</span> the distribution of <span class="math inline">\(\chi^2 = Z_1^2 + Z_2^2 + \cdots + Z_n^2\)</span> is of interest. (It may be viewed as the distance squared of a randomly chosen point in space, say.) The distribution of <span class="math inline">\(\chi^2\)</span> is the <em>Chi-squared distribution</em> with <span class="math inline">\(n\)</span> degrees of freedom and is implemented in the <code>Chisq(n)</code> type.</p>
</section>
<section id="the-t-and-f-distributions" class="level3" data-number="7.2.6">
<h3 data-number="7.2.6" class="anchored" data-anchor-id="the-t-and-f-distributions"><span class="header-section-number">7.2.6</span> The T and F distributions</h3>
<p>There are two main distributions which arise in the distribution of many sample statistics related to the linear regression model, these are the <span class="math inline">\(T\)</span>-distribution of Student and the <span class="math inline">\(F\)</span>-distribution of Fischer. Both are <em>parameterized</em> by “degrees of freedom,” which are more naturally discussed with sampling distributions.</p>
<p>Consider two <em>independent</em> random variables, a standard normal <span class="math inline">\(Z\)</span> and a Chi-squared random variable, <span class="math inline">\(Y\)</span>, with <span class="math inline">\(\nu\)</span> degrees of freedom. The <span class="math inline">\(T\)</span>-distribution with <span class="math inline">\(\nu\)</span> degrees of freedom is the distribution of the ratio:</p>
<p><span class="math display">\[
T = \frac{Z}{\sqrt{Y/\nu}}.
\]</span></p>
<p>The <span class="math inline">\(T\)</span>-distribution is a symmetric, bell-shaped distribution like the normal distribution, but has wider, fatter tails hence typically produces larger values in a sample. This can be seen heuristically with a relatively small degrees of freedom as follows:</p>
<div id="eecb8f56" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>T5 <span class="op">=</span> <span class="fu">TDist</span>(<span class="fl">5</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">maximum</span>(abs, <span class="fu">rand</span>(T5, <span class="fl">100</span>)), <span class="fu">maximum</span>(abs, <span class="fu">rand</span>(Z, <span class="fl">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>(3.8076371107475513, 2.8542285227595743)</code></pre>
</div>
</div>
<p><a href="#fig-qqplots-distributions" class="quarto-xref">Figure&nbsp;<span>7.5</span></a> shows a quantile-normal plot of <span class="math inline">\(T(3)\)</span> in the lower-left graphic. The long tails cause deviations in the pattern of points from a straight line.</p>
<p>The <code>skewness</code> method measures asymmetry. For both the <span class="math inline">\(T\)</span> and the normal distributions – both bell shaped – this is <span class="math inline">\(0\)</span>. The <code>kurtosis</code> function measures <em>excess kurtosis</em> a measure of the size of the tails <em>as compared</em> to the normal. We can see:</p>
<div id="88cae4bc" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(T5), <span class="fu">skewness</span>(Z), <span class="fu">kurtosis</span>(T5), <span class="fu">kurtosis</span>(Z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>(0.0, 0.0, 6.0, 0.0)</code></pre>
</div>
</div>
<p>A distribution with excess kurtosis exceeding the normal is called <em>leptokurtic</em>. Such distributions more frequently produce values with <span class="math inline">\(z\)</span> scores larger than expected by the standard normal distribution. A <em>platykurtic</em> distribution, on the other hand, would have in more frequently fewer values in the tails and fewer values close to the mean of a standard normal. The uniform distribution is a good example of a playtkurtic distribution, both conditions have a test in <code>Distributions</code>:</p>
<div id="10e47099" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">isleptokurtic</span>(T5), <span class="fu">isplatykurtic</span>(U)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>(true, true)</code></pre>
</div>
</div>
<p>For the <span class="math inline">\(T\)</span>-distribution, when the degrees of freedom gets large, say bigger than <span class="math inline">\(100\)</span>, the distribution is well approximated by the normal. In the following code, we see a similar comparison as above to compare the difference. For a quantile-normal plot see the upper-right graphic in <a href="#fig-qqplots-distributions" class="quarto-xref">Figure&nbsp;<span>7.5</span></a>.</p>
<div id="1f800f0b" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>T100 <span class="op">=</span> <span class="fu">TDist</span>(<span class="fl">100</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> <span class="fu">range</span>(<span class="op">-</span><span class="fl">3</span>, <span class="fl">3</span>, length<span class="op">=</span><span class="fl">100</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">findmax</span>(<span class="fu">abs</span>(<span class="fu">cdf</span>(T100, x) <span class="op">-</span> <span class="fu">cdf</span>(Z, x)) <span class="cf">for</span> x <span class="kw">in</span> xs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>(0.0015794482887208222, 25)</code></pre>
</div>
</div>
<p>In <a href="#fig-qqplots-distributions" class="quarto-xref">Figure&nbsp;<span>7.5</span></a> the lower-right graphic is of the uniform distribution, the short tails, lead to a deviation from a straight line in this graphic; the lower-right graphic is of the skewed exponential distribution; the skew shows up in the lack of symmetry about the fitted line.</p>
<div id="fig-qqplots-distributions" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="29">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-qqplots-distributions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre>MethodError: plottype(::Type{Plot{Makie.qqnorm}}, ::Type{Plot{MakieCore.plot}}) is ambiguous.

Candidates:
  plottype(<span class="ansi-bright-black-fg">P1</span>::<span class="ansi-bold">Type</span>{&lt;:Plot{T1}}, ::<span class="ansi-bold">Type</span>{&lt;:Plot{T2}}) where {T1, T2}
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">Makie</span> <span class="ansi-bright-black-fg">~/.julia/packages/Makie/rEu75/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">interfaces.jl:311</span>
  plottype(<span class="ansi-bright-black-fg">P</span>::<span class="ansi-bold">Type</span>{&lt;:Plot{T}}, ::<span class="ansi-bold">Type</span>{Plot{MakieCore.plot}}) where T
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">Makie</span> <span class="ansi-bright-black-fg">~/.julia/packages/Makie/rEu75/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">interfaces.jl:326</span>
  plottype(::<span class="ansi-bold">Type</span>{&lt;:Plot{Makie.qqnorm}}, <span class="ansi-bright-black-fg">args...</span>)
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">Makie</span> <span class="ansi-bright-black-fg">~/.julia/packages/Makie/rEu75/src/stats/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">distributions.jl:117</span>

Possible fix, define
  plottype(::Type{&lt;:Plot{Makie.qqnorm}}, ::Type{Plot{MakieCore.plot}})


Stacktrace:
  [1] (::AlgebraOfGraphics.Visual)(input::ProcessedLayer)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/transformations/visual.jl:8
  [2] process(layer::Layer)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/processing.jl:148
  [3] iterate
    @ ./generator.jl:47 [inlined]
  [4] collect(itr::Base.Generator{Layers, typeof(AlgebraOfGraphics.process)})
    @ Base ./array.jl:834
  [5] map
    @ ./abstractarray.jl:3313 [inlined]
  [6] ProcessedLayers
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:41 [inlined]
  [7] compute_axes_grid(d::Layer, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:235
  [8] compute_axes_grid
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:233 [inlined]
  [9] compute_axes_grid(fig::Figure, d::Layer, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:205
 [10] compute_axes_grid
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:202 [inlined]
 [11] #336
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:20 [inlined]
 [12] update
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:10 [inlined]
 [13] plot!(fig::Figure, d::Layer, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:20
 [14] plot!
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:16 [inlined]
 [15] (::AlgebraOfGraphics.var"#341#342"{Dictionaries.Dictionary{Symbol, Any}, Dictionaries.Dictionary{Symbol, Any}, Dictionaries.Dictionary{Symbol, Any}, Dictionaries.Dictionary{Symbol, Any}, Layer, AlgebraOfGraphics.Scales})(f::Figure)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:64
 [16] update
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:10 [inlined]
 [17] _draw(d::Layer, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any}, figure::Dictionaries.Dictionary{Symbol, Any}, facet::Dictionaries.Dictionary{Symbol, Any}, legend::Dictionaries.Dictionary{Symbol, Any}, colorbar::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:63
 [18] _draw
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:60 [inlined]
 [19] draw(d::Layer, scales::AlgebraOfGraphics.Scales; axis::@NamedTuple{}, figure::@NamedTuple{}, facet::@NamedTuple{}, legend::@NamedTuple{}, colorbar::@NamedTuple{}, palette::Nothing)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:57
 [20] draw
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:47 [inlined]
 [21] draw(d::Layer)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:47
 [22] |&gt;(x::Layer, f::typeof(draw))
    @ Base ./operators.jl:917
 [23] top-level scope
    @ In[30]:6</pre>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-qqplots-distributions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.5
</figcaption>
</figure>
</div>
<p>Consider now two, independent Chi-squared random variables <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span> with <span class="math inline">\(\nu_1\)</span> and <span class="math inline">\(\nu_2\)</span> degrees of freedom. The ratio</p>
<p><span class="math display">\[
F = \frac{Y_1/\nu_1}{Y_2/\nu_2},
\]</span></p>
<p>has a known distribution called the <span class="math inline">\(F\)</span>-distribution with <span class="math inline">\(\nu_1\)</span> and <span class="math inline">\(\nu_2\)</span> degrees of freedom.</p>
<p>This distribution has different shapes for different parameter values (<a href="#fig-f-distributions" class="quarto-xref">Figure&nbsp;<span>7.6</span></a>), with the distributions becoming more normal as the two parameters get large.</p>
<div id="0620a7bb" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kurtosis</span>(<span class="fu">FDist</span>(<span class="fl">5</span>, <span class="fl">10</span>)), <span class="fu">kurtosis</span>(<span class="fu">FDist</span>(<span class="fl">5</span>,<span class="fl">100</span>)), <span class="fu">kurtosis</span>(<span class="fu">FDist</span>(<span class="fl">100</span>,<span class="fl">100</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>(50.86153846153846, 3.1474470779483217, 0.7278883188966445)</code></pre>
</div>
</div>
<div id="fig-f-distributions" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="31">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-f-distributions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre>MethodError: plottype(::Type{Plot{Makie.qqnorm}}, ::Type{Plot{MakieCore.plot}}) is ambiguous.

Candidates:
  plottype(<span class="ansi-bright-black-fg">P1</span>::<span class="ansi-bold">Type</span>{&lt;:Plot{T1}}, ::<span class="ansi-bold">Type</span>{&lt;:Plot{T2}}) where {T1, T2}
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">Makie</span> <span class="ansi-bright-black-fg">~/.julia/packages/Makie/rEu75/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">interfaces.jl:311</span>
  plottype(<span class="ansi-bright-black-fg">P</span>::<span class="ansi-bold">Type</span>{&lt;:Plot{T}}, ::<span class="ansi-bold">Type</span>{Plot{MakieCore.plot}}) where T
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">Makie</span> <span class="ansi-bright-black-fg">~/.julia/packages/Makie/rEu75/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">interfaces.jl:326</span>
  plottype(::<span class="ansi-bold">Type</span>{&lt;:Plot{Makie.qqnorm}}, <span class="ansi-bright-black-fg">args...</span>)
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">Makie</span> <span class="ansi-bright-black-fg">~/.julia/packages/Makie/rEu75/src/stats/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">distributions.jl:117</span>

Possible fix, define
  plottype(::Type{&lt;:Plot{Makie.qqnorm}}, ::Type{Plot{MakieCore.plot}})


Stacktrace:
  [1] (::AlgebraOfGraphics.Visual)(input::ProcessedLayer)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/transformations/visual.jl:8
  [2] process(layer::Layer)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/processing.jl:148
  [3] iterate
    @ ./generator.jl:47 [inlined]
  [4] collect(itr::Base.Generator{Layers, typeof(AlgebraOfGraphics.process)})
    @ Base ./array.jl:834
  [5] map
    @ ./abstractarray.jl:3313 [inlined]
  [6] ProcessedLayers
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:41 [inlined]
  [7] compute_axes_grid(d::Layer, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:235
  [8] compute_axes_grid
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:233 [inlined]
  [9] compute_axes_grid(fig::Figure, d::Layer, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:205
 [10] compute_axes_grid
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:202 [inlined]
 [11] #336
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:20 [inlined]
 [12] update
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:10 [inlined]
 [13] plot!(fig::Figure, d::Layer, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:20
 [14] plot!
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:16 [inlined]
 [15] (::AlgebraOfGraphics.var"#341#342"{Dictionaries.Dictionary{Symbol, Any}, Dictionaries.Dictionary{Symbol, Any}, Dictionaries.Dictionary{Symbol, Any}, Dictionaries.Dictionary{Symbol, Any}, Layer, AlgebraOfGraphics.Scales})(f::Figure)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:64
 [16] update
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:10 [inlined]
 [17] _draw(d::Layer, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any}, figure::Dictionaries.Dictionary{Symbol, Any}, facet::Dictionaries.Dictionary{Symbol, Any}, legend::Dictionaries.Dictionary{Symbol, Any}, colorbar::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:63
 [18] _draw
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:60 [inlined]
 [19] draw(d::Layer, scales::AlgebraOfGraphics.Scales; axis::@NamedTuple{}, figure::@NamedTuple{}, facet::@NamedTuple{}, legend::@NamedTuple{}, colorbar::@NamedTuple{}, palette::Nothing)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:57
 [20] draw
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:47 [inlined]
 [21] draw(d::Layer)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:47
 [22] |&gt;(x::Layer, f::typeof(draw))
    @ Base ./operators.jl:917
 [23] top-level scope
    @ In[32]:6</pre>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-f-distributions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.6
</figcaption>
</figure>
</div>
</section>
</section>
<section id="sampling-distributions" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="sampling-distributions"><span class="header-section-number">7.3</span> Sampling distributions</h2>
<p>The normal distribution, <span class="math inline">\(T\)</span> distribution, and <span class="math inline">\(F\)</span> distribution are important in statistics as they arise as sampling distributions of certain statistics.</p>
<section id="the-sample-mean" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="the-sample-mean"><span class="header-section-number">7.3.1</span> The sample mean</h3>
<p>For an iid random sample, from a population with mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\sigma\)</span> we have seen that the sample mean, <span class="math inline">\(\bar{X} = (X_1 + \dots + X_n)/n\)</span> is described by having mean <span class="math inline">\(\mu_{\bar{X}} = \mu\)</span> and standard deviation <span class="math inline">\(\sigma_{\bar{X}} = \sigma / \sqrt{n}\)</span>.</p>
<p>What about the distribution itself? This depends on the underlying population.</p>
<p>If the underlying population is <em>normal</em>, then <span class="math inline">\(\bar{X}\)</span> is normal. This is true as the sum of two independent normal random variables is normally distributed. That is <span class="math inline">\(\bar{X}\)</span> is bell shaped, centered at the same place as the distribution of any of the <span class="math inline">\(X_i\)</span>s but has a <em>narrower</em> shape, as the standard deviation is smaller by a factor of <span class="math inline">\(1/\sqrt{n}\)</span>.</p>
<section id="central-limit-theorem" class="level4">
<h4 class="anchored" data-anchor-id="central-limit-theorem">Central limit theorem</h4>
<p>De Moivre’s observation that the binomial distribution is asymptotically normal is even more general: the <em>central limit theorem</em> informs us that for large enough <span class="math inline">\(n\)</span> the following is true under assumptions::</p>
<p><span class="math display">\[
P(\frac{\bar{X} - \mu}{\sigma/\sqrt{n}} \leq z) \approx P(Z \leq z),
\]</span></p>
<p>where <span class="math inline">\(Z\)</span> is a standard normal random variable. That is centering <span class="math inline">\(\bar{X}\)</span> by <em>its</em> mean and then scaling by its standard deviation results in a random variable that is approximately a standard normal if <span class="math inline">\(n\)</span> is large enough.</p>
<p>The central limit theorem has some assumptions on the underlying population. The assumption that a mean and standard deviation exist are sufficient for application. It is true exactly for normal populations, for non-normal populations asymptotically so. For a binomial population, a rule of thumb is <span class="math inline">\(np\)</span> and <span class="math inline">\(n(1-p)\)</span> should be larger than <span class="math inline">\(5\)</span> (<span class="math inline">\(10\)</span> to be conservative), which avoids a skewed population.</p>
<p>In general, how large <span class="math inline">\(n\)</span> needs to be depends on the underlying shape of the <em>population</em>: if the population has long tails (leptokurtic) or is very skewed, then <span class="math inline">\(n\)</span> must be much larger than if the population is symmetric and platykurtic.</p>
<p><a href="#fig-qqplots-xbar" class="quarto-xref">Figure&nbsp;<span>7.7</span></a> shows simulations of the distribution of <span class="math inline">\(\bar{X}\)</span> for <span class="math inline">\(n=10\)</span> for different populations. The key to simulations is the ability to draw random samples from the distribution, which is provided through the <code>rand</code> method for a distribution type, with <code>rand(D,n)</code> returning a random sample of size <span class="math inline">\(n\)</span>.</p>
<div id="fig-qqplots-xbar" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="32">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-qqplots-xbar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xbar</span>(D, n, N<span class="op">=</span><span class="fl">200</span>) <span class="op">=</span> [<span class="fu">mean</span>(<span class="fu">rand</span>(D, n)) for _ <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>N]</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sxbar</span>(D, n, N<span class="op">=</span><span class="fl">200</span>) <span class="op">=</span> (<span class="fu">xbar</span>(D,n,N) <span class="op">.-</span> <span class="fu">mean</span>(D)) <span class="op">/</span> (<span class="fu">std</span>(D)<span class="op">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>Ds <span class="op">=</span> (normal      <span class="op">=</span> <span class="fu">Normal</span>(<span class="fl">0</span>,<span class="fl">1</span>),</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>      leptokurtic <span class="op">=</span> <span class="fu">TDist</span>(<span class="fl">3</span>),</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>      skewed      <span class="op">=</span> <span class="fu">FDist</span>(<span class="fl">2</span>,<span class="fl">5</span>),</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>      platykurtic <span class="op">=</span> <span class="fu">Uniform</span>(<span class="fl">0</span>,<span class="fl">1</span>))</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="fu">DataFrame</span>(D<span class="op">=</span><span class="fu">collect</span>(<span class="fu">keys</span>(Ds)), zs <span class="op">=</span> [<span class="fu">sxbar</span>(D, <span class="fl">10</span>) for D <span class="kw">in</span> <span class="fu">values</span>(Ds)])</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> <span class="fu">data</span>(<span class="fu">flatten</span>(df, <span class="op">:</span>zs))</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> d <span class="op">*</span> <span class="fu">visual</span>(QQNorm, qqline<span class="op">=:</span>fit) <span class="op">*</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapping</span>(<span class="op">:</span>zs, layout <span class="op">=</span> <span class="op">:</span>D, main<span class="op">=:</span>D, color<span class="op">=:</span>D)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre>MethodError: plottype(::Type{Plot{Makie.qqnorm}}, ::Type{Plot{MakieCore.plot}}) is ambiguous.

Candidates:
  plottype(<span class="ansi-bright-black-fg">P1</span>::<span class="ansi-bold">Type</span>{&lt;:Plot{T1}}, ::<span class="ansi-bold">Type</span>{&lt;:Plot{T2}}) where {T1, T2}
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">Makie</span> <span class="ansi-bright-black-fg">~/.julia/packages/Makie/rEu75/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">interfaces.jl:311</span>
  plottype(<span class="ansi-bright-black-fg">P</span>::<span class="ansi-bold">Type</span>{&lt;:Plot{T}}, ::<span class="ansi-bold">Type</span>{Plot{MakieCore.plot}}) where T
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">Makie</span> <span class="ansi-bright-black-fg">~/.julia/packages/Makie/rEu75/src/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">interfaces.jl:326</span>
  plottype(::<span class="ansi-bold">Type</span>{&lt;:Plot{Makie.qqnorm}}, <span class="ansi-bright-black-fg">args...</span>)
<span class="ansi-bright-black-fg">    @</span> <span class="ansi-bright-black-fg">Makie</span> <span class="ansi-bright-black-fg">~/.julia/packages/Makie/rEu75/src/stats/</span><span style="text-decoration:underline" class="ansi-bright-black-fg">distributions.jl:117</span>

Possible fix, define
  plottype(::Type{&lt;:Plot{Makie.qqnorm}}, ::Type{Plot{MakieCore.plot}})


Stacktrace:
  [1] (::AlgebraOfGraphics.Visual)(input::ProcessedLayer)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/transformations/visual.jl:8
  [2] process(layer::Layer)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/processing.jl:148
  [3] iterate
    @ ./generator.jl:47 [inlined]
  [4] collect(itr::Base.Generator{Layers, typeof(AlgebraOfGraphics.process)})
    @ Base ./array.jl:834
  [5] map
    @ ./abstractarray.jl:3313 [inlined]
  [6] ProcessedLayers
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:41 [inlined]
  [7] compute_axes_grid(d::Layer, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:235
  [8] compute_axes_grid
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:233 [inlined]
  [9] compute_axes_grid(fig::Figure, d::Layer, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:205
 [10] compute_axes_grid
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:202 [inlined]
 [11] #336
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:20 [inlined]
 [12] update
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:10 [inlined]
 [13] plot!(fig::Figure, d::Layer, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:20
 [14] plot!
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:16 [inlined]
 [15] (::AlgebraOfGraphics.var"#341#342"{Dictionaries.Dictionary{Symbol, Any}, Dictionaries.Dictionary{Symbol, Any}, Dictionaries.Dictionary{Symbol, Any}, Dictionaries.Dictionary{Symbol, Any}, Layer, AlgebraOfGraphics.Scales})(f::Figure)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:64
 [16] update
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:10 [inlined]
 [17] _draw(d::Layer, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any}, figure::Dictionaries.Dictionary{Symbol, Any}, facet::Dictionaries.Dictionary{Symbol, Any}, legend::Dictionaries.Dictionary{Symbol, Any}, colorbar::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:63
 [18] _draw
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:60 [inlined]
 [19] draw(d::Layer, scales::AlgebraOfGraphics.Scales; axis::@NamedTuple{}, figure::@NamedTuple{}, facet::@NamedTuple{}, legend::@NamedTuple{}, colorbar::@NamedTuple{}, palette::Nothing)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:57
 [20] draw
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:47 [inlined]
 [21] draw(d::Layer)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:47
 [22] top-level scope
    @ In[33]:14</pre>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-qqplots-xbar-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.7
</figcaption>
</figure>
</div>
</section>
<section id="the-t-statistic" class="level4">
<h4 class="anchored" data-anchor-id="the-t-statistic">The <span class="math inline">\(T\)</span>-statistic</h4>
<p>The central limit theorem requires standardizing by the population standard deviation. At times this is neither known or assumed to be known. However, the standard error may be known:</p>
<blockquote class="blockquote">
<p>The <em>standard error</em> of a statistic is the standard deviation of the statistic <em>or</em> an estimate of the standard deviation.</p>
</blockquote>
<p>For <span class="math inline">\(\bar{X}\)</span>, the standard deviation is <span class="math inline">\(\sigma/\sqrt{n}\)</span> the standard error is <span class="math inline">\(SD(\bar{X})/\sqrt{n}\)</span>, where, for a sample, the sample standard deviation, <span class="math inline">\(s\)</span>, is used to estimate the population standard deviation, <span class="math inline">\(\sigma\)</span>.</p>
<p>The scaling in the central limit theorem can be redone using the standard error, <span class="math inline">\(S/\sqrt{n}\)</span>:</p>
<p><span class="math display">\[
T = \frac{\bar{X} - \mu}{SE(\bar{X})} = \frac{\bar{X} - \mu}{S / \sqrt{n}},
\]</span></p>
<p>where <span class="math inline">\(S\)</span> is the sample standard deviation of the data set <span class="math inline">\(X_1, X_2, \dots, X_n\)</span> :</p>
<p><span class="math display">\[
S = \sqrt{ \frac{1}{n-1} \sum_i^n (X_i - \bar{X_i})^2}.
\]</span></p>
<p>The variability in the sampling means that the standard error will occasionally be much smaller than the population standard deviation, as this is in the denominator, the random variable <span class="math inline">\(T\)</span> will have longer tails than a standard normal. That is, the sampling distribution of <span class="math inline">\(T\)</span> should be leptokurtic, and it is:</p>
<blockquote class="blockquote">
<p>For a normal population, the sampling distribution of <span class="math inline">\(T\)</span> is the <span class="math inline">\(T\)</span>-distribution with <span class="math inline">\(n-1\)</span> degrees of freedom.</p>
</blockquote>
<p>In general, a <span class="math inline">\(T\)</span>-statistic for a parameter, <span class="math inline">\(\beta\)</span>, is the difference between the estimate for the parameter (<span class="math inline">\(\hat{\beta}\)</span>) and the parameter, divided by the standard error of the estimator: <span class="math inline">\(T = (\hat{\beta}-\beta)/SE(\hat{\beta})\)</span>. This is of the pattern “(observed - expected) / SE.”</p>
</section>
</section>
<section id="the-sample-variance" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="the-sample-variance"><span class="header-section-number">7.3.2</span> The sample variance</h3>
<p>For an iid random sample from a normal distribution the distribution of the sample variance <span class="math inline">\(S^2\)</span> can be identified. Consider this algebraic treatment,</p>
<p><span class="math display">\[\begin{align*}
S^2 &amp;= \frac{1}{n-1} \sum_i^n (X_i - E(X_i))^2\\
&amp;= \frac{\sigma^2}{n-1} \sum_i^n \left( \frac{X_i - \bar{X_i}}{\sigma} \right)^2
\end{align*}\]</span></p>
<p>If the sample is an iid random sample of normals and <em>were</em> <span class="math inline">\(\bar{X_i}\)</span> replaced by <span class="math inline">\(\mu=E(X_i)\)</span>, the sum would be of <span class="math inline">\(n\)</span> iid squared standard normal which would be <span class="math inline">\(Chisq(n)\)</span> distributed. However, that isn’t quite the case. Cochran’s theorem shows for an iid random sample from a normal population the distribution of <span class="math inline">\(\sum (Z_i - \bar{Z})^2\)</span> is <span class="math inline">\(Chisq(n-1)\)</span> and <span class="math inline">\(\bar{X}\)</span> and <span class="math inline">\(S^2\)</span> are independent, which leads to:</p>
<blockquote class="blockquote">
<p>For an iid random sample from a normal population <span class="math inline">\((n-1) S^2/\sigma^2\)</span> has a <span class="math inline">\(Chisq(n-1)\)</span> distribution.</p>
</blockquote>
<section id="the-f-statistic" class="level4">
<h4 class="anchored" data-anchor-id="the-f-statistic">The <span class="math inline">\(F\)</span> statistic</h4>
<p>When there are two independent samples, there are two sample means and standard deviations. The ratio of the sample standard deviations gives insight into the question of whether the two populations have the same spread. The <span class="math inline">\(F\)</span>-statistic is given by:</p>
<p><span class="math display">\[
F = \frac{(S_1^2/\sigma_1^2)}{(S_2^2/\sigma_2^2)} = \frac{(\chi_{1,n_1-1}^2 / (n_1-1))}{(\chi_{2,n_2-1}^2/(n_2-1))}.
\]</span></p>
<p>If the two populations are normal with means <span class="math inline">\(\mu_i\)</span> and standard deviations <span class="math inline">\(\sigma_i\)</span>, then the distribution of the <span class="math inline">\(F\)</span> statistic is the <span class="math inline">\(F\)</span> distribution with <span class="math inline">\(\nu_1=n_1-1\)</span> and <span class="math inline">\(\nu_2=n_2-1\)</span> degrees of freedom.</p>
<p>A special case is the <span class="math inline">\(T\)</span> statistic for a normal population which has a <span class="math inline">\(F(1, n-1)\)</span> distribution owing to:</p>
<p><span class="math display">\[\begin{align*}
T^2 &amp;= (\frac{\bar{X} - \mu}{S/\sqrt{n}})^2\\
&amp;= \frac{(\bar{X}-\mu)^2/\sigma^2}{S^2/(n\sigma^2)}\\
&amp;= \frac{(\bar{X}-\mu)^2/(\sigma^2/n)}{S^2/\sigma^2}\\
&amp;= \frac{Z^2/1}{\chi^2_{n-1}/(n-1)}\\
&amp;\sim F(1, n-1).
\end{align*}\]</span></p>
<p>That <span class="math inline">\(\bar{X}\)</span> and <span class="math inline">\(S^2\)</span> are independent under these assumptions is necessary to identify the distribution.</p>
<hr>
<p>The distribution of the <span class="math inline">\(T\)</span> and <span class="math inline">\(F\)</span> statistics for an iid random sample is known under the assumption of a <em>normal</em> population. What if the population is not normal, how robust is the distribution of these statistics to differences in the population? This was studied in <span class="citation" data-cites="Box_non_normality_10.1093/biomet/40.3-4.318">(<a href="../references.html#ref-Box_non_normality_10.1093/biomet/40.3-4.318" role="doc-biblioref">BOX 1953</a>)</span>. Here we show some examples through simulation.</p>
<p>In the following we use a long-tailed population (<span class="math inline">\(T_3\)</span>) and a skewed exponential population to look:</p>
<div id="fig-t-f-robustness-test" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="33">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-t-f-robustness-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">T_n</span>(D, n) <span class="op">=</span> (xs <span class="op">=</span> <span class="fu">rand</span>(D,n); (<span class="fu">mean</span>(xs) <span class="op">-</span> <span class="fu">mean</span>(D)) <span class="op">/</span> (<span class="fu">std</span>(xs) <span class="op">/</span> <span class="fu">sqrt</span>(n)))</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">F_n</span>(D, n1, n2) <span class="op">=</span> (xs <span class="op">=</span> <span class="fu">rand</span>(D,n1); ys <span class="op">=</span> <span class="fu">rand</span>(D, n2); (<span class="fu">std</span>(xs)<span class="op">/</span>(n1<span class="op">-</span><span class="fl">1</span>)) <span class="op">/</span> (<span class="fu">std</span>(ys)<span class="op">/</span>(n2<span class="op">-</span><span class="fl">1</span>)))</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="fl">10</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>n1, n2 <span class="op">=</span> <span class="fl">10</span>, <span class="fl">5</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">100</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>ps <span class="op">=</span> <span class="fu">range</span>(<span class="fl">0.01</span>, <span class="fl">0.99</span>, length<span class="op">=</span>N)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>SDs <span class="op">=</span> (T<span class="op">=</span><span class="fu">TDist</span>(n<span class="op">-</span><span class="fl">1</span>), F<span class="op">=</span><span class="fu">FDist</span>(n1<span class="op">-</span><span class="fl">1</span>, n2<span class="op">-</span><span class="fl">1</span>))</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>Pops <span class="op">=</span> (var<span class="st">"long-tailed"</span><span class="op">=</span><span class="fu">TDist</span>(<span class="fl">3</span>), skewed<span class="op">=</span><span class="fu">Exponential</span>(<span class="fl">1</span>))</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="co"># use scatter to produce qqplot</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> <span class="fu">DataFrame</span>([(D<span class="op">=</span><span class="st">"</span><span class="sc">$</span>SDk<span class="st"> </span><span class="sc">$</span>Popk<span class="st">"</span>, x<span class="op">=</span><span class="fu">quantile</span>(Popv, ps), y <span class="op">=</span> <span class="fu">quantile</span>(<span class="fu">rand</span>(SDv, N), ps))</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>                for (SDk,SDv) <span class="kw">in</span> <span class="fu">pairs</span>(SDs) for (Popk, Popv) <span class="kw">in</span> <span class="fu">pairs</span>(Pops)])</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="fu">data</span>(<span class="fu">flatten</span>(df, [<span class="op">:</span>x,<span class="op">:</span>y])) <span class="op">*</span> (<span class="fu">visual</span>(Scatter) <span class="op">+</span> <span class="fu">linear</span>(;interval<span class="op">=</span><span class="cn">nothing</span>)) <span class="op">*</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mapping</span>(<span class="op">:</span>x, <span class="op">:</span>y, main<span class="op">=:</span>D, layout<span class="op">=:</span>D, color<span class="op">=:</span>D)</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="fu">draw</span>(p, facet<span class="op">=</span>(; linkxaxes<span class="op">=:</span>none, linkyaxes<span class="op">=:</span>none))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>LoadError: ArgumentError: ProcessedLayer with plot type Scatter did not have :main in its AestheticMapping. The mapping was {1 = AlgebraOfGraphics.AesX, 2 = AlgebraOfGraphics.AesY, :color = AlgebraOfGraphics.AesColor, :strokecolor = AlgebraOfGraphics.AesColor, :marker = AlgebraOfGraphics.AesMarker, :markersize = AlgebraOfGraphics.AesMarkerSize}
ArgumentError: ProcessedLayer with plot type Scatter did not have :main in its AestheticMapping. The mapping was {1 = AlgebraOfGraphics.AesX, 2 = AlgebraOfGraphics.AesY, :color = AlgebraOfGraphics.AesColor, :strokecolor = AlgebraOfGraphics.AesColor, :marker = AlgebraOfGraphics.AesMarker, :markersize = AlgebraOfGraphics.AesMarkerSize}

Stacktrace:
  [1] hardcoded_or_mapped_aes(processedlayer::ProcessedLayer, key::Symbol, aes_mapping::Dictionaries.Dictionary{Union{Int64, Symbol}, Type{&lt;:AlgebraOfGraphics.Aesthetic}})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:228
  [2] (::AlgebraOfGraphics.var"#p!#129"{Set{Type{&lt;:AlgebraOfGraphics.Aesthetic}}, Dictionaries.Dictionary{Union{Int64, Symbol}, Type{&lt;:AlgebraOfGraphics.Aesthetic}}, ProcessedLayer, Dictionaries.Dictionary{Union{Int64, Symbol}, Type{&lt;:AlgebraOfGraphics.Aesthetic}}})(key::Symbol)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:154
  [3] foreach(f::AlgebraOfGraphics.var"#p!#129"{Set{Type{&lt;:AlgebraOfGraphics.Aesthetic}}, Dictionaries.Dictionary{Union{Int64, Symbol}, Type{&lt;:AlgebraOfGraphics.Aesthetic}}, ProcessedLayer, Dictionaries.Dictionary{Union{Int64, Symbol}, Type{&lt;:AlgebraOfGraphics.Aesthetic}}}, d::Dictionaries.Indices{Symbol})
    @ Dictionaries ~/.julia/packages/Dictionaries/RaTRN/src/foreach.jl:36
  [4] compute_scale_properties(processedlayers::Vector{ProcessedLayer}, scales::AlgebraOfGraphics.Scales)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:159
  [5] compute_axes_grid(d::Layers, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:237
  [6] compute_axes_grid
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:233 [inlined]
  [7] compute_axes_grid(fig::Figure, d::Layers, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:205
  [8] compute_axes_grid
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:202 [inlined]
  [9] #336
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:20 [inlined]
 [10] update
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:10 [inlined]
 [11] plot!(fig::Figure, d::Layers, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:20
 [12] plot!
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:16 [inlined]
 [13] (::AlgebraOfGraphics.var"#341#342"{Dictionaries.Dictionary{Symbol, Any}, Dictionaries.Dictionary{Symbol, Any}, Dictionaries.Dictionary{Symbol, Any}, Dictionaries.Dictionary{Symbol, Any}, Layers, AlgebraOfGraphics.Scales})(f::Figure)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:64
 [14] update
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:10 [inlined]
 [15] _draw(d::Layers, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any}, figure::Dictionaries.Dictionary{Symbol, Any}, facet::Dictionaries.Dictionary{Symbol, Any}, legend::Dictionaries.Dictionary{Symbol, Any}, colorbar::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:63
 [16] _draw
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:60 [inlined]
 [17] draw(d::Layers, scales::AlgebraOfGraphics.Scales; axis::@NamedTuple{}, figure::@NamedTuple{}, facet::@NamedTuple{linkxaxes::Symbol, linkyaxes::Symbol}, legend::@NamedTuple{}, colorbar::@NamedTuple{}, palette::Nothing)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:57
 [18] draw
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:47 [inlined]
 [19] top-level scope
    @ In[34]:21</code></pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-t-f-robustness-test-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.8
</figcaption>
</figure>
</div>
</section>
</section>
<section id="the-sample-median" class="level3" data-number="7.3.3">
<h3 data-number="7.3.3" class="anchored" data-anchor-id="the-sample-median"><span class="header-section-number">7.3.3</span> The sample median</h3>
<p>The sample median is the “middle” of an iid random sample. Like the sample mean, it is a measure of center, that, unlike the sample mean, is resistant to outliers. The central limit theorem instructs us that for most populations the distribution of the sample mean is normally distributed. The distribution of the sample median can be computed. It is asymptotically normal with mean <span class="math inline">\(\mu\)</span> and variance given by <span class="math inline">\((4nf(m)^2)^{-1}\)</span>, where <span class="math inline">\(n\)</span> is the sample size, <span class="math inline">\(m\)</span> the median of the <em>population</em>, and <span class="math inline">\(f\)</span> the pdf of the population.</p>
<p><a href="#fig-median-efficiency" class="quarto-xref">Figure&nbsp;<span>7.9</span></a> shows through boxplots the variability of the sample median and sample mean depends on the population. For the standard normal population the ratio of the variances of <span class="math inline">\(\bar{X}\)</span> and <span class="math inline">\(M\)</span> tends to <span class="math inline">\(2/\pi\)</span>. This is seen in the smaller IQR for <span class="math inline">\(\bar{X}\)</span> compared to <span class="math inline">\(M\)</span> in the figure for the normal population. This ratio isn’t always smaller than 1 for other populations.</p>
<div id="fig-median-efficiency" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="34">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-median-efficiency-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-error">
<pre><code>LoadError: ArgumentError: ProcessedLayer with plot type Plot{Makie.boxplot} did not have :main in its AestheticMapping. The mapping was {1 = AlgebraOfGraphics.AesX, 2 = AlgebraOfGraphics.AesY, :color = AlgebraOfGraphics.AesColor, :dodge = AlgebraOfGraphics.AesDodge}
ArgumentError: ProcessedLayer with plot type Plot{Makie.boxplot} did not have :main in its AestheticMapping. The mapping was {1 = AlgebraOfGraphics.AesX, 2 = AlgebraOfGraphics.AesY, :color = AlgebraOfGraphics.AesColor, :dodge = AlgebraOfGraphics.AesDodge}

Stacktrace:
  [1] hardcoded_or_mapped_aes(processedlayer::ProcessedLayer, key::Symbol, aes_mapping::Dictionaries.Dictionary{Union{Int64, Symbol}, Type{&lt;:AlgebraOfGraphics.Aesthetic}})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:228
  [2] (::AlgebraOfGraphics.var"#p!#129"{Set{Type{&lt;:AlgebraOfGraphics.Aesthetic}}, Dictionaries.Dictionary{Union{Int64, Symbol}, Type{&lt;:AlgebraOfGraphics.Aesthetic}}, ProcessedLayer, Dictionaries.Dictionary{Union{Int64, Symbol}, Type{&lt;:AlgebraOfGraphics.Aesthetic}}})(key::Symbol)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:154
  [3] foreach(f::AlgebraOfGraphics.var"#p!#129"{Set{Type{&lt;:AlgebraOfGraphics.Aesthetic}}, Dictionaries.Dictionary{Union{Int64, Symbol}, Type{&lt;:AlgebraOfGraphics.Aesthetic}}, ProcessedLayer, Dictionaries.Dictionary{Union{Int64, Symbol}, Type{&lt;:AlgebraOfGraphics.Aesthetic}}}, d::Dictionaries.Indices{Symbol})
    @ Dictionaries ~/.julia/packages/Dictionaries/RaTRN/src/foreach.jl:36
  [4] compute_scale_properties(processedlayers::Vector{ProcessedLayer}, scales::AlgebraOfGraphics.Scales)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:159
  [5] compute_axes_grid(d::Layer, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:237
  [6] compute_axes_grid
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:233 [inlined]
  [7] compute_axes_grid(fig::Figure, d::Layer, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:205
  [8] compute_axes_grid
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/algebra/layers.jl:202 [inlined]
  [9] #336
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:20 [inlined]
 [10] update
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:10 [inlined]
 [11] plot!(fig::Figure, d::Layer, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:20
 [12] plot!
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:16 [inlined]
 [13] (::AlgebraOfGraphics.var"#341#342"{Dictionaries.Dictionary{Symbol, Any}, Dictionaries.Dictionary{Symbol, Any}, Dictionaries.Dictionary{Symbol, Any}, Dictionaries.Dictionary{Symbol, Any}, Layer, AlgebraOfGraphics.Scales})(f::Figure)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:64
 [14] update
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:10 [inlined]
 [15] _draw(d::Layer, scales::AlgebraOfGraphics.Scales; axis::Dictionaries.Dictionary{Symbol, Any}, figure::Dictionaries.Dictionary{Symbol, Any}, facet::Dictionaries.Dictionary{Symbol, Any}, legend::Dictionaries.Dictionary{Symbol, Any}, colorbar::Dictionaries.Dictionary{Symbol, Any})
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:63
 [16] _draw
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:60 [inlined]
 [17] draw(d::Layer, scales::AlgebraOfGraphics.Scales; axis::@NamedTuple{}, figure::@NamedTuple{}, facet::@NamedTuple{}, legend::@NamedTuple{}, colorbar::@NamedTuple{}, palette::Nothing)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:57
 [18] draw
    @ ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:47 [inlined]
 [19] draw(d::Layer)
    @ AlgebraOfGraphics ~/.julia/packages/AlgebraOfGraphics/swbj0/src/draw.jl:47
 [20] top-level scope
    @ In[35]:17</code></pre>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-median-efficiency-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.9
</figcaption>
</figure>
</div>
</section>
<section id="the-chi-squared-statistic" class="level3" data-number="7.3.4">
<h3 data-number="7.3.4" class="anchored" data-anchor-id="the-chi-squared-statistic"><span class="header-section-number">7.3.4</span> The Chi-squared statistic</h3>
<p>For the multinomial distribution for a fixed <span class="math inline">\(n\)</span> with probabilities <span class="math inline">\(p_1, p_2, \dots, p_k\)</span> and counts <span class="math inline">\(X_1, X_2, \dots, X_k\)</span>, the expected values are <span class="math inline">\(E_i = E(X_i) = n p_i\)</span>. The difference between the observed, <span class="math inline">\(X_i\)</span>, and the expected, <span class="math inline">\(E_i\)</span>, are often summarized in this statistic:</p>
<p><span class="math display">\[
\chi^2 = \sum_k \frac{(X_i - E_i)^2}{E_i}.
\]</span></p>
<p>For this scenario, the <em>asymptotic</em> distribution of <span class="math inline">\(\chi^2\)</span> is the Chi-squared distribution with <span class="math inline">\(k-1\)</span> degrees of freedom. This number comes from the one relationship amongst the <span class="math inline">\(k\)</span> variables (that they all add up to <span class="math inline">\(1\)</span>.) That is, <span class="math inline">\(k-1\)</span> <span class="math inline">\(p_i\)</span>s are freely chosen, the other a dependency.</p>
<p>Suppose there are <span class="math inline">\(s\)</span> values, <span class="math inline">\(\theta = (\theta_1, \theta_2, \dots, \theta_s)\)</span> with some identification <span class="math inline">\(f(\theta) = (p_1, p_2, \dots, p_k)\)</span>. If these <span class="math inline">\(s\)</span> values are estimated from the data (using a best asymptotically normal estimator), then there are <span class="math inline">\(k - s - 1\)</span> degrees of freedom in the asymptotic Chi-squared distribution.</p>
<p>The Chi-squared sampling distribution is <em>asymptotic</em> meaning for <span class="math inline">\(n\)</span> large enough. A rule of thumb is each count should be expected to be <span class="math inline">\(5\)</span> or more.</p>
<p>A related statistic is the Cressie-Read power-divergence statistic, <span class="citation" data-cites="CressieRead_10.2307_2345686">(<a href="../references.html#ref-CressieRead_10.2307_2345686" role="doc-biblioref">Cressie and Read 1984</a>)</span>, parameterized by real <span class="math inline">\(\lambda\)</span> and given by:</p>
<p><span class="math display">\[
2nI^\lambda = \frac{2}{\lambda(\lambda +1)} \sum_{i=1}^k X_i \left( \left(\frac{X_i}{E_i}\right)^\lambda - 1)\right).
\]</span></p>
<p>When <span class="math inline">\(\lambda = 1\)</span>, after some algebraic manipulations, this can be identified with the <span class="math inline">\(\chi^2\)</span> statistic above. Other values for <span class="math inline">\(\lambda\)</span> recover other named statistics, for example <span class="math inline">\(\lambda=0\)</span>, for which this computes the maximum-likelihood estimate from the data. The Cressie-Read statistic also has an asymptotic <span class="math inline">\(Chisq(k-s-1)\)</span> distribution for a fixed <span class="math inline">\(\lambda\)</span>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Box_non_normality_10.1093/biomet/40.3-4.318" class="csl-entry" role="listitem">
BOX, G. E. P. (1953), <span>“<span>NON-NORMALITY AND TESTS ON VARIANCES</span>,”</span> <em>Biometrika</em>, 40, 318–335. <a href="https://doi.org/10.1093/biomet/40.3-4.318">https://doi.org/10.1093/biomet/40.3-4.318</a>.
</div>
<div id="ref-CressieRead_10.2307_2345686" class="csl-entry" role="listitem">
Cressie, N., and Read, T. R. C. (1984), <span>“<a href="http://www.jstor.org/stable/2345686">Multinomial goodness-of-fit tests</a>,”</span> <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, [Royal Statistical Society, Wiley], 46, 440–464.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Notationally, <span class="math inline">\(E(X)\)</span> is used for the mean of a random variable, <span class="math inline">\(\mu\)</span> is used for the mean of a probability distribution, though we use them interchangeably.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>This definition of a quantile is for a continuous distribution, when the cumulative distribution is not monotonic, then definition may be the infimum over all <span class="math inline">\(a\)</span> for which <span class="math inline">\(p \leq P(X \leq a)\)</span>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../EDA/makie.html" class="pagination-link" aria-label="The `AlgebraOfGraphics` package">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The <code>AlgebraOfGraphics</code> package</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Inference/inference.html" class="pagination-link" aria-label="Inference">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Inference</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/jverzani/UsingJ/edit/master/Inference/distributions.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/jverzani/UsingJ/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>© Copyright 2023, John Verzani. All rights reserved.</p>
</div>
  </div>
</footer>




</body></html>